Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='96_720', model='SPM_TST', data='custom', root_path='./dataset/', data_path='weather.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=18, pred_len=720, fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=21, dec_in=7, c_out=7, d_model=49, n_heads=1, e_layers=1, d_layers=1, d_ff=153, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=300, batch_size=468, patience=20, learning_rate=0.00053, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, k=1.0, dishts=1, num_layers=3, hidden_size=[5, 20], traffic=0, hidden_size1=3, hidden_size2=3, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : 96_720_SPM_TST_custom_ftM_sl96_ll18_pl720_dm49_nh1_el1_dl1_df153_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36072
val 4551
test 9820
Epoch: 1 cost time: 3.304633855819702
Epoch: 1, Steps: 77 | Train Loss: 0.8506696 Vali Loss: 0.8508810 Test Loss: 0.3584406
Validation loss decreased (inf --> 0.850881).  Saving model ...
Updating learning rate to 0.00053
Epoch: 2 cost time: 3.281325340270996
Epoch: 2, Steps: 77 | Train Loss: 0.7352093 Vali Loss: 0.7273982 Test Loss: 0.3390329
Validation loss decreased (0.850881 --> 0.727398).  Saving model ...
Updating learning rate to 0.00053
Epoch: 3 cost time: 3.2753798961639404
Epoch: 3, Steps: 77 | Train Loss: 0.6852289 Vali Loss: 0.7127106 Test Loss: 0.3332585
Validation loss decreased (0.727398 --> 0.712711).  Saving model ...
Updating learning rate to 0.00053
Epoch: 4 cost time: 3.271397829055786
Epoch: 4, Steps: 77 | Train Loss: 0.6690437 Vali Loss: 0.6945990 Test Loss: 0.3296799
Validation loss decreased (0.712711 --> 0.694599).  Saving model ...
Updating learning rate to 0.000477
Epoch: 5 cost time: 3.1770849227905273
Epoch: 5, Steps: 77 | Train Loss: 0.6591508 Vali Loss: 0.6883994 Test Loss: 0.3276706
Validation loss decreased (0.694599 --> 0.688399).  Saving model ...
Updating learning rate to 0.0004293
Epoch: 6 cost time: 3.303415536880493
Epoch: 6, Steps: 77 | Train Loss: 0.6531522 Vali Loss: 0.6854621 Test Loss: 0.3269052
Validation loss decreased (0.688399 --> 0.685462).  Saving model ...
Updating learning rate to 0.00038637000000000003
Epoch: 7 cost time: 3.285322904586792
Epoch: 7, Steps: 77 | Train Loss: 0.6492035 Vali Loss: 0.6835818 Test Loss: 0.3265530
Validation loss decreased (0.685462 --> 0.683582).  Saving model ...
Updating learning rate to 0.00034773299999999997
Epoch: 8 cost time: 3.1950511932373047
Epoch: 8, Steps: 77 | Train Loss: 0.6461890 Vali Loss: 0.6842323 Test Loss: 0.3267450
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00031295970000000005
Epoch: 9 cost time: 3.2426514625549316
Epoch: 9, Steps: 77 | Train Loss: 0.6440507 Vali Loss: 0.6831651 Test Loss: 0.3262379
Validation loss decreased (0.683582 --> 0.683165).  Saving model ...
Updating learning rate to 0.00028166373000000004
Epoch: 10 cost time: 3.3495934009552
Epoch: 10, Steps: 77 | Train Loss: 0.6413181 Vali Loss: 0.6787643 Test Loss: 0.3263634
Validation loss decreased (0.683165 --> 0.678764).  Saving model ...
Updating learning rate to 0.000253497357
Epoch: 11 cost time: 3.160980224609375
Epoch: 11, Steps: 77 | Train Loss: 0.6394471 Vali Loss: 0.6833209 Test Loss: 0.3260875
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00022814762130000005
Epoch: 12 cost time: 3.1927731037139893
Epoch: 12, Steps: 77 | Train Loss: 0.6380244 Vali Loss: 0.6811492 Test Loss: 0.3263042
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00020533285917000003
Epoch: 13 cost time: 3.2737720012664795
Epoch: 13, Steps: 77 | Train Loss: 0.6363036 Vali Loss: 0.6840589 Test Loss: 0.3266765
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00018479957325300003
Epoch: 14 cost time: 3.2127513885498047
Epoch: 14, Steps: 77 | Train Loss: 0.6350487 Vali Loss: 0.6812173 Test Loss: 0.3261644
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00016631961592770001
Epoch: 15 cost time: 3.251718044281006
Epoch: 15, Steps: 77 | Train Loss: 0.6335198 Vali Loss: 0.6795223 Test Loss: 0.3266289
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00014968765433493006
Epoch: 16 cost time: 3.390587091445923
Epoch: 16, Steps: 77 | Train Loss: 0.6321917 Vali Loss: 0.6817451 Test Loss: 0.3269607
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00013471888890143703
Epoch: 17 cost time: 3.182905912399292
Epoch: 17, Steps: 77 | Train Loss: 0.6313509 Vali Loss: 0.6801346 Test Loss: 0.3266706
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00012124700001129335
Epoch: 18 cost time: 3.2402608394622803
Epoch: 18, Steps: 77 | Train Loss: 0.6304030 Vali Loss: 0.6809087 Test Loss: 0.3267850
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.000109122300010164
Epoch: 19 cost time: 3.1828033924102783
Epoch: 19, Steps: 77 | Train Loss: 0.6292576 Vali Loss: 0.6815645 Test Loss: 0.3267714
EarlyStopping counter: 9 out of 20
Updating learning rate to 9.82100700091476e-05
Epoch: 20 cost time: 3.2421741485595703
Epoch: 20, Steps: 77 | Train Loss: 0.6285799 Vali Loss: 0.6843870 Test Loss: 0.3269834
EarlyStopping counter: 10 out of 20
Updating learning rate to 8.838906300823285e-05
Epoch: 21 cost time: 3.3994288444519043
Epoch: 21, Steps: 77 | Train Loss: 0.6273705 Vali Loss: 0.6797602 Test Loss: 0.3269172
EarlyStopping counter: 11 out of 20
Updating learning rate to 7.955015670740956e-05
Epoch: 22 cost time: 3.37391996383667
Epoch: 22, Steps: 77 | Train Loss: 0.6269026 Vali Loss: 0.6839025 Test Loss: 0.3272403
EarlyStopping counter: 12 out of 20
Updating learning rate to 7.159514103666861e-05
Epoch: 23 cost time: 3.3647210597991943
Epoch: 23, Steps: 77 | Train Loss: 0.6262848 Vali Loss: 0.6833750 Test Loss: 0.3272332
EarlyStopping counter: 13 out of 20
Updating learning rate to 6.443562693300176e-05
Epoch: 24 cost time: 3.599985122680664
Epoch: 24, Steps: 77 | Train Loss: 0.6252559 Vali Loss: 0.6820467 Test Loss: 0.3269544
EarlyStopping counter: 14 out of 20
Updating learning rate to 5.799206423970158e-05
Epoch: 25 cost time: 3.2667758464813232
Epoch: 25, Steps: 77 | Train Loss: 0.6248383 Vali Loss: 0.6807896 Test Loss: 0.3269995
EarlyStopping counter: 15 out of 20
Updating learning rate to 5.219285781573142e-05
Epoch: 26 cost time: 3.409592628479004
Epoch: 26, Steps: 77 | Train Loss: 0.6246182 Vali Loss: 0.6771527 Test Loss: 0.3273238
Validation loss decreased (0.678764 --> 0.677153).  Saving model ...
Updating learning rate to 4.697357203415828e-05
Epoch: 27 cost time: 3.240011215209961
Epoch: 27, Steps: 77 | Train Loss: 0.6240978 Vali Loss: 0.6817771 Test Loss: 0.3270051
EarlyStopping counter: 1 out of 20
Updating learning rate to 4.2276214830742456e-05
Epoch: 28 cost time: 3.1508073806762695
Epoch: 28, Steps: 77 | Train Loss: 0.6233465 Vali Loss: 0.6812732 Test Loss: 0.3274122
EarlyStopping counter: 2 out of 20
Updating learning rate to 3.8048593347668205e-05
Epoch: 29 cost time: 3.3473119735717773
Epoch: 29, Steps: 77 | Train Loss: 0.6231047 Vali Loss: 0.6842425 Test Loss: 0.3270944
EarlyStopping counter: 3 out of 20
Updating learning rate to 3.424373401290139e-05
Epoch: 30 cost time: 3.326040744781494
Epoch: 30, Steps: 77 | Train Loss: 0.6229839 Vali Loss: 0.6782523 Test Loss: 0.3270881
EarlyStopping counter: 4 out of 20
Updating learning rate to 3.081936061161125e-05
Epoch: 31 cost time: 3.2853035926818848
Epoch: 31, Steps: 77 | Train Loss: 0.6228457 Vali Loss: 0.6820592 Test Loss: 0.3272212
EarlyStopping counter: 5 out of 20
Updating learning rate to 2.773742455045013e-05
Epoch: 32 cost time: 3.519148588180542
Epoch: 32, Steps: 77 | Train Loss: 0.6222851 Vali Loss: 0.6840082 Test Loss: 0.3274133
EarlyStopping counter: 6 out of 20
Updating learning rate to 2.4963682095405116e-05
Epoch: 33 cost time: 3.43070650100708
Epoch: 33, Steps: 77 | Train Loss: 0.6219847 Vali Loss: 0.6815531 Test Loss: 0.3271559
EarlyStopping counter: 7 out of 20
Updating learning rate to 2.2467313885864603e-05
Epoch: 34 cost time: 3.2523276805877686
Epoch: 34, Steps: 77 | Train Loss: 0.6219890 Vali Loss: 0.6840985 Test Loss: 0.3272974
EarlyStopping counter: 8 out of 20
Updating learning rate to 2.0220582497278144e-05
Epoch: 35 cost time: 3.3823909759521484
Epoch: 35, Steps: 77 | Train Loss: 0.6214626 Vali Loss: 0.6828145 Test Loss: 0.3273608
EarlyStopping counter: 9 out of 20
Updating learning rate to 1.819852424755033e-05
Epoch: 36 cost time: 3.261341094970703
Epoch: 36, Steps: 77 | Train Loss: 0.6213102 Vali Loss: 0.6824207 Test Loss: 0.3273992
EarlyStopping counter: 10 out of 20
Updating learning rate to 1.6378671822795296e-05
Epoch: 37 cost time: 3.6695432662963867
Epoch: 37, Steps: 77 | Train Loss: 0.6213924 Vali Loss: 0.6817524 Test Loss: 0.3273515
EarlyStopping counter: 11 out of 20
Updating learning rate to 1.4740804640515768e-05
Epoch: 38 cost time: 3.7169716358184814
Epoch: 38, Steps: 77 | Train Loss: 0.6210835 Vali Loss: 0.6814479 Test Loss: 0.3274454
EarlyStopping counter: 12 out of 20
Updating learning rate to 1.3266724176464192e-05
Epoch: 39 cost time: 3.467074155807495
Epoch: 39, Steps: 77 | Train Loss: 0.6211791 Vali Loss: 0.6839877 Test Loss: 0.3272766
EarlyStopping counter: 13 out of 20
Updating learning rate to 1.1940051758817773e-05
Epoch: 40 cost time: 3.3629815578460693
Epoch: 40, Steps: 77 | Train Loss: 0.6209272 Vali Loss: 0.6826475 Test Loss: 0.3274734
EarlyStopping counter: 14 out of 20
Updating learning rate to 1.0746046582935995e-05
Epoch: 41 cost time: 3.2708256244659424
Epoch: 41, Steps: 77 | Train Loss: 0.6208291 Vali Loss: 0.6817999 Test Loss: 0.3274683
EarlyStopping counter: 15 out of 20
Updating learning rate to 9.671441924642398e-06
Epoch: 42 cost time: 3.2425777912139893
Epoch: 42, Steps: 77 | Train Loss: 0.6207369 Vali Loss: 0.6836116 Test Loss: 0.3274686
EarlyStopping counter: 16 out of 20
Updating learning rate to 8.704297732178157e-06
Epoch: 43 cost time: 3.368387222290039
Epoch: 43, Steps: 77 | Train Loss: 0.6208106 Vali Loss: 0.6810573 Test Loss: 0.3273405
EarlyStopping counter: 17 out of 20
Updating learning rate to 7.833867958960341e-06
Epoch: 44 cost time: 3.662384033203125
Epoch: 44, Steps: 77 | Train Loss: 0.6204758 Vali Loss: 0.6815662 Test Loss: 0.3275231
EarlyStopping counter: 18 out of 20
Updating learning rate to 7.050481163064307e-06
Epoch: 45 cost time: 3.683602809906006
Epoch: 45, Steps: 77 | Train Loss: 0.6200987 Vali Loss: 0.6812842 Test Loss: 0.3274572
EarlyStopping counter: 19 out of 20
Updating learning rate to 6.345433046757877e-06
Epoch: 46 cost time: 3.5879852771759033
Epoch: 46, Steps: 77 | Train Loss: 0.6200509 Vali Loss: 0.6811140 Test Loss: 0.3274183
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : 96_720_SPM_TST_custom_ftM_sl96_ll18_pl720_dm49_nh1_el1_dl1_df153_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
mse:0.32732316851615906, mae:0.3380562365055084, rse:0.764719545841217
