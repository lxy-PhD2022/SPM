Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='96_720', model='SPM_TST', data='ETTh1', root_path='./dataset/', data_path='ETTh1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=18, pred_len=720, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=49, n_heads=1, e_layers=1, d_layers=1, d_ff=127, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=300, batch_size=436, patience=8, learning_rate=0.00961, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, k=1.0, dishts=1, num_layers=3, hidden_size=[19, 17], traffic=0, hidden_size1=3, hidden_size2=3, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : 96_720_SPM_TST_ETTh1_ftM_sl96_ll18_pl720_dm49_nh1_el1_dl1_df127_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7825
val 2161
test 2161
Epoch: 1 cost time: 1.014134407043457
Epoch: 1, Steps: 17 | Train Loss: 0.6889406 Vali Loss: 1.5991850 Test Loss: 0.5071956
Validation loss decreased (inf --> 1.599185).  Saving model ...
Updating learning rate to 0.00961
Epoch: 2 cost time: 0.9430441856384277
Epoch: 2, Steps: 17 | Train Loss: 0.7774949 Vali Loss: 1.7022858 Test Loss: 0.5456961
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.00961
Epoch: 3 cost time: 1.3328654766082764
Epoch: 3, Steps: 17 | Train Loss: 0.6455768 Vali Loss: 1.6313409 Test Loss: 0.4984396
EarlyStopping counter: 2 out of 8
Updating learning rate to 0.00961
Epoch: 4 cost time: 1.2380273342132568
Epoch: 4, Steps: 17 | Train Loss: 0.6135240 Vali Loss: 1.6217175 Test Loss: 0.5385247
EarlyStopping counter: 3 out of 8
Updating learning rate to 0.008649
Epoch: 5 cost time: 1.1266751289367676
Epoch: 5, Steps: 17 | Train Loss: 0.5921827 Vali Loss: 1.6050109 Test Loss: 0.5467142
EarlyStopping counter: 4 out of 8
Updating learning rate to 0.007784100000000001
Epoch: 6 cost time: 1.0707640647888184
Epoch: 6, Steps: 17 | Train Loss: 0.5788610 Vali Loss: 1.6399877 Test Loss: 0.5352874
EarlyStopping counter: 5 out of 8
Updating learning rate to 0.007005690000000001
Epoch: 7 cost time: 2.0043652057647705
Epoch: 7, Steps: 17 | Train Loss: 0.5645672 Vali Loss: 1.6319788 Test Loss: 0.5252155
EarlyStopping counter: 6 out of 8
Updating learning rate to 0.006305121
Epoch: 8 cost time: 1.9238224029541016
Epoch: 8, Steps: 17 | Train Loss: 0.5511110 Vali Loss: 1.6912423 Test Loss: 0.4991274
EarlyStopping counter: 7 out of 8
Updating learning rate to 0.005674608900000001
Epoch: 9 cost time: 2.410512685775757
Epoch: 9, Steps: 17 | Train Loss: 0.5393335 Vali Loss: 1.6722672 Test Loss: 0.5208418
EarlyStopping counter: 8 out of 8
Early stopping
>>>>>>>testing : 96_720_SPM_TST_ETTh1_ftM_sl96_ll18_pl720_dm49_nh1_el1_dl1_df127_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.5071953535079956, mae:0.4842005968093872, rse:0.6921930313110352
