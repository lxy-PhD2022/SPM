Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='96_720', model='SPM_TST', data='ETTm2', root_path='./dataset/', data_path='ETTm2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=18, pred_len=720, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=49, n_heads=1, e_layers=1, d_layers=1, d_ff=120, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=300, batch_size=493, patience=20, learning_rate=0.00882, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, k=1.0, dishts=1, num_layers=3, hidden_size=[19, 12], traffic=0, hidden_size1=3, hidden_size2=3, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : 96_720_SPM_TST_ETTm2_ftM_sl96_ll18_pl720_dm49_nh1_el1_dl1_df120_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 10801
test 10801
Epoch: 1 cost time: 3.3073482513427734
Epoch: 1, Steps: 68 | Train Loss: 0.5894974 Vali Loss: 0.2893906 Test Loss: 0.3817998
Validation loss decreased (inf --> 0.289391).  Saving model ...
Updating learning rate to 0.00882
Epoch: 2 cost time: 3.3683571815490723
Epoch: 2, Steps: 68 | Train Loss: 0.5936072 Vali Loss: 0.2998897 Test Loss: 0.3977457
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00882
Epoch: 3 cost time: 3.498640298843384
Epoch: 3, Steps: 68 | Train Loss: 0.5709108 Vali Loss: 0.3036603 Test Loss: 0.4084586
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00882
Epoch: 4 cost time: 3.246842384338379
Epoch: 4, Steps: 68 | Train Loss: 0.5634178 Vali Loss: 0.2959193 Test Loss: 0.3971954
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.007938
Epoch: 5 cost time: 3.2413551807403564
Epoch: 5, Steps: 68 | Train Loss: 0.5432521 Vali Loss: 0.2972479 Test Loss: 0.3953613
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0071442
Epoch: 6 cost time: 3.614638090133667
Epoch: 6, Steps: 68 | Train Loss: 0.5282192 Vali Loss: 0.2973420 Test Loss: 0.3954277
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00642978
Epoch: 7 cost time: 2.9732699394226074
Epoch: 7, Steps: 68 | Train Loss: 0.5213032 Vali Loss: 0.2964790 Test Loss: 0.3971154
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.005786802
Epoch: 8 cost time: 3.1413376331329346
Epoch: 8, Steps: 68 | Train Loss: 0.5063662 Vali Loss: 0.2953724 Test Loss: 0.3991358
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.005208121800000001
Epoch: 9 cost time: 3.5178496837615967
Epoch: 9, Steps: 68 | Train Loss: 0.4962318 Vali Loss: 0.2944903 Test Loss: 0.3959787
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.004687309620000001
Epoch: 10 cost time: 3.3622570037841797
Epoch: 10, Steps: 68 | Train Loss: 0.4843695 Vali Loss: 0.2975116 Test Loss: 0.4061802
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.004218578658000001
Epoch: 11 cost time: 3.0585527420043945
Epoch: 11, Steps: 68 | Train Loss: 0.4756185 Vali Loss: 0.2953184 Test Loss: 0.4000385
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.003796720792200001
Epoch: 12 cost time: 3.504700183868408
Epoch: 12, Steps: 68 | Train Loss: 0.4652792 Vali Loss: 0.2946687 Test Loss: 0.4077085
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.0034170487129800008
Epoch: 13 cost time: 2.8961150646209717
Epoch: 13, Steps: 68 | Train Loss: 0.4529306 Vali Loss: 0.2899860 Test Loss: 0.3935196
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.003075343841682001
Epoch: 14 cost time: 2.901944160461426
Epoch: 14, Steps: 68 | Train Loss: 0.4461385 Vali Loss: 0.2950542 Test Loss: 0.4075995
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.0027678094575138003
Epoch: 15 cost time: 3.129554271697998
Epoch: 15, Steps: 68 | Train Loss: 0.4372411 Vali Loss: 0.2902209 Test Loss: 0.4008829
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.002491028511762421
Epoch: 16 cost time: 2.9838709831237793
Epoch: 16, Steps: 68 | Train Loss: 0.4298346 Vali Loss: 0.2951016 Test Loss: 0.4095398
EarlyStopping counter: 15 out of 20
Updating learning rate to 0.0022419256605861787
Epoch: 17 cost time: 3.0001401901245117
Epoch: 17, Steps: 68 | Train Loss: 0.4236963 Vali Loss: 0.2935002 Test Loss: 0.4068366
EarlyStopping counter: 16 out of 20
Updating learning rate to 0.002017733094527561
Epoch: 18 cost time: 3.065774440765381
Epoch: 18, Steps: 68 | Train Loss: 0.4162557 Vali Loss: 0.2956442 Test Loss: 0.4134521
EarlyStopping counter: 17 out of 20
Updating learning rate to 0.0018159597850748047
Epoch: 19 cost time: 3.1069037914276123
Epoch: 19, Steps: 68 | Train Loss: 0.4098443 Vali Loss: 0.2966298 Test Loss: 0.4114314
EarlyStopping counter: 18 out of 20
Updating learning rate to 0.0016343638065673242
Epoch: 20 cost time: 3.410188674926758
Epoch: 20, Steps: 68 | Train Loss: 0.4051648 Vali Loss: 0.2965349 Test Loss: 0.4140269
EarlyStopping counter: 19 out of 20
Updating learning rate to 0.001470927425910592
Epoch: 21 cost time: 2.9090731143951416
Epoch: 21, Steps: 68 | Train Loss: 0.3999925 Vali Loss: 0.3010628 Test Loss: 0.4217306
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : 96_720_SPM_TST_ETTm2_ftM_sl96_ll18_pl720_dm49_nh1_el1_dl1_df120_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
mse:0.3818003833293915, mae:0.39158353209495544, rse:0.4930970072746277
