Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='96_336', model='SPM_TST', data='ETTm2', root_path='./dataset/', data_path='ETTm2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=18, pred_len=336, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=49, n_heads=1, e_layers=1, d_layers=1, d_ff=287, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=300, batch_size=76, patience=20, learning_rate=0.005, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, k=1.0, dishts=1, num_layers=3, hidden_size=[16, 15], traffic=0, hidden_size1=3, hidden_size2=3, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : 96_336_SPM_TST_ETTm2_ftM_sl96_ll18_pl336_dm49_nh1_el1_dl1_df287_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.3405682
	speed: 0.0329s/iter; left time: 4422.8191s
	iters: 200, epoch: 1 | loss: 0.6486936
	speed: 0.0171s/iter; left time: 2304.2520s
	iters: 300, epoch: 1 | loss: 0.3953366
	speed: 0.0164s/iter; left time: 2201.8498s
	iters: 400, epoch: 1 | loss: 0.3531096
	speed: 0.0173s/iter; left time: 2325.1326s
Epoch: 1 cost time: 8.429457187652588
Epoch: 1, Steps: 449 | Train Loss: 0.4348181 Vali Loss: 0.2179155 Test Loss: 0.2976239
Validation loss decreased (inf --> 0.217915).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.4879625
	speed: 0.0774s/iter; left time: 10382.0979s
	iters: 200, epoch: 2 | loss: 0.3504193
	speed: 0.0158s/iter; left time: 2117.9477s
	iters: 300, epoch: 2 | loss: 0.4730698
	speed: 0.0187s/iter; left time: 2509.1227s
	iters: 400, epoch: 2 | loss: 0.6474195
	speed: 0.0161s/iter; left time: 2154.2349s
Epoch: 2 cost time: 7.814126014709473
Epoch: 2, Steps: 449 | Train Loss: 0.4527359 Vali Loss: 0.2262883 Test Loss: 0.3151360
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.4197921
	speed: 0.0870s/iter; left time: 11629.2832s
	iters: 200, epoch: 3 | loss: 0.4659883
	speed: 0.0192s/iter; left time: 2564.1386s
	iters: 300, epoch: 3 | loss: 0.3466139
	speed: 0.0183s/iter; left time: 2444.3251s
	iters: 400, epoch: 3 | loss: 0.5092356
	speed: 0.0173s/iter; left time: 2304.8876s
Epoch: 3 cost time: 9.019681453704834
Epoch: 3, Steps: 449 | Train Loss: 0.4384938 Vali Loss: 0.2271057 Test Loss: 0.3142048
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.005
	iters: 100, epoch: 4 | loss: 0.6224000
	speed: 0.0659s/iter; left time: 8786.5748s
	iters: 200, epoch: 4 | loss: 0.3234433
	speed: 0.0124s/iter; left time: 1645.9537s
	iters: 300, epoch: 4 | loss: 0.4395184
	speed: 0.0118s/iter; left time: 1564.9417s
	iters: 400, epoch: 4 | loss: 0.4186793
	speed: 0.0178s/iter; left time: 2366.4357s
Epoch: 4 cost time: 6.3659913539886475
Epoch: 4, Steps: 449 | Train Loss: 0.4290890 Vali Loss: 0.2251456 Test Loss: 0.3123339
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0045000000000000005
	iters: 100, epoch: 5 | loss: 0.5831401
	speed: 0.0786s/iter; left time: 10440.9182s
	iters: 200, epoch: 5 | loss: 0.3525591
	speed: 0.0182s/iter; left time: 2408.7974s
	iters: 300, epoch: 5 | loss: 0.2661714
	speed: 0.0156s/iter; left time: 2069.3256s
	iters: 400, epoch: 5 | loss: 0.4168754
	speed: 0.0191s/iter; left time: 2530.3518s
Epoch: 5 cost time: 8.158471584320068
Epoch: 5, Steps: 449 | Train Loss: 0.4142740 Vali Loss: 0.2265256 Test Loss: 0.3134420
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.004050000000000001
	iters: 100, epoch: 6 | loss: 0.4121754
	speed: 0.0824s/iter; left time: 10908.5917s
	iters: 200, epoch: 6 | loss: 0.3212979
	speed: 0.0187s/iter; left time: 2468.4137s
	iters: 300, epoch: 6 | loss: 0.2600758
	speed: 0.0189s/iter; left time: 2491.5102s
	iters: 400, epoch: 6 | loss: 0.3430466
	speed: 0.0204s/iter; left time: 2696.0049s
Epoch: 6 cost time: 9.030462980270386
Epoch: 6, Steps: 449 | Train Loss: 0.4070471 Vali Loss: 0.2219095 Test Loss: 0.3092147
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.0036450000000000007
	iters: 100, epoch: 7 | loss: 0.3853772
	speed: 0.0845s/iter; left time: 11141.1075s
	iters: 200, epoch: 7 | loss: 0.6457416
	speed: 0.0170s/iter; left time: 2244.0567s
	iters: 300, epoch: 7 | loss: 0.3868368
	speed: 0.0183s/iter; left time: 2414.1817s
	iters: 400, epoch: 7 | loss: 0.3914035
	speed: 0.0172s/iter; left time: 2259.8161s
Epoch: 7 cost time: 8.276384592056274
Epoch: 7, Steps: 449 | Train Loss: 0.3968568 Vali Loss: 0.2252511 Test Loss: 0.3143955
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.0032805
	iters: 100, epoch: 8 | loss: 0.3699873
	speed: 0.0847s/iter; left time: 11137.5140s
	iters: 200, epoch: 8 | loss: 0.4193679
	speed: 0.0173s/iter; left time: 2273.4912s
	iters: 300, epoch: 8 | loss: 0.3421474
	speed: 0.0162s/iter; left time: 2121.4274s
	iters: 400, epoch: 8 | loss: 0.4386009
	speed: 0.0176s/iter; left time: 2313.2812s
Epoch: 8 cost time: 8.093865156173706
Epoch: 8, Steps: 449 | Train Loss: 0.3854163 Vali Loss: 0.2246327 Test Loss: 0.3108878
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.0029524500000000006
	iters: 100, epoch: 9 | loss: 0.4322767
	speed: 0.0869s/iter; left time: 11389.0594s
	iters: 200, epoch: 9 | loss: 0.3474124
	speed: 0.0181s/iter; left time: 2374.3567s
	iters: 300, epoch: 9 | loss: 0.4283632
	speed: 0.0173s/iter; left time: 2258.0070s
	iters: 400, epoch: 9 | loss: 0.3729325
	speed: 0.0183s/iter; left time: 2395.5780s
Epoch: 9 cost time: 8.408912897109985
Epoch: 9, Steps: 449 | Train Loss: 0.3857287 Vali Loss: 0.2258903 Test Loss: 0.3156246
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.002657205
	iters: 100, epoch: 10 | loss: 0.5077290
	speed: 0.0902s/iter; left time: 11775.4885s
	iters: 200, epoch: 10 | loss: 0.3573752
	speed: 0.0187s/iter; left time: 2435.2893s
	iters: 300, epoch: 10 | loss: 0.4699564
	speed: 0.0174s/iter; left time: 2264.3358s
	iters: 400, epoch: 10 | loss: 0.4094742
	speed: 0.0173s/iter; left time: 2257.7552s
Epoch: 10 cost time: 8.615878582000732
Epoch: 10, Steps: 449 | Train Loss: 0.3715118 Vali Loss: 0.2231079 Test Loss: 0.3086021
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.0023914845000000003
	iters: 100, epoch: 11 | loss: 0.4153322
	speed: 0.0825s/iter; left time: 10730.3652s
	iters: 200, epoch: 11 | loss: 0.2938415
	speed: 0.0152s/iter; left time: 1977.4061s
	iters: 300, epoch: 11 | loss: 0.3257700
	speed: 0.0194s/iter; left time: 2516.4746s
	iters: 400, epoch: 11 | loss: 0.2979380
	speed: 0.0174s/iter; left time: 2252.4550s
Epoch: 11 cost time: 8.378290891647339
Epoch: 11, Steps: 449 | Train Loss: 0.3667397 Vali Loss: 0.2240710 Test Loss: 0.3120718
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.0021523360500000006
	iters: 100, epoch: 12 | loss: 0.4072807
	speed: 0.0933s/iter; left time: 12094.8402s
	iters: 200, epoch: 12 | loss: 0.2633394
	speed: 0.0180s/iter; left time: 2325.7847s
	iters: 300, epoch: 12 | loss: 0.4190119
	speed: 0.0157s/iter; left time: 2026.3779s
	iters: 400, epoch: 12 | loss: 0.5184207
	speed: 0.0158s/iter; left time: 2042.4119s
Epoch: 12 cost time: 8.31798768043518
Epoch: 12, Steps: 449 | Train Loss: 0.3578619 Vali Loss: 0.2237307 Test Loss: 0.3098698
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.0019371024450000004
	iters: 100, epoch: 13 | loss: 0.2913109
	speed: 0.0877s/iter; left time: 11329.2081s
	iters: 200, epoch: 13 | loss: 0.3030737
	speed: 0.0151s/iter; left time: 1949.3560s
	iters: 300, epoch: 13 | loss: 0.2448378
	speed: 0.0189s/iter; left time: 2435.5994s
	iters: 400, epoch: 13 | loss: 0.2997558
	speed: 0.0187s/iter; left time: 2414.5969s
Epoch: 13 cost time: 8.778634548187256
Epoch: 13, Steps: 449 | Train Loss: 0.3525687 Vali Loss: 0.2220067 Test Loss: 0.3091899
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.0017433922005000006
	iters: 100, epoch: 14 | loss: 0.3564572
	speed: 0.0921s/iter; left time: 11861.4507s
	iters: 200, epoch: 14 | loss: 0.5156288
	speed: 0.0160s/iter; left time: 2057.5518s
	iters: 300, epoch: 14 | loss: 0.2671108
	speed: 0.0142s/iter; left time: 1824.5229s
	iters: 400, epoch: 14 | loss: 0.4015857
	speed: 0.0183s/iter; left time: 2350.8580s
Epoch: 14 cost time: 7.9727942943573
Epoch: 14, Steps: 449 | Train Loss: 0.3458113 Vali Loss: 0.2270057 Test Loss: 0.3152221
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.0015690529804500003
	iters: 100, epoch: 15 | loss: 0.3214041
	speed: 0.0796s/iter; left time: 10216.2459s
	iters: 200, epoch: 15 | loss: 0.4031035
	speed: 0.0188s/iter; left time: 2414.1242s
	iters: 300, epoch: 15 | loss: 0.3047129
	speed: 0.0166s/iter; left time: 2130.4836s
	iters: 400, epoch: 15 | loss: 0.2732705
	speed: 0.0164s/iter; left time: 2095.7741s
Epoch: 15 cost time: 7.952607154846191
Epoch: 15, Steps: 449 | Train Loss: 0.3398236 Vali Loss: 0.2250401 Test Loss: 0.3120074
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.0014121476824050007
	iters: 100, epoch: 16 | loss: 0.2506861
	speed: 0.0817s/iter; left time: 10450.1554s
	iters: 200, epoch: 16 | loss: 0.2661538
	speed: 0.0158s/iter; left time: 2017.2722s
	iters: 300, epoch: 16 | loss: 0.5766770
	speed: 0.0167s/iter; left time: 2129.5678s
	iters: 400, epoch: 16 | loss: 0.2880705
	speed: 0.0163s/iter; left time: 2075.1589s
Epoch: 16 cost time: 7.7825422286987305
Epoch: 16, Steps: 449 | Train Loss: 0.3337814 Vali Loss: 0.2271355 Test Loss: 0.3170864
EarlyStopping counter: 15 out of 20
Updating learning rate to 0.0012709329141645004
	iters: 100, epoch: 17 | loss: 0.3141814
	speed: 0.0846s/iter; left time: 10777.0249s
	iters: 200, epoch: 17 | loss: 0.4460276
	speed: 0.0154s/iter; left time: 1955.1529s
	iters: 300, epoch: 17 | loss: 0.2922274
	speed: 0.0167s/iter; left time: 2119.8555s
	iters: 400, epoch: 17 | loss: 0.3369472
	speed: 0.0173s/iter; left time: 2192.9745s
Epoch: 17 cost time: 8.049927473068237
Epoch: 17, Steps: 449 | Train Loss: 0.3261996 Vali Loss: 0.2248498 Test Loss: 0.3140588
EarlyStopping counter: 16 out of 20
Updating learning rate to 0.0011438396227480504
	iters: 100, epoch: 18 | loss: 0.2989502
	speed: 0.0877s/iter; left time: 11131.5454s
	iters: 200, epoch: 18 | loss: 0.4299422
	speed: 0.0187s/iter; left time: 2372.3159s
	iters: 300, epoch: 18 | loss: 0.2875196
	speed: 0.0198s/iter; left time: 2510.0980s
	iters: 400, epoch: 18 | loss: 0.2720221
	speed: 0.0177s/iter; left time: 2242.2767s
Epoch: 18 cost time: 8.818813800811768
Epoch: 18, Steps: 449 | Train Loss: 0.3193287 Vali Loss: 0.2314779 Test Loss: 0.3178511
EarlyStopping counter: 17 out of 20
Updating learning rate to 0.0010294556604732454
	iters: 100, epoch: 19 | loss: 0.3501307
	speed: 0.0864s/iter; left time: 10927.0772s
	iters: 200, epoch: 19 | loss: 0.3722080
	speed: 0.0098s/iter; left time: 1242.2588s
	iters: 300, epoch: 19 | loss: 0.3396483
	speed: 0.0106s/iter; left time: 1335.5793s
	iters: 400, epoch: 19 | loss: 0.4231528
	speed: 0.0092s/iter; left time: 1164.6530s
Epoch: 19 cost time: 5.361505508422852
Epoch: 19, Steps: 449 | Train Loss: 0.3117329 Vali Loss: 0.2237843 Test Loss: 0.3164204
EarlyStopping counter: 18 out of 20
Updating learning rate to 0.0009265100944259208
	iters: 100, epoch: 20 | loss: 0.3223453
	speed: 0.0619s/iter; left time: 7800.0952s
	iters: 200, epoch: 20 | loss: 0.2474609
	speed: 0.0172s/iter; left time: 2162.0679s
	iters: 300, epoch: 20 | loss: 0.3220856
	speed: 0.0190s/iter; left time: 2396.0415s
	iters: 400, epoch: 20 | loss: 0.2425039
	speed: 0.0160s/iter; left time: 2014.6177s
Epoch: 20 cost time: 8.048402786254883
Epoch: 20, Steps: 449 | Train Loss: 0.3081256 Vali Loss: 0.2294746 Test Loss: 0.3199324
EarlyStopping counter: 19 out of 20
Updating learning rate to 0.0008338590849833288
	iters: 100, epoch: 21 | loss: 0.2422809
	speed: 0.0898s/iter; left time: 11276.2996s
	iters: 200, epoch: 21 | loss: 0.2367751
	speed: 0.0131s/iter; left time: 1640.0482s
	iters: 300, epoch: 21 | loss: 0.2912218
	speed: 0.0213s/iter; left time: 2672.6322s
	iters: 400, epoch: 21 | loss: 0.2174167
	speed: 0.0187s/iter; left time: 2337.8522s
Epoch: 21 cost time: 8.60033392906189
Epoch: 21, Steps: 449 | Train Loss: 0.3006407 Vali Loss: 0.2280921 Test Loss: 0.3252187
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : 96_336_SPM_TST_ETTm2_ftM_sl96_ll18_pl336_dm49_nh1_el1_dl1_df287_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.29762405157089233, mae:0.33598196506500244, rse:0.4405156970024109
