Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=97, c_out=7, checkpoints='./checkpoints/', d_ff=176, d_layers=1, d_model=216, data='ETTm2', data_path='ETTm2.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', dishts=1, distil=True, do_predict=False, dropout=0.3, e_layers=1, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.3, features='M', freq='h', gpu=0, head_dropout=0.0, hidden_size=[20, 16], hidden_size1=3, hidden_size2=3, individual=0, is_training=1, itr=1, k=1.0, kernel_size=25, label_len=18, learning_rate=0.00463, loss='mse', lradj='type3', model='SPM_TST', model_id='96_192', moving_avg=25, n_heads=1, num_layers=3, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.3, pred_len=192, random_seed=2021, revin=1, root_path='./dataset/', seq_len=96, stride=8, subtract_last=0, target='OT', test_flop=False, traffic=0, train_epochs=300, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : 96_192_SPM_TST_ETTm2_ftM_sl96_ll18_pl192_dm216_nh1_el1_dl1_df176_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34273
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.2526023
	speed: 0.0309s/iter; left time: 3274.5064s
	iters: 200, epoch: 1 | loss: 0.4337887
	speed: 0.0151s/iter; left time: 1594.1204s
	iters: 300, epoch: 1 | loss: 0.3286738
	speed: 0.0151s/iter; left time: 1593.2644s
Epoch: 1 cost time: 6.240198135375977
Epoch: 1, Steps: 353 | Train Loss: 0.3225143 Vali Loss: 0.1687555 Test Loss: 0.2372498
Validation loss decreased (inf --> 0.168755).  Saving model ...
Updating learning rate to 0.00463
	iters: 100, epoch: 2 | loss: 0.2301082
	speed: 0.0754s/iter; left time: 7952.6811s
	iters: 200, epoch: 2 | loss: 0.3624499
	speed: 0.0177s/iter; left time: 1861.6059s
	iters: 300, epoch: 2 | loss: 0.2560343
	speed: 0.0140s/iter; left time: 1474.7453s
Epoch: 2 cost time: 6.275759220123291
Epoch: 2, Steps: 353 | Train Loss: 0.3487961 Vali Loss: 0.1889486 Test Loss: 0.2625818
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00463
	iters: 100, epoch: 3 | loss: 0.3746225
	speed: 0.0563s/iter; left time: 5922.0163s
	iters: 200, epoch: 3 | loss: 0.3994657
	speed: 0.0145s/iter; left time: 1520.6314s
	iters: 300, epoch: 3 | loss: 0.4205309
	speed: 0.0149s/iter; left time: 1560.0227s
Epoch: 3 cost time: 5.533338785171509
Epoch: 3, Steps: 353 | Train Loss: 0.3354387 Vali Loss: 0.1812016 Test Loss: 0.2565526
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00463
	iters: 100, epoch: 4 | loss: 0.3423719
	speed: 0.0583s/iter; left time: 6101.9587s
	iters: 200, epoch: 4 | loss: 0.4716511
	speed: 0.0149s/iter; left time: 1558.2327s
	iters: 300, epoch: 4 | loss: 0.4286801
	speed: 0.0148s/iter; left time: 1542.7830s
Epoch: 4 cost time: 5.686169624328613
Epoch: 4, Steps: 353 | Train Loss: 0.3310833 Vali Loss: 0.1830152 Test Loss: 0.2560036
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.004167
	iters: 100, epoch: 5 | loss: 0.2319703
	speed: 0.0563s/iter; left time: 5876.7437s
	iters: 200, epoch: 5 | loss: 0.3743601
	speed: 0.0169s/iter; left time: 1766.0231s
	iters: 300, epoch: 5 | loss: 0.4304640
	speed: 0.0173s/iter; left time: 1806.4027s
Epoch: 5 cost time: 5.970678806304932
Epoch: 5, Steps: 353 | Train Loss: 0.3226920 Vali Loss: 0.1840518 Test Loss: 0.2561791
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0037503
	iters: 100, epoch: 6 | loss: 0.2659450
	speed: 0.0765s/iter; left time: 7956.9270s
	iters: 200, epoch: 6 | loss: 0.2371372
	speed: 0.0147s/iter; left time: 1533.0547s
	iters: 300, epoch: 6 | loss: 0.2478493
	speed: 0.0133s/iter; left time: 1383.8261s
Epoch: 6 cost time: 5.470593452453613
Epoch: 6, Steps: 353 | Train Loss: 0.3174078 Vali Loss: 0.1843081 Test Loss: 0.2580917
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00337527
	iters: 100, epoch: 7 | loss: 0.4040174
	speed: 0.0569s/iter; left time: 5895.0034s
	iters: 200, epoch: 7 | loss: 0.3427255
	speed: 0.0140s/iter; left time: 1448.9535s
	iters: 300, epoch: 7 | loss: 0.2831913
	speed: 0.0149s/iter; left time: 1545.3237s
Epoch: 7 cost time: 5.3771679401397705
Epoch: 7, Steps: 353 | Train Loss: 0.3110216 Vali Loss: 0.1845359 Test Loss: 0.2607381
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.003037743
	iters: 100, epoch: 8 | loss: 0.3302057
	speed: 0.0582s/iter; left time: 6009.9248s
	iters: 200, epoch: 8 | loss: 0.3214501
	speed: 0.0142s/iter; left time: 1465.9859s
	iters: 300, epoch: 8 | loss: 0.4231944
	speed: 0.0140s/iter; left time: 1444.9600s
Epoch: 8 cost time: 5.316205263137817
Epoch: 8, Steps: 353 | Train Loss: 0.3014208 Vali Loss: 0.1869792 Test Loss: 0.2620388
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.0027339687
	iters: 100, epoch: 9 | loss: 0.3003388
	speed: 0.0554s/iter; left time: 5709.8476s
	iters: 200, epoch: 9 | loss: 0.2845334
	speed: 0.0142s/iter; left time: 1462.5724s
	iters: 300, epoch: 9 | loss: 0.2049626
	speed: 0.0146s/iter; left time: 1503.4678s
Epoch: 9 cost time: 5.39043402671814
Epoch: 9, Steps: 353 | Train Loss: 0.2937634 Vali Loss: 0.1871489 Test Loss: 0.2605698
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00246057183
	iters: 100, epoch: 10 | loss: 0.2303151
	speed: 0.0679s/iter; left time: 6968.0744s
	iters: 200, epoch: 10 | loss: 0.3175388
	speed: 0.0141s/iter; left time: 1447.3154s
	iters: 300, epoch: 10 | loss: 0.2683225
	speed: 0.0136s/iter; left time: 1391.5751s
Epoch: 10 cost time: 5.684019088745117
Epoch: 10, Steps: 353 | Train Loss: 0.2896762 Vali Loss: 0.1869143 Test Loss: 0.2612197
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.0022145146470000003
	iters: 100, epoch: 11 | loss: 0.2379897
	speed: 0.0562s/iter; left time: 5743.5761s
	iters: 200, epoch: 11 | loss: 0.3334633
	speed: 0.0150s/iter; left time: 1529.0755s
	iters: 300, epoch: 11 | loss: 0.2574093
	speed: 0.0138s/iter; left time: 1405.2574s
Epoch: 11 cost time: 5.43450140953064
Epoch: 11, Steps: 353 | Train Loss: 0.2790175 Vali Loss: 0.1950187 Test Loss: 0.2661932
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.0019930631823000004
	iters: 100, epoch: 12 | loss: 0.3050391
	speed: 0.0567s/iter; left time: 5779.9931s
	iters: 200, epoch: 12 | loss: 0.2462482
	speed: 0.0141s/iter; left time: 1437.7429s
	iters: 300, epoch: 12 | loss: 0.1907689
	speed: 0.0138s/iter; left time: 1405.4641s
Epoch: 12 cost time: 5.238385438919067
Epoch: 12, Steps: 353 | Train Loss: 0.2701353 Vali Loss: 0.1897057 Test Loss: 0.2627000
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.0017937568640700003
	iters: 100, epoch: 13 | loss: 0.2901900
	speed: 0.0586s/iter; left time: 5954.6692s
	iters: 200, epoch: 13 | loss: 0.2754957
	speed: 0.0148s/iter; left time: 1502.9639s
	iters: 300, epoch: 13 | loss: 0.2260653
	speed: 0.0149s/iter; left time: 1506.9561s
Epoch: 13 cost time: 5.580754518508911
Epoch: 13, Steps: 353 | Train Loss: 0.2663743 Vali Loss: 0.1981859 Test Loss: 0.2665365
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.0016143811776630002
	iters: 100, epoch: 14 | loss: 0.2876854
	speed: 0.0710s/iter; left time: 7186.7370s
	iters: 200, epoch: 14 | loss: 0.2050868
	speed: 0.0149s/iter; left time: 1507.6143s
	iters: 300, epoch: 14 | loss: 0.1809521
	speed: 0.0138s/iter; left time: 1390.6369s
Epoch: 14 cost time: 5.6691460609436035
Epoch: 14, Steps: 353 | Train Loss: 0.2610691 Vali Loss: 0.1907852 Test Loss: 0.2590738
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.0014529430598967002
	iters: 100, epoch: 15 | loss: 0.3749242
	speed: 0.0557s/iter; left time: 5613.9408s
	iters: 200, epoch: 15 | loss: 0.1945925
	speed: 0.0140s/iter; left time: 1411.1683s
	iters: 300, epoch: 15 | loss: 0.2073211
	speed: 0.0133s/iter; left time: 1342.5521s
Epoch: 15 cost time: 5.200011491775513
Epoch: 15, Steps: 353 | Train Loss: 0.2546348 Vali Loss: 0.1898201 Test Loss: 0.2638498
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.0013076487539070304
	iters: 100, epoch: 16 | loss: 0.2889662
	speed: 0.0573s/iter; left time: 5754.9926s
	iters: 200, epoch: 16 | loss: 0.2710242
	speed: 0.0135s/iter; left time: 1354.2856s
	iters: 300, epoch: 16 | loss: 0.2015192
	speed: 0.0143s/iter; left time: 1432.5504s
Epoch: 16 cost time: 5.349441051483154
Epoch: 16, Steps: 353 | Train Loss: 0.2478869 Vali Loss: 0.2028308 Test Loss: 0.2707604
EarlyStopping counter: 15 out of 20
Updating learning rate to 0.0011768838785163273
	iters: 100, epoch: 17 | loss: 0.2291521
	speed: 0.0676s/iter; left time: 6767.9838s
	iters: 200, epoch: 17 | loss: 0.1948195
	speed: 0.0282s/iter; left time: 2825.9484s
	iters: 300, epoch: 17 | loss: 0.2514209
	speed: 0.0148s/iter; left time: 1479.9562s
Epoch: 17 cost time: 7.884541273117065
Epoch: 17, Steps: 353 | Train Loss: 0.2448691 Vali Loss: 0.2059589 Test Loss: 0.2692644
EarlyStopping counter: 16 out of 20
Updating learning rate to 0.0010591954906646946
	iters: 100, epoch: 18 | loss: 0.2147367
	speed: 0.0660s/iter; left time: 6586.1144s
	iters: 200, epoch: 18 | loss: 0.2018986
	speed: 0.0133s/iter; left time: 1328.3929s
	iters: 300, epoch: 18 | loss: 0.3096952
	speed: 0.0133s/iter; left time: 1321.5190s
Epoch: 18 cost time: 5.371371030807495
Epoch: 18, Steps: 353 | Train Loss: 0.2421420 Vali Loss: 0.1957368 Test Loss: 0.2691841
EarlyStopping counter: 17 out of 20
Updating learning rate to 0.0009532759415982251
	iters: 100, epoch: 19 | loss: 0.1827080
	speed: 0.0553s/iter; left time: 5496.0124s
	iters: 200, epoch: 19 | loss: 0.2152845
	speed: 0.0149s/iter; left time: 1476.0930s
	iters: 300, epoch: 19 | loss: 0.3125173
	speed: 0.0150s/iter; left time: 1486.0707s
Epoch: 19 cost time: 5.461330890655518
Epoch: 19, Steps: 353 | Train Loss: 0.2377840 Vali Loss: 0.1926898 Test Loss: 0.2681532
EarlyStopping counter: 18 out of 20
Updating learning rate to 0.0008579483474384026
	iters: 100, epoch: 20 | loss: 0.1514808
	speed: 0.0586s/iter; left time: 5804.1119s
	iters: 200, epoch: 20 | loss: 0.2659258
	speed: 0.0139s/iter; left time: 1372.0494s
	iters: 300, epoch: 20 | loss: 0.2981634
	speed: 0.0145s/iter; left time: 1436.7347s
Epoch: 20 cost time: 5.671139240264893
Epoch: 20, Steps: 353 | Train Loss: 0.2343919 Vali Loss: 0.1954321 Test Loss: 0.2685574
EarlyStopping counter: 19 out of 20
Updating learning rate to 0.0007721535126945624
	iters: 100, epoch: 21 | loss: 0.1696802
	speed: 0.0662s/iter; left time: 6539.8664s
	iters: 200, epoch: 21 | loss: 0.1947995
	speed: 0.0154s/iter; left time: 1522.3676s
	iters: 300, epoch: 21 | loss: 0.2142020
	speed: 0.0183s/iter; left time: 1802.1690s
Epoch: 21 cost time: 6.3448646068573
Epoch: 21, Steps: 353 | Train Loss: 0.2310102 Vali Loss: 0.2068124 Test Loss: 0.2724813
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : 96_192_SPM_TST_ETTm2_ftM_sl96_ll18_pl192_dm216_nh1_el1_dl1_df176_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.23725007474422455, mae:0.2965298295021057, rse:0.393538236618042
