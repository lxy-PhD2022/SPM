Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=64, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=256, data='custom', data_path='electricity.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', dishts=1, distil=True, do_predict=False, dropout=0.2, e_layers=1, embed='timeF', embed_type=0, enc_in=321, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, hidden_size=[64, 8], hidden_size1=3, hidden_size2=3, individual=0, is_training=1, itr=1, k=1.0, kernel_size=25, label_len=18, learning_rate=0.0001, loss='mse', lradj='TST', model='SPM_TST', model_id='96_720', moving_avg=25, n_heads=1, num_layers=3, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.2, pred_len=720, random_seed=2021, revin=1, root_path='./dataset/', seq_len=96, stride=8, subtract_last=0, target='OT', test_flop=False, traffic=0, train_epochs=76, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : 96_720_SPM_TST_custom_ftM_sl96_ll18_pl720_dm256_nh1_el1_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17597
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.7217482
	speed: 0.1413s/iter; left time: 2928.6629s
	iters: 200, epoch: 1 | loss: 0.4951723
	speed: 0.1276s/iter; left time: 2632.3584s
Epoch: 1 cost time: 37.18313002586365
Epoch: 1, Steps: 274 | Train Loss: 0.6505391 Vali Loss: 0.3345441 Test Loss: 0.3746643
Validation loss decreased (inf --> 0.334544).  Saving model ...
Updating learning rate to 5.022080435582288e-06
	iters: 100, epoch: 2 | loss: 0.3446143
	speed: 0.5623s/iter; left time: 11499.3327s
	iters: 200, epoch: 2 | loss: 0.3206155
	speed: 0.1259s/iter; left time: 2562.2066s
Epoch: 2 cost time: 36.32845950126648
Epoch: 2, Steps: 274 | Train Loss: 0.3315754 Vali Loss: 0.2540906 Test Loss: 0.2881529
Validation loss decreased (0.334544 --> 0.254091).  Saving model ...
Updating learning rate to 8.044794724962494e-06
	iters: 100, epoch: 3 | loss: 0.2905796
	speed: 0.5694s/iter; left time: 11489.6038s
	iters: 200, epoch: 3 | loss: 0.2885096
	speed: 0.1266s/iter; left time: 2542.7474s
Epoch: 3 cost time: 39.33743715286255
Epoch: 3, Steps: 274 | Train Loss: 0.2915984 Vali Loss: 0.2360934 Test Loss: 0.2669724
Validation loss decreased (0.254091 --> 0.236093).  Saving model ...
Updating learning rate to 1.2939415487410149e-05
	iters: 100, epoch: 4 | loss: 0.2757973
	speed: 0.5677s/iter; left time: 11299.5135s
	iters: 200, epoch: 4 | loss: 0.2561319
	speed: 0.1554s/iter; left time: 3077.4719s
Epoch: 4 cost time: 42.07391715049744
Epoch: 4, Steps: 274 | Train Loss: 0.2767420 Vali Loss: 0.2249002 Test Loss: 0.2569666
Validation loss decreased (0.236093 --> 0.224900).  Saving model ...
Updating learning rate to 1.9497497051221437e-05
	iters: 100, epoch: 5 | loss: 0.2693546
	speed: 0.5737s/iter; left time: 11261.6545s
	iters: 200, epoch: 5 | loss: 0.2655927
	speed: 0.1703s/iter; left time: 3325.8048s
Epoch: 5 cost time: 44.81078743934631
Epoch: 5, Steps: 274 | Train Loss: 0.2685999 Vali Loss: 0.2203045 Test Loss: 0.2496341
Validation loss decreased (0.224900 --> 0.220304).  Saving model ...
Updating learning rate to 2.7439752463841147e-05
	iters: 100, epoch: 6 | loss: 0.2516994
	speed: 0.5849s/iter; left time: 11321.5867s
	iters: 200, epoch: 6 | loss: 0.2524797
	speed: 0.1682s/iter; left time: 3237.9368s
Epoch: 6 cost time: 46.418182373046875
Epoch: 6, Steps: 274 | Train Loss: 0.2621377 Vali Loss: 0.2140387 Test Loss: 0.2469880
Validation loss decreased (0.220304 --> 0.214039).  Saving model ...
Updating learning rate to 3.642794739728445e-05
	iters: 100, epoch: 7 | loss: 0.2486109
	speed: 0.6129s/iter; left time: 11694.8083s
	iters: 200, epoch: 7 | loss: 0.2550364
	speed: 0.1679s/iter; left time: 3186.6447s
Epoch: 7 cost time: 46.603891372680664
Epoch: 7, Steps: 274 | Train Loss: 0.2575445 Vali Loss: 0.2121821 Test Loss: 0.2406588
Validation loss decreased (0.214039 --> 0.212182).  Saving model ...
Updating learning rate to 4.6079304426856645e-05
	iters: 100, epoch: 8 | loss: 0.2567452
	speed: 0.6053s/iter; left time: 11383.2599s
	iters: 200, epoch: 8 | loss: 0.2442422
	speed: 0.1665s/iter; left time: 3115.0084s
Epoch: 8 cost time: 45.39691352844238
Epoch: 8, Steps: 274 | Train Loss: 0.2538103 Vali Loss: 0.2099990 Test Loss: 0.2372917
Validation loss decreased (0.212182 --> 0.209999).  Saving model ...
Updating learning rate to 5.598280425269339e-05
	iters: 100, epoch: 9 | loss: 0.2598474
	speed: 0.5754s/iter; left time: 10663.7334s
	iters: 200, epoch: 9 | loss: 0.2515515
	speed: 0.1662s/iter; left time: 3062.8754s
Epoch: 9 cost time: 42.6078462600708
Epoch: 9, Steps: 274 | Train Loss: 0.2513312 Vali Loss: 0.2095039 Test Loss: 0.2358380
Validation loss decreased (0.209999 --> 0.209504).  Saving model ...
Updating learning rate to 6.571668964913709e-05
	iters: 100, epoch: 10 | loss: 0.2652637
	speed: 0.5702s/iter; left time: 10411.4374s
	iters: 200, epoch: 10 | loss: 0.2387822
	speed: 0.1470s/iter; left time: 2669.0799s
Epoch: 10 cost time: 40.57540273666382
Epoch: 10, Steps: 274 | Train Loss: 0.2486968 Vali Loss: 0.2057538 Test Loss: 0.2337817
Validation loss decreased (0.209504 --> 0.205754).  Saving model ...
Updating learning rate to 7.486642670677511e-05
	iters: 100, epoch: 11 | loss: 0.2245244
	speed: 0.5691s/iter; left time: 10235.3482s
	iters: 200, epoch: 11 | loss: 0.2478629
	speed: 0.1215s/iter; left time: 2173.4013s
Epoch: 11 cost time: 37.74137806892395
Epoch: 11, Steps: 274 | Train Loss: 0.2465931 Vali Loss: 0.2062022 Test Loss: 0.2316840
EarlyStopping counter: 1 out of 20
Updating learning rate to 8.304235845738519e-05
	iters: 100, epoch: 12 | loss: 0.2300051
	speed: 0.5681s/iter; left time: 10061.7033s
	iters: 200, epoch: 12 | loss: 0.2420622
	speed: 0.1266s/iter; left time: 2229.8313s
Epoch: 12 cost time: 35.076695680618286
Epoch: 12, Steps: 274 | Train Loss: 0.2439947 Vali Loss: 0.2042262 Test Loss: 0.2311157
Validation loss decreased (0.205754 --> 0.204226).  Saving model ...
Updating learning rate to 8.989629907242749e-05
	iters: 100, epoch: 13 | loss: 0.2532556
	speed: 0.5650s/iter; left time: 9851.7444s
	iters: 200, epoch: 13 | loss: 0.2414655
	speed: 0.1259s/iter; left time: 2183.5351s
Epoch: 13 cost time: 38.38340759277344
Epoch: 13, Steps: 274 | Train Loss: 0.2418631 Vali Loss: 0.2026659 Test Loss: 0.2266953
Validation loss decreased (0.204226 --> 0.202666).  Saving model ...
Updating learning rate to 9.513636194318215e-05
	iters: 100, epoch: 14 | loss: 0.2528550
	speed: 0.5709s/iter; left time: 9797.5240s
	iters: 200, epoch: 14 | loss: 0.2483743
	speed: 0.1459s/iter; left time: 2488.9793s
Epoch: 14 cost time: 40.82090735435486
Epoch: 14, Steps: 274 | Train Loss: 0.2401367 Vali Loss: 0.2025127 Test Loss: 0.2238306
Validation loss decreased (0.202666 --> 0.202513).  Saving model ...
Updating learning rate to 9.85393901637567e-05
	iters: 100, epoch: 15 | loss: 0.2391942
	speed: 0.5748s/iter; left time: 9708.2618s
	iters: 200, epoch: 15 | loss: 0.2462139
	speed: 0.1678s/iter; left time: 2817.0683s
Epoch: 15 cost time: 44.36535668373108
Epoch: 15, Steps: 274 | Train Loss: 0.2378304 Vali Loss: 0.2024743 Test Loss: 0.2215016
Validation loss decreased (0.202513 --> 0.202474).  Saving model ...
Updating learning rate to 9.99604600439018e-05
	iters: 100, epoch: 16 | loss: 0.2359805
	speed: 0.5807s/iter; left time: 9648.2234s
	iters: 200, epoch: 16 | loss: 0.2409364
	speed: 0.1670s/iter; left time: 2757.8268s
Epoch: 16 cost time: 46.32147026062012
Epoch: 16, Steps: 274 | Train Loss: 0.2363176 Vali Loss: 0.2023291 Test Loss: 0.2224756
Validation loss decreased (0.202474 --> 0.202329).  Saving model ...
Updating learning rate to 9.995689755020532e-05
	iters: 100, epoch: 17 | loss: 0.2263431
	speed: 0.6096s/iter; left time: 9961.3336s
	iters: 200, epoch: 17 | loss: 0.2279180
	speed: 0.1687s/iter; left time: 2739.9319s
Epoch: 17 cost time: 46.58631896972656
Epoch: 17, Steps: 274 | Train Loss: 0.2343980 Vali Loss: 0.2002519 Test Loss: 0.2182328
Validation loss decreased (0.202329 --> 0.200252).  Saving model ...
Updating learning rate to 9.978301942696751e-05
	iters: 100, epoch: 18 | loss: 0.2289031
	speed: 0.6026s/iter; left time: 9682.7324s
	iters: 200, epoch: 18 | loss: 0.2309474
	speed: 0.1674s/iter; left time: 2672.5175s
Epoch: 18 cost time: 45.58218026161194
Epoch: 18, Steps: 274 | Train Loss: 0.2326577 Vali Loss: 0.1978272 Test Loss: 0.2163447
Validation loss decreased (0.200252 --> 0.197827).  Saving model ...
Updating learning rate to 9.947625646081268e-05
	iters: 100, epoch: 19 | loss: 0.2416582
	speed: 0.5728s/iter; left time: 9046.5654s
	iters: 200, epoch: 19 | loss: 0.2328080
	speed: 0.1690s/iter; left time: 2652.5297s
Epoch: 19 cost time: 43.32833647727966
Epoch: 19, Steps: 274 | Train Loss: 0.2315227 Vali Loss: 0.1985162 Test Loss: 0.2166595
EarlyStopping counter: 1 out of 20
Updating learning rate to 9.903742749143364e-05
	iters: 100, epoch: 20 | loss: 0.2222560
	speed: 0.5575s/iter; left time: 8651.7567s
	iters: 200, epoch: 20 | loss: 0.2260264
	speed: 0.1471s/iter; left time: 2268.1768s
Epoch: 20 cost time: 40.43416881561279
Epoch: 20, Steps: 274 | Train Loss: 0.2298551 Vali Loss: 0.2000817 Test Loss: 0.2153009
EarlyStopping counter: 2 out of 20
Updating learning rate to 9.846770388114649e-05
	iters: 100, epoch: 21 | loss: 0.2325448
	speed: 0.5582s/iter; left time: 8509.9389s
	iters: 200, epoch: 21 | loss: 0.2351703
	speed: 0.1247s/iter; left time: 1888.4092s
Epoch: 21 cost time: 36.518317222595215
Epoch: 21, Steps: 274 | Train Loss: 0.2289423 Vali Loss: 0.1971640 Test Loss: 0.2149784
Validation loss decreased (0.197827 --> 0.197164).  Saving model ...
Updating learning rate to 9.776860638818327e-05
	iters: 100, epoch: 22 | loss: 0.2336203
	speed: 0.5660s/iter; left time: 8474.1861s
	iters: 200, epoch: 22 | loss: 0.2227879
	speed: 0.1281s/iter; left time: 1905.3004s
Epoch: 22 cost time: 36.332505226135254
Epoch: 22, Steps: 274 | Train Loss: 0.2276208 Vali Loss: 0.1983600 Test Loss: 0.2131494
EarlyStopping counter: 1 out of 20
Updating learning rate to 9.694200110734549e-05
	iters: 100, epoch: 23 | loss: 0.2238488
	speed: 0.5720s/iter; left time: 8406.2754s
	iters: 200, epoch: 23 | loss: 0.2310801
	speed: 0.1261s/iter; left time: 1840.3020s
Epoch: 23 cost time: 39.6435489654541
Epoch: 23, Steps: 274 | Train Loss: 0.2264939 Vali Loss: 0.1953408 Test Loss: 0.2149842
Validation loss decreased (0.197164 --> 0.195341).  Saving model ...
Updating learning rate to 9.599009448885357e-05
	iters: 100, epoch: 24 | loss: 0.2248294
	speed: 0.5776s/iter; left time: 8330.6988s
	iters: 200, epoch: 24 | loss: 0.2404718
	speed: 0.1497s/iter; left time: 2143.7674s
Epoch: 24 cost time: 41.341217279434204
Epoch: 24, Steps: 274 | Train Loss: 0.2251640 Vali Loss: 0.1949469 Test Loss: 0.2120219
Validation loss decreased (0.195341 --> 0.194947).  Saving model ...
Updating learning rate to 9.491542744868868e-05
	iters: 100, epoch: 25 | loss: 0.2223470
	speed: 0.5739s/iter; left time: 8119.6822s
	iters: 200, epoch: 25 | loss: 0.2321565
	speed: 0.1664s/iter; left time: 2337.5683s
Epoch: 25 cost time: 44.26435708999634
Epoch: 25, Steps: 274 | Train Loss: 0.2241380 Vali Loss: 0.1948059 Test Loss: 0.2110759
Validation loss decreased (0.194947 --> 0.194806).  Saving model ...
Updating learning rate to 9.372086858614804e-05
	iters: 100, epoch: 26 | loss: 0.2211295
	speed: 0.5845s/iter; left time: 8109.7242s
	iters: 200, epoch: 26 | loss: 0.2209657
	speed: 0.1682s/iter; left time: 2316.6426s
Epoch: 26 cost time: 46.12696075439453
Epoch: 26, Steps: 274 | Train Loss: 0.2232011 Vali Loss: 0.1954967 Test Loss: 0.2092364
EarlyStopping counter: 1 out of 20
Updating learning rate to 9.240960652671792e-05
	iters: 100, epoch: 27 | loss: 0.2156264
	speed: 0.6011s/iter; left time: 8175.1254s
	iters: 200, epoch: 27 | loss: 0.2087375
	speed: 0.1663s/iter; left time: 2245.4674s
Epoch: 27 cost time: 45.89736580848694
Epoch: 27, Steps: 274 | Train Loss: 0.2221491 Vali Loss: 0.1944067 Test Loss: 0.2087541
Validation loss decreased (0.194806 --> 0.194407).  Saving model ...
Updating learning rate to 9.098514141070365e-05
	iters: 100, epoch: 28 | loss: 0.2232375
	speed: 0.5757s/iter; left time: 7671.9521s
	iters: 200, epoch: 28 | loss: 0.1987217
	speed: 0.1658s/iter; left time: 2193.0445s
Epoch: 28 cost time: 42.541775703430176
Epoch: 28, Steps: 274 | Train Loss: 0.2210241 Vali Loss: 0.1953556 Test Loss: 0.2083879
EarlyStopping counter: 1 out of 20
Updating learning rate to 8.945127555033588e-05
	iters: 100, epoch: 29 | loss: 0.2128301
	speed: 0.5568s/iter; left time: 7268.2332s
	iters: 200, epoch: 29 | loss: 0.2192814
	speed: 0.1324s/iter; left time: 1714.9321s
Epoch: 29 cost time: 38.01236534118652
Epoch: 29, Steps: 274 | Train Loss: 0.2201671 Vali Loss: 0.1930823 Test Loss: 0.2073960
Validation loss decreased (0.194407 --> 0.193082).  Saving model ...
Updating learning rate to 8.781210328029188e-05
	iters: 100, epoch: 30 | loss: 0.2422423
	speed: 0.5501s/iter; left time: 7029.6278s
	iters: 200, epoch: 30 | loss: 0.2099854
	speed: 0.1289s/iter; left time: 1634.4896s
Epoch: 30 cost time: 35.434757232666016
Epoch: 30, Steps: 274 | Train Loss: 0.2194677 Vali Loss: 0.1934034 Test Loss: 0.2079805
EarlyStopping counter: 1 out of 20
Updating learning rate to 8.607200002872385e-05
	iters: 100, epoch: 31 | loss: 0.2217939
	speed: 0.5653s/iter; left time: 7069.3025s
	iters: 200, epoch: 31 | loss: 0.2120954
	speed: 0.1171s/iter; left time: 1452.4888s
Epoch: 31 cost time: 37.144493103027344
Epoch: 31, Steps: 274 | Train Loss: 0.2184717 Vali Loss: 0.1912459 Test Loss: 0.2061821
Validation loss decreased (0.193082 --> 0.191246).  Saving model ...
Updating learning rate to 8.42356106379671e-05
	iters: 100, epoch: 32 | loss: 0.2117609
	speed: 0.5590s/iter; left time: 6836.9234s
	iters: 200, epoch: 32 | loss: 0.2179685
	speed: 0.1594s/iter; left time: 1933.5101s
Epoch: 32 cost time: 41.41310787200928
Epoch: 32, Steps: 274 | Train Loss: 0.2175092 Vali Loss: 0.1903427 Test Loss: 0.2058370
Validation loss decreased (0.191246 --> 0.190343).  Saving model ...
Updating learning rate to 8.230783696610304e-05
	iters: 100, epoch: 33 | loss: 0.2123384
	speed: 0.5558s/iter; left time: 6645.1927s
	iters: 200, epoch: 33 | loss: 0.2012430
	speed: 0.1603s/iter; left time: 1901.1277s
Epoch: 33 cost time: 44.41167736053467
Epoch: 33, Steps: 274 | Train Loss: 0.2167283 Vali Loss: 0.1912919 Test Loss: 0.2051109
EarlyStopping counter: 1 out of 20
Updating learning rate to 8.029382480247258e-05
	iters: 100, epoch: 34 | loss: 0.2203913
	speed: 0.5882s/iter; left time: 6871.5106s
	iters: 200, epoch: 34 | loss: 0.2127220
	speed: 0.1625s/iter; left time: 1881.9954s
Epoch: 34 cost time: 45.01293754577637
Epoch: 34, Steps: 274 | Train Loss: 0.2158998 Vali Loss: 0.1920138 Test Loss: 0.2051534
EarlyStopping counter: 2 out of 20
Updating learning rate to 7.819895013206565e-05
	iters: 100, epoch: 35 | loss: 0.2121341
	speed: 0.5648s/iter; left time: 6443.7728s
	iters: 200, epoch: 35 | loss: 0.2131429
	speed: 0.1635s/iter; left time: 1849.5333s
Epoch: 35 cost time: 41.78680419921875
Epoch: 35, Steps: 274 | Train Loss: 0.2152620 Vali Loss: 0.1902744 Test Loss: 0.2045711
Validation loss decreased (0.190343 --> 0.190274).  Saving model ...
Updating learning rate to 7.602880478545177e-05
	iters: 100, epoch: 36 | loss: 0.1902714
	speed: 0.5556s/iter; left time: 6186.1303s
	iters: 200, epoch: 36 | loss: 0.2125571
	speed: 0.1258s/iter; left time: 1387.7723s
Epoch: 36 cost time: 37.529624462127686
Epoch: 36, Steps: 274 | Train Loss: 0.2142361 Vali Loss: 0.1926322 Test Loss: 0.2048111
EarlyStopping counter: 1 out of 20
Updating learning rate to 7.378918151255571e-05
	iters: 100, epoch: 37 | loss: 0.2212703
	speed: 0.5594s/iter; left time: 6075.2291s
	iters: 200, epoch: 37 | loss: 0.2086096
	speed: 0.1264s/iter; left time: 1360.2781s
Epoch: 37 cost time: 34.46461892127991
Epoch: 37, Steps: 274 | Train Loss: 0.2136458 Vali Loss: 0.1901337 Test Loss: 0.2037960
Validation loss decreased (0.190274 --> 0.190134).  Saving model ...
Updating learning rate to 7.148605852012105e-05
	iters: 100, epoch: 38 | loss: 0.2198159
	speed: 0.5654s/iter; left time: 5985.5604s
	iters: 200, epoch: 38 | loss: 0.2112673
	speed: 0.1156s/iter; left time: 1212.4185s
Epoch: 38 cost time: 36.92428278923035
Epoch: 38, Steps: 274 | Train Loss: 0.2130983 Vali Loss: 0.1894764 Test Loss: 0.2025973
Validation loss decreased (0.190134 --> 0.189476).  Saving model ...
Updating learning rate to 6.91255835141354e-05
	iters: 100, epoch: 39 | loss: 0.2052023
	speed: 0.5544s/iter; left time: 5717.1119s
	iters: 200, epoch: 39 | loss: 0.2010026
	speed: 0.1603s/iter; left time: 1637.2596s
Epoch: 39 cost time: 41.846850872039795
Epoch: 39, Steps: 274 | Train Loss: 0.2122881 Vali Loss: 0.1888953 Test Loss: 0.2032775
Validation loss decreased (0.189476 --> 0.188895).  Saving model ...
Updating learning rate to 6.671405728981257e-05
	iters: 100, epoch: 40 | loss: 0.2059699
	speed: 0.5603s/iter; left time: 5624.4353s
	iters: 200, epoch: 40 | loss: 0.2055774
	speed: 0.1605s/iter; left time: 1595.4151s
Epoch: 40 cost time: 44.45060157775879
Epoch: 40, Steps: 274 | Train Loss: 0.2117313 Vali Loss: 0.1895640 Test Loss: 0.2037310
EarlyStopping counter: 1 out of 20
Updating learning rate to 6.425791691293552e-05
	iters: 100, epoch: 41 | loss: 0.2111896
	speed: 0.5852s/iter; left time: 5714.9054s
	iters: 200, epoch: 41 | loss: 0.2063435
	speed: 0.1599s/iter; left time: 1545.6724s
Epoch: 41 cost time: 44.38514018058777
Epoch: 41, Steps: 274 | Train Loss: 0.2110325 Vali Loss: 0.1879859 Test Loss: 0.2018458
Validation loss decreased (0.188895 --> 0.187986).  Saving model ...
Updating learning rate to 6.176371853745291e-05
	iters: 100, epoch: 42 | loss: 0.2093756
	speed: 0.5499s/iter; left time: 5219.1683s
	iters: 200, epoch: 42 | loss: 0.2160368
	speed: 0.1600s/iter; left time: 1502.5434s
Epoch: 42 cost time: 40.187623739242554
Epoch: 42, Steps: 274 | Train Loss: 0.2102190 Vali Loss: 0.1888378 Test Loss: 0.2018372
EarlyStopping counter: 1 out of 20
Updating learning rate to 5.92381199051951e-05
	iters: 100, epoch: 43 | loss: 0.2016138
	speed: 0.5484s/iter; left time: 5054.4322s
	iters: 200, epoch: 43 | loss: 0.2066492
	speed: 0.1186s/iter; left time: 1080.9156s
Epoch: 43 cost time: 36.768717765808105
Epoch: 43, Steps: 274 | Train Loss: 0.2098052 Vali Loss: 0.1879946 Test Loss: 0.2009321
EarlyStopping counter: 2 out of 20
Updating learning rate to 5.668786257442217e-05
	iters: 100, epoch: 44 | loss: 0.1998383
	speed: 0.5645s/iter; left time: 5048.0635s
	iters: 200, epoch: 44 | loss: 0.2129869
	speed: 0.1229s/iter; left time: 1087.0119s
Epoch: 44 cost time: 35.55939555168152
Epoch: 44, Steps: 274 | Train Loss: 0.2090510 Vali Loss: 0.1887848 Test Loss: 0.2015477
EarlyStopping counter: 3 out of 20
Updating learning rate to 5.4119753924641705e-05
	iters: 100, epoch: 45 | loss: 0.2022017
	speed: 0.5617s/iter; left time: 4869.1988s
	iters: 200, epoch: 45 | loss: 0.2136659
	speed: 0.1319s/iter; left time: 1130.6594s
Epoch: 45 cost time: 38.967047452926636
Epoch: 45, Steps: 274 | Train Loss: 0.2086658 Vali Loss: 0.1880116 Test Loss: 0.2013953
EarlyStopping counter: 4 out of 20
Updating learning rate to 5.154064898573048e-05
	iters: 100, epoch: 46 | loss: 0.2044304
	speed: 0.5565s/iter; left time: 4671.6750s
	iters: 200, epoch: 46 | loss: 0.2168903
	speed: 0.1632s/iter; left time: 1353.8477s
Epoch: 46 cost time: 42.86724376678467
Epoch: 46, Steps: 274 | Train Loss: 0.2081565 Vali Loss: 0.1872799 Test Loss: 0.2011381
Validation loss decreased (0.187986 --> 0.187280).  Saving model ...
Updating learning rate to 4.895743213986326e-05
	iters: 100, epoch: 47 | loss: 0.2137722
	speed: 0.5649s/iter; left time: 4587.3759s
	iters: 200, epoch: 47 | loss: 0.2147117
	speed: 0.1600s/iter; left time: 1283.7136s
Epoch: 47 cost time: 44.27114796638489
Epoch: 47, Steps: 274 | Train Loss: 0.2074284 Vali Loss: 0.1869380 Test Loss: 0.2002588
Validation loss decreased (0.187280 --> 0.186938).  Saving model ...
Updating learning rate to 4.637699874509198e-05
	iters: 100, epoch: 48 | loss: 0.2216574
	speed: 0.5839s/iter; left time: 4582.1795s
	iters: 200, epoch: 48 | loss: 0.2007479
	speed: 0.1615s/iter; left time: 1250.7794s
Epoch: 48 cost time: 43.943629026412964
Epoch: 48, Steps: 274 | Train Loss: 0.2069817 Vali Loss: 0.1869934 Test Loss: 0.2002350
EarlyStopping counter: 1 out of 20
Updating learning rate to 4.3806236729627004e-05
	iters: 100, epoch: 49 | loss: 0.2224541
	speed: 0.5553s/iter; left time: 4205.5872s
	iters: 200, epoch: 49 | loss: 0.1989223
	speed: 0.1584s/iter; left time: 1183.5027s
Epoch: 49 cost time: 40.330480337142944
Epoch: 49, Steps: 274 | Train Loss: 0.2067205 Vali Loss: 0.1870797 Test Loss: 0.2013696
EarlyStopping counter: 2 out of 20
Updating learning rate to 4.125200820595079e-05
	iters: 100, epoch: 50 | loss: 0.2039368
	speed: 0.5560s/iter; left time: 4057.8982s
	iters: 200, epoch: 50 | loss: 0.2099764
	speed: 0.1199s/iter; left time: 863.1048s
Epoch: 50 cost time: 36.724440813064575
Epoch: 50, Steps: 274 | Train Loss: 0.2060322 Vali Loss: 0.1857580 Test Loss: 0.2001046
Validation loss decreased (0.186938 --> 0.185758).  Saving model ...
Updating learning rate to 3.8721131153841304e-05
	iters: 100, epoch: 51 | loss: 0.2208006
	speed: 0.5673s/iter; left time: 3985.6289s
	iters: 200, epoch: 51 | loss: 0.1995533
	speed: 0.1210s/iter; left time: 837.6127s
Epoch: 51 cost time: 35.13079071044922
Epoch: 51, Steps: 274 | Train Loss: 0.2055784 Vali Loss: 0.1878752 Test Loss: 0.2002774
EarlyStopping counter: 1 out of 20
Updating learning rate to 3.622036122119847e-05
	iters: 100, epoch: 52 | loss: 0.2027859
	speed: 0.5574s/iter; left time: 3763.1216s
	iters: 200, epoch: 52 | loss: 0.2250801
	speed: 0.1299s/iter; left time: 863.9045s
Epoch: 52 cost time: 38.38199591636658
Epoch: 52, Steps: 274 | Train Loss: 0.2051122 Vali Loss: 0.1850524 Test Loss: 0.1997975
Validation loss decreased (0.185758 --> 0.185052).  Saving model ...
Updating learning rate to 3.375637369125236e-05
	iters: 100, epoch: 53 | loss: 0.1982393
	speed: 0.5527s/iter; left time: 3579.7399s
	iters: 200, epoch: 53 | loss: 0.2105655
	speed: 0.1596s/iter; left time: 1017.5345s
Epoch: 53 cost time: 42.7383508682251
Epoch: 53, Steps: 274 | Train Loss: 0.2047433 Vali Loss: 0.1855343 Test Loss: 0.1994057
EarlyStopping counter: 1 out of 20
Updating learning rate to 3.1335745664288545e-05
	iters: 100, epoch: 54 | loss: 0.2125051
	speed: 0.5693s/iter; left time: 3531.4795s
	iters: 200, epoch: 54 | loss: 0.1975338
	speed: 0.1598s/iter; left time: 975.4500s
Epoch: 54 cost time: 44.19754099845886
Epoch: 54, Steps: 274 | Train Loss: 0.2042532 Vali Loss: 0.1851384 Test Loss: 0.1997979
EarlyStopping counter: 2 out of 20
Updating learning rate to 2.8964938501451814e-05
	iters: 100, epoch: 55 | loss: 0.1989558
	speed: 0.5815s/iter; left time: 3447.8254s
	iters: 200, epoch: 55 | loss: 0.2076702
	speed: 0.1601s/iter; left time: 933.1086s
Epoch: 55 cost time: 43.560646772384644
Epoch: 55, Steps: 274 | Train Loss: 0.2040805 Vali Loss: 0.1850610 Test Loss: 0.1996144
EarlyStopping counter: 3 out of 20
Updating learning rate to 2.665028057749164e-05
	iters: 100, epoch: 56 | loss: 0.2090128
	speed: 0.5461s/iter; left time: 3087.9918s
	iters: 200, epoch: 56 | loss: 0.1965889
	speed: 0.0999s/iter; left time: 554.6880s
Epoch: 56 cost time: 30.821675062179565
Epoch: 56, Steps: 274 | Train Loss: 0.2038098 Vali Loss: 0.1850387 Test Loss: 0.1992286
Validation loss decreased (0.185052 --> 0.185039).  Saving model ...
Updating learning rate to 2.439795038848706e-05
	iters: 100, epoch: 57 | loss: 0.2144418
	speed: 0.4673s/iter; left time: 2514.7734s
	iters: 200, epoch: 57 | loss: 0.2109684
	speed: 0.1006s/iter; left time: 531.1508s
Epoch: 57 cost time: 28.589566469192505
Epoch: 57, Steps: 274 | Train Loss: 0.2033687 Vali Loss: 0.1851263 Test Loss: 0.1992144
EarlyStopping counter: 1 out of 20
Updating learning rate to 2.2213960059641262e-05
	iters: 100, epoch: 58 | loss: 0.2019251
	speed: 0.4619s/iter; left time: 2358.9994s
	iters: 200, epoch: 58 | loss: 0.2138743
	speed: 0.1140s/iter; left time: 570.9427s
Epoch: 58 cost time: 31.87434458732605
Epoch: 58, Steps: 274 | Train Loss: 0.2031391 Vali Loss: 0.1845863 Test Loss: 0.1989404
Validation loss decreased (0.185039 --> 0.184586).  Saving model ...
Updating learning rate to 2.0104139297168597e-05
	iters: 100, epoch: 59 | loss: 0.2070840
	speed: 0.5164s/iter; left time: 2495.7972s
	iters: 200, epoch: 59 | loss: 0.2055780
	speed: 0.1289s/iter; left time: 610.0374s
Epoch: 59 cost time: 35.63943147659302
Epoch: 59, Steps: 274 | Train Loss: 0.2027957 Vali Loss: 0.1853833 Test Loss: 0.1997892
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.807411982711093e-05
	iters: 100, epoch: 60 | loss: 0.2137937
	speed: 0.5134s/iter; left time: 2340.5377s
	iters: 200, epoch: 60 | loss: 0.2123729
	speed: 0.1306s/iter; left time: 582.4860s
Epoch: 60 cost time: 35.76198363304138
Epoch: 60, Steps: 274 | Train Loss: 0.2024604 Vali Loss: 0.1844801 Test Loss: 0.1991794
Validation loss decreased (0.184586 --> 0.184480).  Saving model ...
Updating learning rate to 1.612932036262078e-05
	iters: 100, epoch: 61 | loss: 0.1932487
	speed: 0.5191s/iter; left time: 2224.3021s
	iters: 200, epoch: 61 | loss: 0.2024244
	speed: 0.1303s/iter; left time: 545.1387s
Epoch: 61 cost time: 35.55465602874756
Epoch: 61, Steps: 274 | Train Loss: 0.2022515 Vali Loss: 0.1841553 Test Loss: 0.1993866
Validation loss decreased (0.184480 --> 0.184155).  Saving model ...
Updating learning rate to 1.427493213983777e-05
	iters: 100, epoch: 62 | loss: 0.2189584
	speed: 0.5152s/iter; left time: 2066.5072s
	iters: 200, epoch: 62 | loss: 0.1999720
	speed: 0.1292s/iter; left time: 505.4814s
Epoch: 62 cost time: 35.56630778312683
Epoch: 62, Steps: 274 | Train Loss: 0.2020960 Vali Loss: 0.1845939 Test Loss: 0.1990977
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.2515905060967695e-05
	iters: 100, epoch: 63 | loss: 0.2053725
	speed: 0.5207s/iter; left time: 1945.6751s
	iters: 200, epoch: 63 | loss: 0.2014537
	speed: 0.1272s/iter; left time: 462.4994s
Epoch: 63 cost time: 35.776994705200195
Epoch: 63, Steps: 274 | Train Loss: 0.2018764 Vali Loss: 0.1844815 Test Loss: 0.1988585
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.085693448155198e-05
	iters: 100, epoch: 64 | loss: 0.2004567
	speed: 0.5223s/iter; left time: 1808.8370s
	iters: 200, epoch: 64 | loss: 0.1898172
	speed: 0.1243s/iter; left time: 417.9534s
Epoch: 64 cost time: 35.929200887680054
Epoch: 64, Steps: 274 | Train Loss: 0.2015743 Vali Loss: 0.1842996 Test Loss: 0.1988433
EarlyStopping counter: 3 out of 20
Updating learning rate to 9.30244867719627e-06
	iters: 100, epoch: 65 | loss: 0.2098504
	speed: 0.5235s/iter; left time: 1669.3262s
	iters: 200, epoch: 65 | loss: 0.2032257
	speed: 0.1287s/iter; left time: 397.4114s
Epoch: 65 cost time: 35.90788912773132
Epoch: 65, Steps: 274 | Train Loss: 0.2013725 Vali Loss: 0.1842418 Test Loss: 0.1988033
EarlyStopping counter: 4 out of 20
Updating learning rate to 7.856597023213313e-06
	iters: 100, epoch: 66 | loss: 0.1983713
	speed: 0.5161s/iter; left time: 1504.4245s
	iters: 200, epoch: 66 | loss: 0.2024469
	speed: 0.1296s/iter; left time: 364.7763s
Epoch: 66 cost time: 35.706946849823
Epoch: 66, Steps: 274 | Train Loss: 0.2014089 Vali Loss: 0.1839846 Test Loss: 0.1991501
Validation loss decreased (0.184155 --> 0.183985).  Saving model ...
Updating learning rate to 6.52323891873179e-06
	iters: 100, epoch: 67 | loss: 0.2071285
	speed: 0.5238s/iter; left time: 1383.3241s
	iters: 200, epoch: 67 | loss: 0.2031762
	speed: 0.1321s/iter; left time: 335.6989s
Epoch: 67 cost time: 36.01968574523926
Epoch: 67, Steps: 274 | Train Loss: 0.2011657 Vali Loss: 0.1844112 Test Loss: 0.1988689
EarlyStopping counter: 1 out of 20
Updating learning rate to 5.305933484836166e-06
	iters: 100, epoch: 68 | loss: 0.1945505
	speed: 0.5205s/iter; left time: 1232.1200s
	iters: 200, epoch: 68 | loss: 0.2143973
	speed: 0.1286s/iter; left time: 291.6328s
Epoch: 68 cost time: 35.0343816280365
Epoch: 68, Steps: 274 | Train Loss: 0.2010717 Vali Loss: 0.1837332 Test Loss: 0.1988592
Validation loss decreased (0.183985 --> 0.183733).  Saving model ...
Updating learning rate to 4.207930064235981e-06
	iters: 100, epoch: 69 | loss: 0.2168753
	speed: 0.5132s/iter; left time: 1074.0712s
	iters: 200, epoch: 69 | loss: 0.2065921
	speed: 0.1257s/iter; left time: 250.5408s
Epoch: 69 cost time: 35.42228055000305
Epoch: 69, Steps: 274 | Train Loss: 0.2009361 Vali Loss: 0.1839679 Test Loss: 0.1990089
EarlyStopping counter: 1 out of 20
Updating learning rate to 3.232159547823886e-06
	iters: 100, epoch: 70 | loss: 0.2110874
	speed: 0.5137s/iter; left time: 934.3750s
	iters: 200, epoch: 70 | loss: 0.1939318
	speed: 0.1233s/iter; left time: 211.9814s
Epoch: 70 cost time: 34.977598667144775
Epoch: 70, Steps: 274 | Train Loss: 0.2008685 Vali Loss: 0.1835116 Test Loss: 0.1987416
Validation loss decreased (0.183733 --> 0.183512).  Saving model ...
Updating learning rate to 2.3812265512743104e-06
	iters: 100, epoch: 71 | loss: 0.2041484
	speed: 0.5208s/iter; left time: 804.5839s
	iters: 200, epoch: 71 | loss: 0.1908380
	speed: 0.1303s/iter; left time: 188.3428s
Epoch: 71 cost time: 35.50579071044922
Epoch: 71, Steps: 274 | Train Loss: 0.2007002 Vali Loss: 0.1839896 Test Loss: 0.1988475
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.657402462565684e-06
	iters: 100, epoch: 72 | loss: 0.1969733
	speed: 0.5208s/iter; left time: 661.9693s
	iters: 200, epoch: 72 | loss: 0.2089181
	speed: 0.1316s/iter; left time: 154.1274s
Epoch: 72 cost time: 35.66077160835266
Epoch: 72, Steps: 274 | Train Loss: 0.2006228 Vali Loss: 0.1836969 Test Loss: 0.1986590
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.0626193789844829e-06
	iters: 100, epoch: 73 | loss: 0.1912276
	speed: 0.5140s/iter; left time: 512.5046s
	iters: 200, epoch: 73 | loss: 0.2048231
	speed: 0.1264s/iter; left time: 113.3443s
Epoch: 73 cost time: 35.17759346961975
Epoch: 73, Steps: 274 | Train Loss: 0.2005917 Vali Loss: 0.1839422 Test Loss: 0.1986676
EarlyStopping counter: 3 out of 20
Updating learning rate to 5.984649497948775e-07
	iters: 100, epoch: 74 | loss: 0.2000259
	speed: 0.5197s/iter; left time: 375.7617s
	iters: 200, epoch: 74 | loss: 0.1906799
	speed: 0.1244s/iter; left time: 77.5017s
Epoch: 74 cost time: 35.47909903526306
Epoch: 74, Steps: 274 | Train Loss: 0.2006480 Vali Loss: 0.1840078 Test Loss: 0.1987810
EarlyStopping counter: 4 out of 20
Updating learning rate to 2.6617813834048876e-07
	iters: 100, epoch: 75 | loss: 0.2059092
	speed: 0.5179s/iter; left time: 232.5502s
	iters: 200, epoch: 75 | loss: 0.2100184
	speed: 0.1287s/iter; left time: 44.8997s
Epoch: 75 cost time: 35.099799394607544
Epoch: 75, Steps: 274 | Train Loss: 0.2004988 Vali Loss: 0.1841307 Test Loss: 0.1986680
EarlyStopping counter: 5 out of 20
Updating learning rate to 6.664591489040955e-08
	iters: 100, epoch: 76 | loss: 0.1972794
	speed: 0.5190s/iter; left time: 90.8179s
	iters: 200, epoch: 76 | loss: 0.1993567
	speed: 0.1269s/iter; left time: 9.5148s
Epoch: 76 cost time: 34.76327967643738
Epoch: 76, Steps: 274 | Train Loss: 0.2005001 Vali Loss: 0.1838119 Test Loss: 0.1985794
EarlyStopping counter: 6 out of 20
Updating learning rate to 4.0088905725761456e-10
>>>>>>>testing : 96_720_SPM_TST_custom_ftM_sl96_ll18_pl720_dm256_nh1_el1_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
mse:0.19873982667922974, mae:0.2920393943786621, rse:0.445134699344635
