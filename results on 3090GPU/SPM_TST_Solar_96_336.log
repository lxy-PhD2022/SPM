Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=64, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=256, data='Solar', data_path='solar_AL.txt', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', dishts=1, distil=True, do_predict=False, dropout=0.2, e_layers=1, embed='timeF', embed_type=0, enc_in=137, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, hidden_size=[32, 8], hidden_size1=3, hidden_size2=3, individual=0, is_training=1, itr=1, k=1.0, kernel_size=25, label_len=18, learning_rate=0.0001, loss='mse', lradj='TST', model='SPM_TST', model_id='96_336', moving_avg=25, n_heads=1, num_layers=3, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=8, pct_start=0.2, pred_len=336, random_seed=2021, revin=1, root_path='./dataset/', seq_len=96, stride=8, subtract_last=0, target='OT', test_flop=False, traffic=0, train_epochs=300, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : 96_336_SPM_TST_Solar_ftM_sl96_ll18_pl336_dm256_nh1_el1_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36361
val 4921
test 10177
	iters: 100, epoch: 1 | loss: 1.0072889
	speed: 0.0504s/iter; left time: 8581.2551s
	iters: 200, epoch: 1 | loss: 0.7399496
	speed: 0.0334s/iter; left time: 5683.5774s
	iters: 300, epoch: 1 | loss: 0.5417804
	speed: 0.0350s/iter; left time: 5951.5210s
	iters: 400, epoch: 1 | loss: 0.4282875
	speed: 0.0374s/iter; left time: 6351.4758s
	iters: 500, epoch: 1 | loss: 0.3387321
	speed: 0.0363s/iter; left time: 6171.4674s
Epoch: 1 cost time: 20.88709330558777
Epoch: 1, Steps: 568 | Train Loss: 0.6719234 Vali Loss: 0.3201017 Test Loss: 0.4165701
Validation loss decreased (inf --> 0.320102).  Saving model ...
Updating learning rate to 4.065786191533746e-06
	iters: 100, epoch: 2 | loss: 0.2888987
	speed: 0.1661s/iter; left time: 28187.2588s
	iters: 200, epoch: 2 | loss: 0.2656114
	speed: 0.0364s/iter; left time: 6173.9923s
	iters: 300, epoch: 2 | loss: 0.3674415
	speed: 0.0370s/iter; left time: 6273.9329s
	iters: 400, epoch: 2 | loss: 0.2897000
	speed: 0.0366s/iter; left time: 6208.4982s
	iters: 500, epoch: 2 | loss: 0.2617854
	speed: 0.0362s/iter; left time: 6123.5523s
Epoch: 2 cost time: 21.542961835861206
Epoch: 2, Steps: 568 | Train Loss: 0.3130316 Vali Loss: 0.2672495 Test Loss: 0.3775755
Validation loss decreased (0.320102 --> 0.267250).  Saving model ...
Updating learning rate to 4.262964440176817e-06
	iters: 100, epoch: 3 | loss: 0.3146804
	speed: 0.1934s/iter; left time: 32708.4170s
	iters: 200, epoch: 3 | loss: 0.2626746
	speed: 0.0367s/iter; left time: 6199.7507s
	iters: 300, epoch: 3 | loss: 0.2369690
	speed: 0.0356s/iter; left time: 6015.0729s
	iters: 400, epoch: 3 | loss: 0.2463000
	speed: 0.0359s/iter; left time: 6069.4262s
	iters: 500, epoch: 3 | loss: 0.3450049
	speed: 0.0362s/iter; left time: 6115.2881s
Epoch: 3 cost time: 21.400107622146606
Epoch: 3, Steps: 568 | Train Loss: 0.2962368 Vali Loss: 0.2549439 Test Loss: 0.3605555
Validation loss decreased (0.267250 --> 0.254944).  Saving model ...
Updating learning rate to 4.590994262344556e-06
	iters: 100, epoch: 4 | loss: 0.2746796
	speed: 0.1928s/iter; left time: 32508.3519s
	iters: 200, epoch: 4 | loss: 0.2847739
	speed: 0.0371s/iter; left time: 6251.5433s
	iters: 300, epoch: 4 | loss: 0.2941862
	speed: 0.0355s/iter; left time: 5982.5752s
	iters: 400, epoch: 4 | loss: 0.2779582
	speed: 0.0362s/iter; left time: 6086.3084s
	iters: 500, epoch: 4 | loss: 0.2873226
	speed: 0.0373s/iter; left time: 6278.6257s
Epoch: 4 cost time: 21.545835256576538
Epoch: 4, Steps: 568 | Train Loss: 0.2874473 Vali Loss: 0.2478715 Test Loss: 0.3544915
Validation loss decreased (0.254944 --> 0.247871).  Saving model ...
Updating learning rate to 5.0489764983407075e-06
	iters: 100, epoch: 5 | loss: 0.2724996
	speed: 0.2023s/iter; left time: 33985.3794s
	iters: 200, epoch: 5 | loss: 0.2466719
	speed: 0.0355s/iter; left time: 5961.0766s
	iters: 300, epoch: 5 | loss: 0.3622646
	speed: 0.0368s/iter; left time: 6181.9329s
	iters: 400, epoch: 5 | loss: 0.2713818
	speed: 0.0371s/iter; left time: 6230.8727s
	iters: 500, epoch: 5 | loss: 0.2750824
	speed: 0.0360s/iter; left time: 6042.6438s
Epoch: 5 cost time: 21.580385208129883
Epoch: 5, Steps: 568 | Train Loss: 0.2797740 Vali Loss: 0.2393998 Test Loss: 0.3401490
Validation loss decreased (0.247871 --> 0.239400).  Saving model ...
Updating learning rate to 5.635655777036267e-06
	iters: 100, epoch: 6 | loss: 0.2526534
	speed: 0.1933s/iter; left time: 32371.3790s
	iters: 200, epoch: 6 | loss: 0.2475523
	speed: 0.0376s/iter; left time: 6285.1938s
	iters: 300, epoch: 6 | loss: 0.2287793
	speed: 0.0364s/iter; left time: 6095.5556s
	iters: 400, epoch: 6 | loss: 0.2828727
	speed: 0.0375s/iter; left time: 6270.9288s
	iters: 500, epoch: 6 | loss: 0.2356634
	speed: 0.0352s/iter; left time: 5872.5843s
Epoch: 6 cost time: 21.72367811203003
Epoch: 6, Steps: 568 | Train Loss: 0.2720149 Vali Loss: 0.2311836 Test Loss: 0.3319682
Validation loss decreased (0.239400 --> 0.231184).  Saving model ...
Updating learning rate to 6.34942395695635e-06
	iters: 100, epoch: 7 | loss: 0.2913256
	speed: 0.1952s/iter; left time: 32570.4611s
	iters: 200, epoch: 7 | loss: 0.2596230
	speed: 0.0348s/iter; left time: 5807.4652s
	iters: 300, epoch: 7 | loss: 0.2734495
	speed: 0.0361s/iter; left time: 6013.8126s
	iters: 400, epoch: 7 | loss: 0.2769034
	speed: 0.0369s/iter; left time: 6155.1445s
	iters: 500, epoch: 7 | loss: 0.2559261
	speed: 0.0375s/iter; left time: 6246.3507s
Epoch: 7 cost time: 21.753416776657104
Epoch: 7, Steps: 568 | Train Loss: 0.2640430 Vali Loss: 0.2231318 Test Loss: 0.3201555
Validation loss decreased (0.231184 --> 0.223132).  Saving model ...
Updating learning rate to 7.18832453434284e-06
	iters: 100, epoch: 8 | loss: 0.2543516
	speed: 0.1909s/iter; left time: 31752.7145s
	iters: 200, epoch: 8 | loss: 0.2726380
	speed: 0.0374s/iter; left time: 6214.9313s
	iters: 300, epoch: 8 | loss: 0.2662382
	speed: 0.0348s/iter; left time: 5773.8413s
	iters: 400, epoch: 8 | loss: 0.2542831
	speed: 0.0372s/iter; left time: 6182.7777s
	iters: 500, epoch: 8 | loss: 0.2530173
	speed: 0.0361s/iter; left time: 5996.4181s
Epoch: 8 cost time: 21.57258439064026
Epoch: 8, Steps: 568 | Train Loss: 0.2572683 Vali Loss: 0.2163109 Test Loss: 0.3085239
Validation loss decreased (0.223132 --> 0.216311).  Saving model ...
Updating learning rate to 8.150058006109852e-06
	iters: 100, epoch: 9 | loss: 0.2206632
	speed: 0.1882s/iter; left time: 31190.8396s
	iters: 200, epoch: 9 | loss: 0.2572587
	speed: 0.0371s/iter; left time: 6144.0619s
	iters: 300, epoch: 9 | loss: 0.2365460
	speed: 0.0371s/iter; left time: 6149.6052s
	iters: 400, epoch: 9 | loss: 0.2270688
	speed: 0.0350s/iter; left time: 5798.9884s
	iters: 500, epoch: 9 | loss: 0.2660736
	speed: 0.0351s/iter; left time: 5806.6591s
Epoch: 9 cost time: 21.418734073638916
Epoch: 9, Steps: 568 | Train Loss: 0.2514368 Vali Loss: 0.2097319 Test Loss: 0.3016350
Validation loss decreased (0.216311 --> 0.209732).  Saving model ...
Updating learning rate to 9.231988172991575e-06
	iters: 100, epoch: 10 | loss: 0.2546396
	speed: 0.1904s/iter; left time: 31455.1831s
	iters: 200, epoch: 10 | loss: 0.1904986
	speed: 0.0361s/iter; left time: 5956.9300s
	iters: 300, epoch: 10 | loss: 0.2493137
	speed: 0.0373s/iter; left time: 6161.1125s
	iters: 400, epoch: 10 | loss: 0.2302538
	speed: 0.0378s/iter; left time: 6235.1063s
	iters: 500, epoch: 10 | loss: 0.2327209
	speed: 0.0360s/iter; left time: 5937.4383s
Epoch: 10 cost time: 21.66418719291687
Epoch: 10, Steps: 568 | Train Loss: 0.2467448 Vali Loss: 0.2069913 Test Loss: 0.2988623
Validation loss decreased (0.209732 --> 0.206991).  Saving model ...
Updating learning rate to 1.043114936560537e-05
	iters: 100, epoch: 11 | loss: 0.2637211
	speed: 0.1895s/iter; left time: 31194.3895s
	iters: 200, epoch: 11 | loss: 0.2471183
	speed: 0.0359s/iter; left time: 5904.5720s
	iters: 300, epoch: 11 | loss: 0.2691484
	speed: 0.0365s/iter; left time: 6009.5228s
	iters: 400, epoch: 11 | loss: 0.2064997
	speed: 0.0373s/iter; left time: 6126.8709s
	iters: 500, epoch: 11 | loss: 0.2185250
	speed: 0.0364s/iter; left time: 5985.1546s
Epoch: 11 cost time: 21.708638906478882
Epoch: 11, Steps: 568 | Train Loss: 0.2430190 Vali Loss: 0.2048856 Test Loss: 0.2933397
Validation loss decreased (0.206991 --> 0.204886).  Saving model ...
Updating learning rate to 1.174425457362218e-05
	iters: 100, epoch: 12 | loss: 0.2519583
	speed: 0.1923s/iter; left time: 31545.8501s
	iters: 200, epoch: 12 | loss: 0.2178994
	speed: 0.0368s/iter; left time: 6039.3187s
	iters: 300, epoch: 12 | loss: 0.2136404
	speed: 0.0363s/iter; left time: 5945.9307s
	iters: 400, epoch: 12 | loss: 0.2317813
	speed: 0.0354s/iter; left time: 5798.5669s
	iters: 500, epoch: 12 | loss: 0.2677836
	speed: 0.0366s/iter; left time: 5985.7123s
Epoch: 12 cost time: 21.650919198989868
Epoch: 12, Steps: 568 | Train Loss: 0.2397217 Vali Loss: 0.2016624 Test Loss: 0.2881716
Validation loss decreased (0.204886 --> 0.201662).  Saving model ...
Updating learning rate to 1.3167704455762053e-05
	iters: 100, epoch: 13 | loss: 0.2698773
	speed: 0.1929s/iter; left time: 31544.3451s
	iters: 200, epoch: 13 | loss: 0.2152189
	speed: 0.0361s/iter; left time: 5904.0527s
	iters: 300, epoch: 13 | loss: 0.2416228
	speed: 0.0365s/iter; left time: 5961.2352s
	iters: 400, epoch: 13 | loss: 0.2369090
	speed: 0.0371s/iter; left time: 6051.7735s
	iters: 500, epoch: 13 | loss: 0.2944560
	speed: 0.0353s/iter; left time: 5763.2329s
Epoch: 13 cost time: 21.649215936660767
Epoch: 13, Steps: 568 | Train Loss: 0.2369426 Vali Loss: 0.2004324 Test Loss: 0.2829874
Validation loss decreased (0.201662 --> 0.200432).  Saving model ...
Updating learning rate to 1.4697597205917272e-05
	iters: 100, epoch: 14 | loss: 0.2247650
	speed: 0.1988s/iter; left time: 32386.6910s
	iters: 200, epoch: 14 | loss: 0.2407614
	speed: 0.0365s/iter; left time: 5936.8934s
	iters: 300, epoch: 14 | loss: 0.2611299
	speed: 0.0363s/iter; left time: 5907.9114s
	iters: 400, epoch: 14 | loss: 0.2631242
	speed: 0.0348s/iter; left time: 5660.7283s
	iters: 500, epoch: 14 | loss: 0.2069462
	speed: 0.0348s/iter; left time: 5661.2638s
Epoch: 14 cost time: 21.34522819519043
Epoch: 14, Steps: 568 | Train Loss: 0.2343336 Vali Loss: 0.1988638 Test Loss: 0.2764017
Validation loss decreased (0.200432 --> 0.198864).  Saving model ...
Updating learning rate to 1.6329739248359195e-05
	iters: 100, epoch: 15 | loss: 0.1983296
	speed: 0.2019s/iter; left time: 32776.6615s
	iters: 200, epoch: 15 | loss: 0.2146549
	speed: 0.0358s/iter; left time: 5815.0183s
	iters: 300, epoch: 15 | loss: 0.2761265
	speed: 0.0366s/iter; left time: 5941.6613s
	iters: 400, epoch: 15 | loss: 0.2240977
	speed: 0.0370s/iter; left time: 5988.7497s
	iters: 500, epoch: 15 | loss: 0.2387321
	speed: 0.0358s/iter; left time: 5804.3033s
Epoch: 15 cost time: 21.538147449493408
Epoch: 15, Steps: 568 | Train Loss: 0.2320550 Vali Loss: 0.2003406 Test Loss: 0.2803448
EarlyStopping counter: 1 out of 8
Updating learning rate to 1.8059656732712196e-05
	iters: 100, epoch: 16 | loss: 0.2107971
	speed: 0.1965s/iter; left time: 31793.1114s
	iters: 200, epoch: 16 | loss: 0.2217548
	speed: 0.0361s/iter; left time: 5844.1957s
	iters: 300, epoch: 16 | loss: 0.2296879
	speed: 0.0366s/iter; left time: 5905.9696s
	iters: 400, epoch: 16 | loss: 0.2156932
	speed: 0.0368s/iter; left time: 5935.7311s
	iters: 500, epoch: 16 | loss: 0.2071547
	speed: 0.0370s/iter; left time: 5972.9035s
Epoch: 16 cost time: 21.73692750930786
Epoch: 16, Steps: 568 | Train Loss: 0.2302406 Vali Loss: 0.1964482 Test Loss: 0.2779567
Validation loss decreased (0.198864 --> 0.196448).  Saving model ...
Updating learning rate to 1.9882607797186167e-05
	iters: 100, epoch: 17 | loss: 0.2328296
	speed: 0.1920s/iter; left time: 30953.4649s
	iters: 200, epoch: 17 | loss: 0.1915018
	speed: 0.0349s/iter; left time: 5622.8038s
	iters: 300, epoch: 17 | loss: 0.2664803
	speed: 0.0357s/iter; left time: 5755.5457s
	iters: 400, epoch: 17 | loss: 0.2404811
	speed: 0.0362s/iter; left time: 5826.3138s
	iters: 500, epoch: 17 | loss: 0.2362671
	speed: 0.0389s/iter; left time: 6253.9189s
Epoch: 17 cost time: 21.88494300842285
Epoch: 17, Steps: 568 | Train Loss: 0.2285976 Vali Loss: 0.1962104 Test Loss: 0.2700002
Validation loss decreased (0.196448 --> 0.196210).  Saving model ...
Updating learning rate to 2.17935955664526e-05
	iters: 100, epoch: 18 | loss: 0.2238072
	speed: 0.1902s/iter; left time: 30548.5528s
	iters: 200, epoch: 18 | loss: 0.2053162
	speed: 0.0372s/iter; left time: 5966.2607s
	iters: 300, epoch: 18 | loss: 0.2294639
	speed: 0.0362s/iter; left time: 5804.4805s
	iters: 400, epoch: 18 | loss: 0.1985164
	speed: 0.0368s/iter; left time: 5902.8683s
	iters: 500, epoch: 18 | loss: 0.1752637
	speed: 0.0357s/iter; left time: 5722.4809s
Epoch: 18 cost time: 21.63935947418213
Epoch: 18, Steps: 568 | Train Loss: 0.2265967 Vali Loss: 0.1947787 Test Loss: 0.2746499
Validation loss decreased (0.196210 --> 0.194779).  Saving model ...
Updating learning rate to 2.3787381848536156e-05
	iters: 100, epoch: 19 | loss: 0.2415958
	speed: 0.1868s/iter; left time: 29896.2929s
	iters: 200, epoch: 19 | loss: 0.2232874
	speed: 0.0367s/iter; left time: 5873.5868s
	iters: 300, epoch: 19 | loss: 0.2481444
	speed: 0.0374s/iter; left time: 5975.2206s
	iters: 400, epoch: 19 | loss: 0.2222939
	speed: 0.0359s/iter; left time: 5732.8179s
	iters: 500, epoch: 19 | loss: 0.2437171
	speed: 0.0381s/iter; left time: 6087.7241s
Epoch: 19 cost time: 21.78751850128174
Epoch: 19, Steps: 568 | Train Loss: 0.2253707 Vali Loss: 0.1948455 Test Loss: 0.2737593
EarlyStopping counter: 1 out of 8
Updating learning rate to 2.585850149317725e-05
	iters: 100, epoch: 20 | loss: 0.2027434
	speed: 0.1918s/iter; left time: 30586.6565s
	iters: 200, epoch: 20 | loss: 0.2053028
	speed: 0.0370s/iter; left time: 5905.8867s
	iters: 300, epoch: 20 | loss: 0.2456254
	speed: 0.0374s/iter; left time: 5950.8044s
	iters: 400, epoch: 20 | loss: 0.2285165
	speed: 0.0363s/iter; left time: 5786.7802s
	iters: 500, epoch: 20 | loss: 0.2418836
	speed: 0.0368s/iter; left time: 5857.1911s
Epoch: 20 cost time: 21.92130732536316
Epoch: 20, Steps: 568 | Train Loss: 0.2237314 Vali Loss: 0.1917332 Test Loss: 0.2635532
Validation loss decreased (0.194779 --> 0.191733).  Saving model ...
Updating learning rate to 2.8001277372307893e-05
	iters: 100, epoch: 21 | loss: 0.2369055
	speed: 0.1901s/iter; left time: 30219.4993s
	iters: 200, epoch: 21 | loss: 0.2207180
	speed: 0.0361s/iter; left time: 5726.6623s
	iters: 300, epoch: 21 | loss: 0.2299313
	speed: 0.0350s/iter; left time: 5548.0065s
	iters: 400, epoch: 21 | loss: 0.2254562
	speed: 0.0387s/iter; left time: 6140.5885s
	iters: 500, epoch: 21 | loss: 0.2417273
	speed: 0.0372s/iter; left time: 5893.9646s
Epoch: 21 cost time: 21.825581073760986
Epoch: 21, Steps: 568 | Train Loss: 0.2222537 Vali Loss: 0.1932442 Test Loss: 0.2613813
EarlyStopping counter: 1 out of 8
Updating learning rate to 3.020983594157816e-05
	iters: 100, epoch: 22 | loss: 0.2226223
	speed: 0.1909s/iter; left time: 30228.6234s
	iters: 200, epoch: 22 | loss: 0.2529134
	speed: 0.0374s/iter; left time: 5926.8052s
	iters: 300, epoch: 22 | loss: 0.2360386
	speed: 0.0375s/iter; left time: 5926.3376s
	iters: 400, epoch: 22 | loss: 0.1864636
	speed: 0.0374s/iter; left time: 5907.4073s
	iters: 500, epoch: 22 | loss: 0.2403101
	speed: 0.0366s/iter; left time: 5786.5948s
Epoch: 22 cost time: 22.15051770210266
Epoch: 22, Steps: 568 | Train Loss: 0.2212993 Vali Loss: 0.1939117 Test Loss: 0.2602420
EarlyStopping counter: 2 out of 8
Updating learning rate to 3.2478123340277536e-05
	iters: 100, epoch: 23 | loss: 0.2147390
	speed: 0.1900s/iter; left time: 29976.3354s
	iters: 200, epoch: 23 | loss: 0.2199773
	speed: 0.0381s/iter; left time: 6007.6005s
	iters: 300, epoch: 23 | loss: 0.2144968
	speed: 0.0375s/iter; left time: 5910.8203s
	iters: 400, epoch: 23 | loss: 0.2137021
	speed: 0.0380s/iter; left time: 5990.7916s
	iters: 500, epoch: 23 | loss: 0.2264525
	speed: 0.0395s/iter; left time: 6216.5200s
Epoch: 23 cost time: 22.701016426086426
Epoch: 23, Steps: 568 | Train Loss: 0.2201862 Vali Loss: 0.1907947 Test Loss: 0.2638153
Validation loss decreased (0.191733 --> 0.190795).  Saving model ...
Updating learning rate to 3.479992198552005e-05
	iters: 100, epoch: 24 | loss: 0.2067300
	speed: 0.1873s/iter; left time: 29444.4613s
	iters: 200, epoch: 24 | loss: 0.2511360
	speed: 0.0368s/iter; left time: 5786.2877s
	iters: 300, epoch: 24 | loss: 0.2630912
	speed: 0.0371s/iter; left time: 5825.9837s
	iters: 400, epoch: 24 | loss: 0.2215103
	speed: 0.0370s/iter; left time: 5803.3569s
	iters: 500, epoch: 24 | loss: 0.2092686
	speed: 0.0375s/iter; left time: 5875.7816s
Epoch: 24 cost time: 22.011967658996582
Epoch: 24, Steps: 568 | Train Loss: 0.2189773 Vali Loss: 0.1872838 Test Loss: 0.2640354
Validation loss decreased (0.190795 --> 0.187284).  Saving model ...
Updating learning rate to 3.716886761520655e-05
	iters: 100, epoch: 25 | loss: 0.2041292
	speed: 0.1939s/iter; left time: 30377.6632s
	iters: 200, epoch: 25 | loss: 0.2141839
	speed: 0.0355s/iter; left time: 5550.7112s
	iters: 300, epoch: 25 | loss: 0.2320821
	speed: 0.0364s/iter; left time: 5698.0637s
	iters: 400, epoch: 25 | loss: 0.2109705
	speed: 0.0366s/iter; left time: 5730.7109s
	iters: 500, epoch: 25 | loss: 0.2154320
	speed: 0.0347s/iter; left time: 5416.3854s
Epoch: 25 cost time: 21.49554753303528
Epoch: 25, Steps: 568 | Train Loss: 0.2176597 Vali Loss: 0.1893202 Test Loss: 0.2550106
EarlyStopping counter: 1 out of 8
Updating learning rate to 3.957846673304841e-05
	iters: 100, epoch: 26 | loss: 0.2221542
	speed: 0.1952s/iter; left time: 30475.4743s
	iters: 200, epoch: 26 | loss: 0.2277480
	speed: 0.0367s/iter; left time: 5726.7335s
	iters: 300, epoch: 26 | loss: 0.2015448
	speed: 0.0368s/iter; left time: 5735.8578s
	iters: 400, epoch: 26 | loss: 0.2347393
	speed: 0.0377s/iter; left time: 5877.6960s
	iters: 500, epoch: 26 | loss: 0.2118703
	speed: 0.0358s/iter; left time: 5577.2893s
Epoch: 26 cost time: 21.77579116821289
Epoch: 26, Steps: 568 | Train Loss: 0.2165818 Vali Loss: 0.1889420 Test Loss: 0.2538011
EarlyStopping counter: 2 out of 8
Updating learning rate to 4.20221144078337e-05
	iters: 100, epoch: 27 | loss: 0.1973350
	speed: 0.2000s/iter; left time: 31106.9923s
	iters: 200, epoch: 27 | loss: 0.2424488
	speed: 0.0357s/iter; left time: 5542.2049s
	iters: 300, epoch: 27 | loss: 0.2193993
	speed: 0.0359s/iter; left time: 5570.4069s
	iters: 400, epoch: 27 | loss: 0.1752900
	speed: 0.0360s/iter; left time: 5589.2876s
	iters: 500, epoch: 27 | loss: 0.2500373
	speed: 0.0351s/iter; left time: 5446.3966s
Epoch: 27 cost time: 22.1152126789093
Epoch: 27, Steps: 568 | Train Loss: 0.2156089 Vali Loss: 0.1860371 Test Loss: 0.2555851
Validation loss decreased (0.187284 --> 0.186037).  Saving model ...
Updating learning rate to 4.4493112378146836e-05
	iters: 100, epoch: 28 | loss: 0.1978591
	speed: 0.2027s/iter; left time: 31416.7232s
	iters: 200, epoch: 28 | loss: 0.2048816
	speed: 0.0374s/iter; left time: 5792.2471s
	iters: 300, epoch: 28 | loss: 0.2248687
	speed: 0.0383s/iter; left time: 5933.1209s
	iters: 400, epoch: 28 | loss: 0.2395467
	speed: 0.0377s/iter; left time: 5831.7522s
	iters: 500, epoch: 28 | loss: 0.2107232
	speed: 0.0368s/iter; left time: 5694.7451s
Epoch: 28 cost time: 22.265755653381348
Epoch: 28, Steps: 568 | Train Loss: 0.2144253 Vali Loss: 0.1928543 Test Loss: 0.2552250
EarlyStopping counter: 1 out of 8
Updating learning rate to 4.6984687412914706e-05
	iters: 100, epoch: 29 | loss: 0.2115512
	speed: 0.1906s/iter; left time: 29424.0009s
	iters: 200, epoch: 29 | loss: 0.2171631
	speed: 0.0431s/iter; left time: 6645.5956s
	iters: 300, epoch: 29 | loss: 0.2319950
	speed: 0.0365s/iter; left time: 5635.6062s
	iters: 400, epoch: 29 | loss: 0.2309017
	speed: 0.0369s/iter; left time: 5684.6018s
	iters: 500, epoch: 29 | loss: 0.2113156
	speed: 0.0362s/iter; left time: 5571.7628s
Epoch: 29 cost time: 22.3709135055542
Epoch: 29, Steps: 568 | Train Loss: 0.2136576 Vali Loss: 0.1885942 Test Loss: 0.2547768
EarlyStopping counter: 2 out of 8
Updating learning rate to 4.9490009877451554e-05
	iters: 100, epoch: 30 | loss: 0.2406674
	speed: 0.1937s/iter; left time: 29789.1172s
	iters: 200, epoch: 30 | loss: 0.2156167
	speed: 0.0318s/iter; left time: 4885.9342s
	iters: 300, epoch: 30 | loss: 0.2037785
	speed: 0.0371s/iter; left time: 5707.2634s
	iters: 400, epoch: 30 | loss: 0.1827422
	speed: 0.0370s/iter; left time: 5687.7215s
	iters: 500, epoch: 30 | loss: 0.2074933
	speed: 0.0372s/iter; left time: 5700.2435s
Epoch: 30 cost time: 21.33514714241028
Epoch: 30, Steps: 568 | Train Loss: 0.2123735 Vali Loss: 0.1866783 Test Loss: 0.2556091
EarlyStopping counter: 3 out of 8
Updating learning rate to 5.200221245411131e-05
	iters: 100, epoch: 31 | loss: 0.2156505
	speed: 0.1885s/iter; left time: 28891.1125s
	iters: 200, epoch: 31 | loss: 0.2207250
	speed: 0.0369s/iter; left time: 5644.9548s
	iters: 300, epoch: 31 | loss: 0.1944396
	speed: 0.0376s/iter; left time: 5757.0510s
	iters: 400, epoch: 31 | loss: 0.1955809
	speed: 0.0382s/iter; left time: 5840.5781s
	iters: 500, epoch: 31 | loss: 0.2216479
	speed: 0.0363s/iter; left time: 5549.6246s
Epoch: 31 cost time: 22.15957498550415
Epoch: 31, Steps: 568 | Train Loss: 0.2109947 Vali Loss: 0.1891447 Test Loss: 0.2553584
EarlyStopping counter: 4 out of 8
Updating learning rate to 5.451440896623232e-05
	iters: 100, epoch: 32 | loss: 0.2370422
	speed: 0.1935s/iter; left time: 29547.8675s
	iters: 200, epoch: 32 | loss: 0.2113452
	speed: 0.0377s/iter; left time: 5751.7567s
	iters: 300, epoch: 32 | loss: 0.1976191
	speed: 0.0377s/iter; left time: 5744.7061s
	iters: 400, epoch: 32 | loss: 0.2023916
	speed: 0.0378s/iter; left time: 5759.2865s
	iters: 500, epoch: 32 | loss: 0.1847655
	speed: 0.0386s/iter; left time: 5875.7167s
Epoch: 32 cost time: 22.39560842514038
Epoch: 32, Steps: 568 | Train Loss: 0.2102041 Vali Loss: 0.1885537 Test Loss: 0.2499295
EarlyStopping counter: 5 out of 8
Updating learning rate to 5.7019713253776385e-05
	iters: 100, epoch: 33 | loss: 0.2077422
	speed: 0.1866s/iter; left time: 28393.9099s
	iters: 200, epoch: 33 | loss: 0.1998368
	speed: 0.0383s/iter; left time: 5815.4949s
	iters: 300, epoch: 33 | loss: 0.2062386
	speed: 0.0360s/iter; left time: 5462.4076s
	iters: 400, epoch: 33 | loss: 0.2086702
	speed: 0.0376s/iter; left time: 5709.8337s
	iters: 500, epoch: 33 | loss: 0.2298637
	speed: 0.0374s/iter; left time: 5679.4553s
Epoch: 33 cost time: 22.161097288131714
Epoch: 33, Steps: 568 | Train Loss: 0.2092102 Vali Loss: 0.1879474 Test Loss: 0.2464542
EarlyStopping counter: 6 out of 8
Updating learning rate to 5.951125804892222e-05
	iters: 100, epoch: 34 | loss: 0.2259997
	speed: 0.1989s/iter; left time: 30151.8951s
	iters: 200, epoch: 34 | loss: 0.1900851
	speed: 0.0363s/iter; left time: 5495.0868s
	iters: 300, epoch: 34 | loss: 0.2502631
	speed: 0.0371s/iter; left time: 5616.2390s
	iters: 400, epoch: 34 | loss: 0.2138608
	speed: 0.0374s/iter; left time: 5657.1788s
	iters: 500, epoch: 34 | loss: 0.2463832
	speed: 0.0376s/iter; left time: 5685.6096s
Epoch: 34 cost time: 22.09152054786682
Epoch: 34, Steps: 568 | Train Loss: 0.2080703 Vali Loss: 0.1839036 Test Loss: 0.2519029
Validation loss decreased (0.186037 --> 0.183904).  Saving model ...
Updating learning rate to 6.198221379987366e-05
	iters: 100, epoch: 35 | loss: 0.2130577
	speed: 0.2009s/iter; left time: 30339.2564s
	iters: 200, epoch: 35 | loss: 0.1948333
	speed: 0.0376s/iter; left time: 5673.7250s
	iters: 300, epoch: 35 | loss: 0.1951961
	speed: 0.0384s/iter; left time: 5783.7012s
	iters: 400, epoch: 35 | loss: 0.2434705
	speed: 0.0375s/iter; left time: 5652.9737s
	iters: 500, epoch: 35 | loss: 0.1759391
	speed: 0.0372s/iter; left time: 5604.3182s
Epoch: 35 cost time: 22.420708417892456
Epoch: 35, Steps: 568 | Train Loss: 0.2074271 Vali Loss: 0.1861799 Test Loss: 0.2497804
EarlyStopping counter: 1 out of 8
Updating learning rate to 6.44258073912847e-05
	iters: 100, epoch: 36 | loss: 0.1896102
	speed: 0.2019s/iter; left time: 30373.1039s
	iters: 200, epoch: 36 | loss: 0.2559690
	speed: 0.0363s/iter; left time: 5459.1003s
	iters: 300, epoch: 36 | loss: 0.2062785
	speed: 0.0366s/iter; left time: 5493.8711s
	iters: 400, epoch: 36 | loss: 0.2015853
	speed: 0.0388s/iter; left time: 5827.8965s
	iters: 500, epoch: 36 | loss: 0.2081930
	speed: 0.0368s/iter; left time: 5515.5261s
Epoch: 36 cost time: 22.177362203598022
Epoch: 36, Steps: 568 | Train Loss: 0.2058718 Vali Loss: 0.1866791 Test Loss: 0.2440543
EarlyStopping counter: 2 out of 8
Updating learning rate to 6.683534070998721e-05
	iters: 100, epoch: 37 | loss: 0.1848479
	speed: 0.1920s/iter; left time: 28776.8562s
	iters: 200, epoch: 37 | loss: 0.1818033
	speed: 0.0376s/iter; left time: 5624.7991s
	iters: 300, epoch: 37 | loss: 0.2492043
	speed: 0.0431s/iter; left time: 6452.3006s
	iters: 400, epoch: 37 | loss: 0.1888068
	speed: 0.0375s/iter; left time: 5603.1979s
	iters: 500, epoch: 37 | loss: 0.1851179
	speed: 0.0376s/iter; left time: 5617.2913s
Epoch: 37 cost time: 22.825367212295532
Epoch: 37, Steps: 568 | Train Loss: 0.2048405 Vali Loss: 0.1878987 Test Loss: 0.2465747
EarlyStopping counter: 3 out of 8
Updating learning rate to 6.920420900513073e-05
	iters: 100, epoch: 38 | loss: 0.2146016
	speed: 0.1962s/iter; left time: 29287.7696s
	iters: 200, epoch: 38 | loss: 0.2129138
	speed: 0.0387s/iter; left time: 5779.1289s
	iters: 300, epoch: 38 | loss: 0.2088174
	speed: 0.0385s/iter; left time: 5738.3054s
	iters: 400, epoch: 38 | loss: 0.2120538
	speed: 0.0378s/iter; left time: 5625.7614s
	iters: 500, epoch: 38 | loss: 0.2194767
	speed: 0.0360s/iter; left time: 5363.5395s
Epoch: 38 cost time: 22.470354080200195
Epoch: 38, Steps: 568 | Train Loss: 0.2039916 Vali Loss: 0.1837536 Test Loss: 0.2441844
Validation loss decreased (0.183904 --> 0.183754).  Saving model ...
Updating learning rate to 7.152591899240768e-05
	iters: 100, epoch: 39 | loss: 0.1996915
	speed: 0.1917s/iter; left time: 28508.3012s
	iters: 200, epoch: 39 | loss: 0.1989013
	speed: 0.0345s/iter; left time: 5129.7903s
	iters: 300, epoch: 39 | loss: 0.1729643
	speed: 0.0354s/iter; left time: 5258.0987s
	iters: 400, epoch: 39 | loss: 0.2171250
	speed: 0.0377s/iter; left time: 5602.4029s
	iters: 500, epoch: 39 | loss: 0.2363504
	speed: 0.0374s/iter; left time: 5548.7037s
Epoch: 39 cost time: 21.671844482421875
Epoch: 39, Steps: 568 | Train Loss: 0.2031844 Vali Loss: 0.1899437 Test Loss: 0.2449774
EarlyStopping counter: 1 out of 8
Updating learning rate to 7.37941066527385e-05
	iters: 100, epoch: 40 | loss: 0.1973753
	speed: 0.1914s/iter; left time: 28361.6266s
	iters: 200, epoch: 40 | loss: 0.2026277
	speed: 0.0356s/iter; left time: 5274.9428s
	iters: 300, epoch: 40 | loss: 0.1748902
	speed: 0.0369s/iter; left time: 5454.3513s
	iters: 400, epoch: 40 | loss: 0.2133476
	speed: 0.0358s/iter; left time: 5293.5665s
	iters: 500, epoch: 40 | loss: 0.1941231
	speed: 0.0375s/iter; left time: 5536.0162s
Epoch: 40 cost time: 21.675291061401367
Epoch: 40, Steps: 568 | Train Loss: 0.2018406 Vali Loss: 0.1837562 Test Loss: 0.2501791
EarlyStopping counter: 2 out of 8
Updating learning rate to 7.600255467662914e-05
	iters: 100, epoch: 41 | loss: 0.2472829
	speed: 0.1877s/iter; left time: 27701.8017s
	iters: 200, epoch: 41 | loss: 0.2149004
	speed: 0.0382s/iter; left time: 5634.3297s
	iters: 300, epoch: 41 | loss: 0.1947989
	speed: 0.0372s/iter; left time: 5489.6122s
	iters: 400, epoch: 41 | loss: 0.1787725
	speed: 0.0386s/iter; left time: 5679.6128s
	iters: 500, epoch: 41 | loss: 0.2313251
	speed: 0.0384s/iter; left time: 5654.5484s
Epoch: 41 cost time: 22.578702211380005
Epoch: 41, Steps: 568 | Train Loss: 0.2013115 Vali Loss: 0.1884826 Test Loss: 0.2491112
EarlyStopping counter: 3 out of 8
Updating learning rate to 7.814520950638412e-05
	iters: 100, epoch: 42 | loss: 0.2119808
	speed: 0.1907s/iter; left time: 28040.1315s
	iters: 200, epoch: 42 | loss: 0.2122593
	speed: 0.0377s/iter; left time: 5535.4501s
	iters: 300, epoch: 42 | loss: 0.1873117
	speed: 0.0371s/iter; left time: 5443.7745s
	iters: 400, epoch: 42 | loss: 0.2231368
	speed: 0.0377s/iter; left time: 5529.8327s
	iters: 500, epoch: 42 | loss: 0.1917959
	speed: 0.0370s/iter; left time: 5418.5342s
Epoch: 42 cost time: 22.166011810302734
Epoch: 42, Steps: 568 | Train Loss: 0.2000060 Vali Loss: 0.1876749 Test Loss: 0.2513207
EarlyStopping counter: 4 out of 8
Updating learning rate to 8.021619792946089e-05
	iters: 100, epoch: 43 | loss: 0.2214602
	speed: 0.1919s/iter; left time: 28104.7278s
	iters: 200, epoch: 43 | loss: 0.1811859
	speed: 0.0363s/iter; left time: 5305.8709s
	iters: 300, epoch: 43 | loss: 0.1811904
	speed: 0.0364s/iter; left time: 5319.0891s
	iters: 400, epoch: 43 | loss: 0.2065288
	speed: 0.0366s/iter; left time: 5342.6921s
	iters: 500, epoch: 43 | loss: 0.1930922
	speed: 0.0370s/iter; left time: 5400.0828s
Epoch: 43 cost time: 21.746437788009644
Epoch: 43, Steps: 568 | Train Loss: 0.1985086 Vali Loss: 0.1910084 Test Loss: 0.2472881
EarlyStopping counter: 5 out of 8
Updating learning rate to 8.220984317748175e-05
	iters: 100, epoch: 44 | loss: 0.2223326
	speed: 0.1896s/iter; left time: 27658.6573s
	iters: 200, epoch: 44 | loss: 0.1877447
	speed: 0.0301s/iter; left time: 4390.8642s
	iters: 300, epoch: 44 | loss: 0.2197284
	speed: 0.0266s/iter; left time: 3878.6906s
	iters: 400, epoch: 44 | loss: 0.1955998
	speed: 0.0281s/iter; left time: 4097.4814s
	iters: 500, epoch: 44 | loss: 0.2080210
	speed: 0.0276s/iter; left time: 4016.6420s
Epoch: 44 cost time: 17.772814750671387
Epoch: 44, Steps: 568 | Train Loss: 0.1976289 Vali Loss: 0.1894166 Test Loss: 0.2491935
EarlyStopping counter: 6 out of 8
Updating learning rate to 8.412068048677431e-05
	iters: 100, epoch: 45 | loss: 0.1770125
	speed: 0.1988s/iter; left time: 28891.9768s
	iters: 200, epoch: 45 | loss: 0.1895029
	speed: 0.0385s/iter; left time: 5594.3982s
	iters: 300, epoch: 45 | loss: 0.1873506
	speed: 0.0396s/iter; left time: 5745.5283s
	iters: 400, epoch: 45 | loss: 0.2216889
	speed: 0.0395s/iter; left time: 5731.6247s
	iters: 500, epoch: 45 | loss: 0.1872200
	speed: 0.0392s/iter; left time: 5675.5712s
Epoch: 45 cost time: 23.07930636405945
Epoch: 45, Steps: 568 | Train Loss: 0.1965855 Vali Loss: 0.1905791 Test Loss: 0.2453306
EarlyStopping counter: 7 out of 8
Updating learning rate to 8.594347207778784e-05
	iters: 100, epoch: 46 | loss: 0.1961245
	speed: 0.1935s/iter; left time: 28012.9348s
	iters: 200, epoch: 46 | loss: 0.2071719
	speed: 0.0398s/iter; left time: 5756.2683s
	iters: 300, epoch: 46 | loss: 0.2069575
	speed: 0.0363s/iter; left time: 5243.4471s
	iters: 400, epoch: 46 | loss: 0.1883650
	speed: 0.0382s/iter; left time: 5518.7267s
	iters: 500, epoch: 46 | loss: 0.1979032
	speed: 0.0383s/iter; left time: 5525.3240s
Epoch: 46 cost time: 22.616689920425415
Epoch: 46, Steps: 568 | Train Loss: 0.1955183 Vali Loss: 0.1889193 Test Loss: 0.2473868
EarlyStopping counter: 8 out of 8
Early stopping
>>>>>>>testing : 96_336_SPM_TST_Solar_ftM_sl96_ll18_pl336_dm256_nh1_el1_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10177
mse:0.24418418109416962, mae:0.276126503944397, rse:0.5726352334022522
