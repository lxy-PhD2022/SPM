Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=436, c_out=7, checkpoints='./checkpoints/', d_ff=127, d_layers=1, d_model=454, data='ETTh1', data_path='ETTh1.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', dishts=1, distil=True, do_predict=False, dropout=0.3, e_layers=1, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.3, features='M', freq='h', gpu=0, head_dropout=0.0, hidden_size=[19, 17], hidden_size1=3, hidden_size2=3, individual=0, is_training=1, itr=1, k=1.0, kernel_size=25, label_len=18, learning_rate=0.00961, loss='mse', lradj='type3', model='SPM_TST', model_id='96_720', moving_avg=25, n_heads=1, num_layers=3, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=8, pct_start=0.3, pred_len=720, random_seed=2021, revin=1, root_path='./dataset/', seq_len=96, stride=8, subtract_last=0, target='OT', test_flop=False, traffic=0, train_epochs=300, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : 96_720_SPM_TST_ETTh1_ftM_sl96_ll18_pl720_dm454_nh1_el1_dl1_df127_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7825
val 2161
test 2161
Epoch: 1 cost time: 1.1955721378326416
Epoch: 1, Steps: 17 | Train Loss: 0.6504751 Vali Loss: 1.5914661 Test Loss: 0.4549850
Validation loss decreased (inf --> 1.591466).  Saving model ...
Updating learning rate to 0.00961
Epoch: 2 cost time: 0.8943231105804443
Epoch: 2, Steps: 17 | Train Loss: 0.6912081 Vali Loss: 1.8820066 Test Loss: 0.7181962
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.00961
Epoch: 3 cost time: 0.9045224189758301
Epoch: 3, Steps: 17 | Train Loss: 0.6257580 Vali Loss: 1.7103906 Test Loss: 0.6416914
EarlyStopping counter: 2 out of 8
Updating learning rate to 0.00961
Epoch: 4 cost time: 0.9226765632629395
Epoch: 4, Steps: 17 | Train Loss: 0.6022137 Vali Loss: 1.7168779 Test Loss: 0.6541114
EarlyStopping counter: 3 out of 8
Updating learning rate to 0.008649
Epoch: 5 cost time: 0.9186248779296875
Epoch: 5, Steps: 17 | Train Loss: 0.5852169 Vali Loss: 1.6657760 Test Loss: 0.5388292
EarlyStopping counter: 4 out of 8
Updating learning rate to 0.007784100000000001
Epoch: 6 cost time: 0.9150521755218506
Epoch: 6, Steps: 17 | Train Loss: 0.5690353 Vali Loss: 1.6549203 Test Loss: 0.5031870
EarlyStopping counter: 5 out of 8
Updating learning rate to 0.007005690000000001
Epoch: 7 cost time: 0.8922317028045654
Epoch: 7, Steps: 17 | Train Loss: 0.5545676 Vali Loss: 1.6792228 Test Loss: 0.5309407
EarlyStopping counter: 6 out of 8
Updating learning rate to 0.006305121
Epoch: 8 cost time: 0.8602025508880615
Epoch: 8, Steps: 17 | Train Loss: 0.5457759 Vali Loss: 1.6886967 Test Loss: 0.4989251
EarlyStopping counter: 7 out of 8
Updating learning rate to 0.005674608900000001
Epoch: 9 cost time: 0.9204585552215576
Epoch: 9, Steps: 17 | Train Loss: 0.5272152 Vali Loss: 1.7098565 Test Loss: 0.4959480
EarlyStopping counter: 8 out of 8
Early stopping
>>>>>>>testing : 96_720_SPM_TST_ETTh1_ftM_sl96_ll18_pl720_dm454_nh1_el1_dl1_df127_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.4549848735332489, mae:0.46620771288871765, rse:0.6555987000465393
