Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=97, c_out=7, checkpoints='./checkpoints/', d_ff=176, d_layers=1, d_model=216, data='ETTm2', data_path='ETTm2.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', dishts=1, distil=True, do_predict=False, dropout=0.3, e_layers=1, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.3, features='M', freq='h', gpu=0, head_dropout=0.0, hidden_size=[20, 16], hidden_size1=3, hidden_size2=3, individual=0, is_training=1, itr=1, k=1.0, kernel_size=25, label_len=18, learning_rate=0.00463, loss='mse', lradj='type3', model='SPM_TST', model_id='96_192', moving_avg=25, n_heads=1, num_layers=3, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.3, pred_len=192, random_seed=2021, revin=1, root_path='./dataset/', seq_len=96, stride=8, subtract_last=0, target='OT', test_flop=False, topk=49, traffic=0, train_epochs=300, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : 96_192_SPM_TST_ETTm2_ftM_sl96_ll18_pl192_dm216_nh1_el1_dl1_df176_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34273
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.2526023
	speed: 0.0661s/iter; left time: 6991.6911s
	iters: 200, epoch: 1 | loss: 0.4337887
	speed: 0.0481s/iter; left time: 5083.2445s
	iters: 300, epoch: 1 | loss: 0.3286738
	speed: 0.0298s/iter; left time: 3141.9449s
Epoch: 1 cost time: 14.316166877746582
Epoch: 1, Steps: 353 | Train Loss: 0.3225143 Vali Loss: 0.1687555 Test Loss: 0.2372498
Validation loss decreased (inf --> 0.168755).  Saving model ...
Updating learning rate to 0.00463
	iters: 100, epoch: 2 | loss: 0.2301082
	speed: 0.1760s/iter; left time: 18559.4369s
	iters: 200, epoch: 2 | loss: 0.3624499
	speed: 0.0348s/iter; left time: 3661.7730s
	iters: 300, epoch: 2 | loss: 0.2560343
	speed: 0.0363s/iter; left time: 3824.6040s
Epoch: 2 cost time: 10.645773887634277
Epoch: 2, Steps: 353 | Train Loss: 0.3487961 Vali Loss: 0.1889486 Test Loss: 0.2625818
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00463
	iters: 100, epoch: 3 | loss: 0.3746225
	speed: 0.1973s/iter; left time: 20735.6078s
	iters: 200, epoch: 3 | loss: 0.3994657
	speed: 0.0366s/iter; left time: 3838.4714s
	iters: 300, epoch: 3 | loss: 0.4205309
	speed: 0.0336s/iter; left time: 3523.2765s
Epoch: 3 cost time: 14.982927083969116
Epoch: 3, Steps: 353 | Train Loss: 0.3354387 Vali Loss: 0.1812016 Test Loss: 0.2565526
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00463
	iters: 100, epoch: 4 | loss: 0.3423719
	speed: 0.1742s/iter; left time: 18241.8858s
	iters: 200, epoch: 4 | loss: 0.4716511
	speed: 0.0165s/iter; left time: 1722.7108s
	iters: 300, epoch: 4 | loss: 0.4286801
	speed: 0.0338s/iter; left time: 3531.5863s
Epoch: 4 cost time: 11.867541074752808
Epoch: 4, Steps: 353 | Train Loss: 0.3310833 Vali Loss: 0.1830152 Test Loss: 0.2560036
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.004167
	iters: 100, epoch: 5 | loss: 0.2319703
	speed: 0.1957s/iter; left time: 20433.5796s
	iters: 200, epoch: 5 | loss: 0.3743601
	speed: 0.0464s/iter; left time: 4835.5854s
	iters: 300, epoch: 5 | loss: 0.4304640
	speed: 0.0243s/iter; left time: 2536.0728s
Epoch: 5 cost time: 14.264568328857422
Epoch: 5, Steps: 353 | Train Loss: 0.3226920 Vali Loss: 0.1840518 Test Loss: 0.2561791
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0037503
	iters: 100, epoch: 6 | loss: 0.2659450
	speed: 0.1525s/iter; left time: 15863.1604s
	iters: 200, epoch: 6 | loss: 0.2371372
	speed: 0.0418s/iter; left time: 4344.0610s
	iters: 300, epoch: 6 | loss: 0.2478493
	speed: 0.0367s/iter; left time: 3806.6955s
Epoch: 6 cost time: 13.509262323379517
Epoch: 6, Steps: 353 | Train Loss: 0.3174078 Vali Loss: 0.1843081 Test Loss: 0.2580917
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00337527
	iters: 100, epoch: 7 | loss: 0.4040174
	speed: 0.1645s/iter; left time: 17052.4847s
	iters: 200, epoch: 7 | loss: 0.3427255
	speed: 0.0524s/iter; left time: 5423.2054s
	iters: 300, epoch: 7 | loss: 0.2831913
	speed: 0.0553s/iter; left time: 5725.3085s
Epoch: 7 cost time: 16.152873039245605
Epoch: 7, Steps: 353 | Train Loss: 0.3110216 Vali Loss: 0.1845359 Test Loss: 0.2607381
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.003037743
	iters: 100, epoch: 8 | loss: 0.3302057
	speed: 0.1318s/iter; left time: 13614.0719s
	iters: 200, epoch: 8 | loss: 0.3214501
	speed: 0.0311s/iter; left time: 3212.9960s
	iters: 300, epoch: 8 | loss: 0.4231944
	speed: 0.0466s/iter; left time: 4804.3727s
Epoch: 8 cost time: 13.787230491638184
Epoch: 8, Steps: 353 | Train Loss: 0.3014208 Vali Loss: 0.1869792 Test Loss: 0.2620388
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.0027339687
	iters: 100, epoch: 9 | loss: 0.3003388
	speed: 0.1466s/iter; left time: 15099.0263s
	iters: 200, epoch: 9 | loss: 0.2845334
	speed: 0.0348s/iter; left time: 3583.9656s
	iters: 300, epoch: 9 | loss: 0.2049626
	speed: 0.0544s/iter; left time: 5588.4849s
Epoch: 9 cost time: 17.147995710372925
Epoch: 9, Steps: 353 | Train Loss: 0.2937634 Vali Loss: 0.1871489 Test Loss: 0.2605698
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00246057183
	iters: 100, epoch: 10 | loss: 0.2303151
	speed: 0.1585s/iter; left time: 16264.6081s
	iters: 200, epoch: 10 | loss: 0.3175388
	speed: 0.0366s/iter; left time: 3751.0644s
	iters: 300, epoch: 10 | loss: 0.2683225
	speed: 0.0357s/iter; left time: 3660.6380s
Epoch: 10 cost time: 10.489990949630737
Epoch: 10, Steps: 353 | Train Loss: 0.2896762 Vali Loss: 0.1869143 Test Loss: 0.2612197
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.0022145146470000003
	iters: 100, epoch: 11 | loss: 0.2379897
	speed: 0.1801s/iter; left time: 18414.7432s
	iters: 200, epoch: 11 | loss: 0.3334633
	speed: 0.0424s/iter; left time: 4327.5161s
	iters: 300, epoch: 11 | loss: 0.2574093
	speed: 0.0364s/iter; left time: 3716.0058s
Epoch: 11 cost time: 13.373245477676392
Epoch: 11, Steps: 353 | Train Loss: 0.2790175 Vali Loss: 0.1950187 Test Loss: 0.2661932
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.0019930631823000004
	iters: 100, epoch: 12 | loss: 0.3050391
	speed: 0.1947s/iter; left time: 19845.7136s
	iters: 200, epoch: 12 | loss: 0.2462482
	speed: 0.0232s/iter; left time: 2365.4370s
	iters: 300, epoch: 12 | loss: 0.1907689
	speed: 0.0295s/iter; left time: 3004.9762s
Epoch: 12 cost time: 11.395010471343994
Epoch: 12, Steps: 353 | Train Loss: 0.2701353 Vali Loss: 0.1897057 Test Loss: 0.2627000
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.0017937568640700003
	iters: 100, epoch: 13 | loss: 0.2901900
	speed: 0.1579s/iter; left time: 16034.4053s
	iters: 200, epoch: 13 | loss: 0.2754957
	speed: 0.0370s/iter; left time: 3756.9795s
	iters: 300, epoch: 13 | loss: 0.2260653
	speed: 0.0339s/iter; left time: 3433.3839s
Epoch: 13 cost time: 12.644648313522339
Epoch: 13, Steps: 353 | Train Loss: 0.2663743 Vali Loss: 0.1981859 Test Loss: 0.2665365
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.0016143811776630002
	iters: 100, epoch: 14 | loss: 0.2876854
	speed: 0.2135s/iter; left time: 21612.9672s
	iters: 200, epoch: 14 | loss: 0.2050868
	speed: 0.0339s/iter; left time: 3431.1230s
	iters: 300, epoch: 14 | loss: 0.1809521
	speed: 0.0343s/iter; left time: 3460.4087s
Epoch: 14 cost time: 12.312639236450195
Epoch: 14, Steps: 353 | Train Loss: 0.2610691 Vali Loss: 0.1907852 Test Loss: 0.2590738
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.0014529430598967002
	iters: 100, epoch: 15 | loss: 0.3749242
	speed: 0.1278s/iter; left time: 12894.7929s
	iters: 200, epoch: 15 | loss: 0.1945925
	speed: 0.0400s/iter; left time: 4032.4183s
	iters: 300, epoch: 15 | loss: 0.2073211
	speed: 0.0394s/iter; left time: 3963.9634s
Epoch: 15 cost time: 13.606945037841797
Epoch: 15, Steps: 353 | Train Loss: 0.2546348 Vali Loss: 0.1898201 Test Loss: 0.2638498
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.0013076487539070304
	iters: 100, epoch: 16 | loss: 0.2889662
	speed: 0.2038s/iter; left time: 20485.0282s
	iters: 200, epoch: 16 | loss: 0.2710242
	speed: 0.0302s/iter; left time: 3033.5622s
	iters: 300, epoch: 16 | loss: 0.2015192
	speed: 0.0335s/iter; left time: 3360.7232s
Epoch: 16 cost time: 12.341515064239502
Epoch: 16, Steps: 353 | Train Loss: 0.2478869 Vali Loss: 0.2028308 Test Loss: 0.2707604
EarlyStopping counter: 15 out of 20
Updating learning rate to 0.0011768838785163273
	iters: 100, epoch: 17 | loss: 0.2291521
	speed: 0.1354s/iter; left time: 13562.1138s
	iters: 200, epoch: 17 | loss: 0.1948195
	speed: 0.0407s/iter; left time: 4069.7730s
	iters: 300, epoch: 17 | loss: 0.2514209
	speed: 0.0199s/iter; left time: 1989.2380s
Epoch: 17 cost time: 11.126266717910767
Epoch: 17, Steps: 353 | Train Loss: 0.2448691 Vali Loss: 0.2059589 Test Loss: 0.2692644
EarlyStopping counter: 16 out of 20
Updating learning rate to 0.0010591954906646946
	iters: 100, epoch: 18 | loss: 0.2147367
	speed: 0.2108s/iter; left time: 21033.4758s
	iters: 200, epoch: 18 | loss: 0.2018986
	speed: 0.0404s/iter; left time: 4025.6213s
	iters: 300, epoch: 18 | loss: 0.3096952
	speed: 0.0291s/iter; left time: 2898.1079s
Epoch: 18 cost time: 13.64402985572815
Epoch: 18, Steps: 353 | Train Loss: 0.2421420 Vali Loss: 0.1957368 Test Loss: 0.2691841
EarlyStopping counter: 17 out of 20
Updating learning rate to 0.0009532759415982251
	iters: 100, epoch: 19 | loss: 0.1827080
	speed: 0.1658s/iter; left time: 16489.6149s
	iters: 200, epoch: 19 | loss: 0.2152845
	speed: 0.0286s/iter; left time: 2840.8805s
	iters: 300, epoch: 19 | loss: 0.3125173
	speed: 0.0217s/iter; left time: 2157.1890s
Epoch: 19 cost time: 10.595065593719482
Epoch: 19, Steps: 353 | Train Loss: 0.2377840 Vali Loss: 0.1926898 Test Loss: 0.2681532
EarlyStopping counter: 18 out of 20
Updating learning rate to 0.0008579483474384026
	iters: 100, epoch: 20 | loss: 0.1514808
	speed: 0.1790s/iter; left time: 17738.6428s
	iters: 200, epoch: 20 | loss: 0.2659258
	speed: 0.0575s/iter; left time: 5694.9129s
	iters: 300, epoch: 20 | loss: 0.2981634
	speed: 0.0357s/iter; left time: 3526.9029s
Epoch: 20 cost time: 16.063816785812378
Epoch: 20, Steps: 353 | Train Loss: 0.2343919 Vali Loss: 0.1954321 Test Loss: 0.2685574
EarlyStopping counter: 19 out of 20
Updating learning rate to 0.0007721535126945624
	iters: 100, epoch: 21 | loss: 0.1696802
	speed: 0.1608s/iter; left time: 15879.5552s
	iters: 200, epoch: 21 | loss: 0.1947995
	speed: 0.0332s/iter; left time: 3271.6907s
	iters: 300, epoch: 21 | loss: 0.2142020
	speed: 0.0343s/iter; left time: 3381.7788s
Epoch: 21 cost time: 12.660798788070679
Epoch: 21, Steps: 353 | Train Loss: 0.2310102 Vali Loss: 0.2068124 Test Loss: 0.2724813
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : 96_192_SPM_TST_ETTm2_ftM_sl96_ll18_pl192_dm216_nh1_el1_dl1_df176_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.23725007474422455, mae:0.2965298295021057, rse:0.393538236618042
