Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=482, c_out=7, checkpoints='./checkpoints/', d_ff=443, d_layers=1, d_model=102, data='ETTm1', data_path='ETTm1.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', dishts=1, distil=True, do_predict=False, dropout=0.3, e_layers=1, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.3, features='M', freq='h', gpu=0, head_dropout=0.0, hidden_size=[20, 20], hidden_size1=3, hidden_size2=3, individual=0, is_training=1, itr=1, k=1.0, kernel_size=25, label_len=18, learning_rate=0.000197, loss='mse', lradj='type3', model='SPM_TST', model_id='96_96', moving_avg=25, n_heads=1, num_layers=3, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.3, pred_len=96, random_seed=2021, revin=1, root_path='./dataset/', seq_len=96, stride=8, subtract_last=0, target='OT', test_flop=False, topk=49, traffic=0, train_epochs=300, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : 96_96_SPM_TST_ETTm1_ftM_sl96_ll18_pl96_dm102_nh1_el1_dl1_df443_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
val 11425
test 11425
Epoch: 1 cost time: 2.245198965072632
Epoch: 1, Steps: 71 | Train Loss: 0.4441136 Vali Loss: 0.5694078 Test Loss: 0.4984346
Validation loss decreased (inf --> 0.569408).  Saving model ...
Updating learning rate to 0.000197
Epoch: 2 cost time: 1.9445254802703857
Epoch: 2, Steps: 71 | Train Loss: 0.3375447 Vali Loss: 0.3990259 Test Loss: 0.3291202
Validation loss decreased (0.569408 --> 0.399026).  Saving model ...
Updating learning rate to 0.000197
Epoch: 3 cost time: 1.9712305068969727
Epoch: 3, Steps: 71 | Train Loss: 0.2908257 Vali Loss: 0.3903990 Test Loss: 0.3167262
Validation loss decreased (0.399026 --> 0.390399).  Saving model ...
Updating learning rate to 0.000197
Epoch: 4 cost time: 1.9316344261169434
Epoch: 4, Steps: 71 | Train Loss: 0.2746570 Vali Loss: 0.3918726 Test Loss: 0.3114151
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001773
Epoch: 5 cost time: 1.563462495803833
Epoch: 5, Steps: 71 | Train Loss: 0.2650539 Vali Loss: 0.3887544 Test Loss: 0.3129059
Validation loss decreased (0.390399 --> 0.388754).  Saving model ...
Updating learning rate to 0.00015957
Epoch: 6 cost time: 1.8556640148162842
Epoch: 6, Steps: 71 | Train Loss: 0.2590503 Vali Loss: 0.3912175 Test Loss: 0.3125827
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.000143613
Epoch: 7 cost time: 1.590001106262207
Epoch: 7, Steps: 71 | Train Loss: 0.2540846 Vali Loss: 0.3890024 Test Loss: 0.3071134
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001292517
Epoch: 8 cost time: 1.6178131103515625
Epoch: 8, Steps: 71 | Train Loss: 0.2498785 Vali Loss: 0.3919110 Test Loss: 0.3105206
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00011632653000000001
Epoch: 9 cost time: 1.4639830589294434
Epoch: 9, Steps: 71 | Train Loss: 0.2466610 Vali Loss: 0.3921787 Test Loss: 0.3095190
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.000104693877
Epoch: 10 cost time: 1.9001550674438477
Epoch: 10, Steps: 71 | Train Loss: 0.2435216 Vali Loss: 0.3908410 Test Loss: 0.3096306
EarlyStopping counter: 5 out of 20
Updating learning rate to 9.422448930000001e-05
Epoch: 11 cost time: 2.0718448162078857
Epoch: 11, Steps: 71 | Train Loss: 0.2408732 Vali Loss: 0.3971179 Test Loss: 0.3105006
EarlyStopping counter: 6 out of 20
Updating learning rate to 8.480204037000002e-05
Epoch: 12 cost time: 1.7494010925292969
Epoch: 12, Steps: 71 | Train Loss: 0.2384728 Vali Loss: 0.3914319 Test Loss: 0.3101690
EarlyStopping counter: 7 out of 20
Updating learning rate to 7.632183633300001e-05
Epoch: 13 cost time: 1.713747501373291
Epoch: 13, Steps: 71 | Train Loss: 0.2365383 Vali Loss: 0.3925801 Test Loss: 0.3099580
EarlyStopping counter: 8 out of 20
Updating learning rate to 6.868965269970001e-05
Epoch: 14 cost time: 1.372528076171875
Epoch: 14, Steps: 71 | Train Loss: 0.2341414 Vali Loss: 0.3934253 Test Loss: 0.3122540
EarlyStopping counter: 9 out of 20
Updating learning rate to 6.182068742973e-05
Epoch: 15 cost time: 1.9364094734191895
Epoch: 15, Steps: 71 | Train Loss: 0.2322757 Vali Loss: 0.3931682 Test Loss: 0.3116886
EarlyStopping counter: 10 out of 20
Updating learning rate to 5.5638618686757016e-05
Epoch: 16 cost time: 1.9764213562011719
Epoch: 16, Steps: 71 | Train Loss: 0.2309672 Vali Loss: 0.3932922 Test Loss: 0.3111373
EarlyStopping counter: 11 out of 20
Updating learning rate to 5.007475681808131e-05
Epoch: 17 cost time: 1.6354405879974365
Epoch: 17, Steps: 71 | Train Loss: 0.2294966 Vali Loss: 0.3955668 Test Loss: 0.3114223
EarlyStopping counter: 12 out of 20
Updating learning rate to 4.5067281136273184e-05
Epoch: 18 cost time: 1.7745649814605713
Epoch: 18, Steps: 71 | Train Loss: 0.2280407 Vali Loss: 0.3953707 Test Loss: 0.3122869
EarlyStopping counter: 13 out of 20
Updating learning rate to 4.0560553022645864e-05
Epoch: 19 cost time: 1.4309287071228027
Epoch: 19, Steps: 71 | Train Loss: 0.2269611 Vali Loss: 0.3942950 Test Loss: 0.3107366
EarlyStopping counter: 14 out of 20
Updating learning rate to 3.6504497720381275e-05
Epoch: 20 cost time: 1.3713440895080566
Epoch: 20, Steps: 71 | Train Loss: 0.2258168 Vali Loss: 0.3936323 Test Loss: 0.3107905
EarlyStopping counter: 15 out of 20
Updating learning rate to 3.285404794834315e-05
Epoch: 21 cost time: 1.403749942779541
Epoch: 21, Steps: 71 | Train Loss: 0.2248882 Vali Loss: 0.3925537 Test Loss: 0.3110743
EarlyStopping counter: 16 out of 20
Updating learning rate to 2.9568643153508836e-05
Epoch: 22 cost time: 1.3684663772583008
Epoch: 22, Steps: 71 | Train Loss: 0.2238293 Vali Loss: 0.3977012 Test Loss: 0.3123095
EarlyStopping counter: 17 out of 20
Updating learning rate to 2.6611778838157958e-05
Epoch: 23 cost time: 1.4542474746704102
Epoch: 23, Steps: 71 | Train Loss: 0.2230898 Vali Loss: 0.3946681 Test Loss: 0.3107641
EarlyStopping counter: 18 out of 20
Updating learning rate to 2.395060095434216e-05
Epoch: 24 cost time: 1.4158375263214111
Epoch: 24, Steps: 71 | Train Loss: 0.2225141 Vali Loss: 0.3948852 Test Loss: 0.3140559
EarlyStopping counter: 19 out of 20
Updating learning rate to 2.1555540858907946e-05
Epoch: 25 cost time: 1.4025061130523682
Epoch: 25, Steps: 71 | Train Loss: 0.2220621 Vali Loss: 0.3959058 Test Loss: 0.3128660
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : 96_96_SPM_TST_ETTm1_ftM_sl96_ll18_pl96_dm102_nh1_el1_dl1_df443_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.3129059076309204, mae:0.3588692247867584, rse:0.5317697525024414
