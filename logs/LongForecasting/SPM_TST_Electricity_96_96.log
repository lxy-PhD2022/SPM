Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=250, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=256, data='custom', data_path='electricity.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', dishts=1, distil=True, do_predict=False, dropout=0.2, e_layers=1, embed='timeF', embed_type=0, enc_in=321, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, hidden_size=[32, 8], hidden_size1=3, hidden_size2=3, individual=0, is_training=1, itr=1, k=1.0, kernel_size=25, label_len=18, learning_rate=0.01, loss='mse', lradj='TST', model='SPM_TST', model_id='96_96', moving_avg=25, n_heads=1, num_layers=3, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.2, pred_len=96, random_seed=2021, revin=1, root_path='./dataset/', seq_len=96, stride=8, subtract_last=0, target='OT', test_flop=False, topk=49, traffic=0, train_epochs=300, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : 96_96_SPM_TST_custom_ftM_sl96_ll18_pl96_dm256_nh1_el1_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18221
val 2537
test 5165
Epoch: 1 cost time: 14.218843221664429
Epoch: 1, Steps: 72 | Train Loss: 0.2415404 Vali Loss: 0.1663576 Test Loss: 0.1763106
Validation loss decreased (inf --> 0.166358).  Saving model ...
Updating learning rate to 0.00040658127901777724
Epoch: 2 cost time: 14.000725746154785
Epoch: 2, Steps: 72 | Train Loss: 0.1803542 Vali Loss: 0.1556425 Test Loss: 0.1642182
Validation loss decreased (0.166358 --> 0.155642).  Saving model ...
Updating learning rate to 0.0004263070688904809
Epoch: 3 cost time: 14.080096244812012
Epoch: 3, Steps: 72 | Train Loss: 0.1719489 Vali Loss: 0.1504188 Test Loss: 0.1586051
Validation loss decreased (0.155642 --> 0.150419).  Saving model ...
Updating learning rate to 0.0004591232775651953
Epoch: 4 cost time: 14.050279378890991
Epoch: 4, Steps: 72 | Train Loss: 0.1671835 Vali Loss: 0.1470939 Test Loss: 0.1552320
Validation loss decreased (0.150419 --> 0.147094).  Saving model ...
Updating learning rate to 0.0005049399164479221
Epoch: 5 cost time: 14.159124374389648
Epoch: 5, Steps: 72 | Train Loss: 0.1632501 Vali Loss: 0.1450637 Test Loss: 0.1523537
Validation loss decreased (0.147094 --> 0.145064).  Saving model ...
Updating learning rate to 0.0005636313471702684
Epoch: 6 cost time: 14.170937776565552
Epoch: 6, Steps: 72 | Train Loss: 0.1604472 Vali Loss: 0.1446396 Test Loss: 0.1514276
Validation loss decreased (0.145064 --> 0.144640).  Saving model ...
Updating learning rate to 0.0006350366261149293
Epoch: 7 cost time: 14.170161247253418
Epoch: 7, Steps: 72 | Train Loss: 0.1581788 Vali Loss: 0.1397752 Test Loss: 0.1483904
Validation loss decreased (0.144640 --> 0.139775).  Saving model ...
Updating learning rate to 0.0007189599457552015
Epoch: 8 cost time: 14.083659410476685
Epoch: 8, Steps: 72 | Train Loss: 0.1560221 Vali Loss: 0.1385762 Test Loss: 0.1471350
Validation loss decreased (0.139775 --> 0.138576).  Saving model ...
Updating learning rate to 0.0008151711715983171
Epoch: 9 cost time: 14.090879201889038
Epoch: 9, Steps: 72 | Train Loss: 0.1537849 Vali Loss: 0.1368992 Test Loss: 0.1453059
Validation loss decreased (0.138576 --> 0.136899).  Saving model ...
Updating learning rate to 0.0009234064732601445
Epoch: 10 cost time: 14.093610525131226
Epoch: 10, Steps: 72 | Train Loss: 0.1519017 Vali Loss: 0.1347772 Test Loss: 0.1427637
Validation loss decreased (0.136899 --> 0.134777).  Saving model ...
Updating learning rate to 0.001043369047940763
Epoch: 11 cost time: 14.141759157180786
Epoch: 11, Steps: 72 | Train Loss: 0.1500387 Vali Loss: 0.1341002 Test Loss: 0.1431091
Validation loss decreased (0.134777 --> 0.134100).  Saving model ...
Updating learning rate to 0.0011747299343169773
Epoch: 12 cost time: 14.14796757698059
Epoch: 12, Steps: 72 | Train Loss: 0.1489302 Vali Loss: 0.1319209 Test Loss: 0.1406791
Validation loss decreased (0.134100 --> 0.131921).  Saving model ...
Updating learning rate to 0.0013171289146199291
Epoch: 13 cost time: 14.140693664550781
Epoch: 13, Steps: 72 | Train Loss: 0.1465328 Vali Loss: 0.1301130 Test Loss: 0.1390719
Validation loss decreased (0.131921 --> 0.130113).  Saving model ...
Updating learning rate to 0.0014701755024241082
Epoch: 14 cost time: 14.163063764572144
Epoch: 14, Steps: 72 | Train Loss: 0.1445138 Vali Loss: 0.1312525 Test Loss: 0.1390404
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0016334500134390743
Epoch: 15 cost time: 14.110114812850952
Epoch: 15, Steps: 72 | Train Loss: 0.1435964 Vali Loss: 0.1298330 Test Loss: 0.1388874
Validation loss decreased (0.130113 --> 0.129833).  Saving model ...
Updating learning rate to 0.0018065047163675456
Epoch: 16 cost time: 14.165833234786987
Epoch: 16, Steps: 72 | Train Loss: 0.1422704 Vali Loss: 0.1314052 Test Loss: 0.1396684
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.001988865060673972
Epoch: 17 cost time: 14.218872547149658
Epoch: 17, Steps: 72 | Train Loss: 0.1416567 Vali Loss: 0.1277765 Test Loss: 0.1371195
Validation loss decreased (0.129833 --> 0.127777).  Saving model ...
Updating learning rate to 0.0021800309778968324
Epoch: 18 cost time: 14.155982971191406
Epoch: 18, Steps: 72 | Train Loss: 0.1419465 Vali Loss: 0.1298566 Test Loss: 0.1386365
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0023794782529361546
Epoch: 19 cost time: 14.111061573028564
Epoch: 19, Steps: 72 | Train Loss: 0.1407164 Vali Loss: 0.1285637 Test Loss: 0.1384855
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0025866599615559493
Epoch: 20 cost time: 14.081053972244263
Epoch: 20, Steps: 72 | Train Loss: 0.1394143 Vali Loss: 0.1266494 Test Loss: 0.1367343
Validation loss decreased (0.127777 --> 0.126649).  Saving model ...
Updating learning rate to 0.0028010079701596326
Epoch: 21 cost time: 14.128536462783813
Epoch: 21, Steps: 72 | Train Loss: 0.1387630 Vali Loss: 0.1256845 Test Loss: 0.1357293
Validation loss decreased (0.126649 --> 0.125684).  Saving model ...
Updating learning rate to 0.003021934493725735
Epoch: 22 cost time: 14.12588906288147
Epoch: 22, Steps: 72 | Train Loss: 0.1387781 Vali Loss: 0.1266860 Test Loss: 0.1366020
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.003248833707631747
Epoch: 23 cost time: 14.048734426498413
Epoch: 23, Steps: 72 | Train Loss: 0.1371838 Vali Loss: 0.1257883 Test Loss: 0.1349553
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00348108340894616
Epoch: 24 cost time: 14.192848920822144
Epoch: 24, Steps: 72 | Train Loss: 0.1353960 Vali Loss: 0.1298564 Test Loss: 0.1369843
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0037180467226330784
Epoch: 25 cost time: 14.139861106872559
Epoch: 25, Steps: 72 | Train Loss: 0.1362028 Vali Loss: 0.1304531 Test Loss: 0.1413963
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.003959073847990688
Epoch: 26 cost time: 14.140260934829712
Epoch: 26, Steps: 72 | Train Loss: 0.1380690 Vali Loss: 0.1300593 Test Loss: 0.1391001
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.004203503840534477
Epoch: 27 cost time: 14.21586012840271
Epoch: 27, Steps: 72 | Train Loss: 0.1379546 Vali Loss: 0.1278309 Test Loss: 0.1383901
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.004450666424438927
Epoch: 28 cost time: 13.974697828292847
Epoch: 28, Steps: 72 | Train Loss: 53.0567801 Vali Loss: 3497.3828125 Test Loss: 3763.4055176
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00469988383056761
Epoch: 29 cost time: 14.080064058303833
Epoch: 29, Steps: 72 | Train Loss: 65.9155287 Vali Loss: 0.7823796 Test Loss: 0.8431406
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.0049504726550514315
Epoch: 30 cost time: 14.098010301589966
Epoch: 30, Steps: 72 | Train Loss: 0.8522161 Vali Loss: 0.6749038 Test Loss: 0.7322096
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.005201745733318453
Epoch: 31 cost time: 14.058799266815186
Epoch: 31, Steps: 72 | Train Loss: 0.7750778 Vali Loss: 0.6427846 Test Loss: 0.6928949
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.005453014024436279
Epoch: 32 cost time: 14.146010398864746
Epoch: 32, Steps: 72 | Train Loss: 0.7234520 Vali Loss: 0.5871030 Test Loss: 0.6332939
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.005703588500599846
Epoch: 33 cost time: 14.108343839645386
Epoch: 33, Steps: 72 | Train Loss: 0.6564619 Vali Loss: 0.5362654 Test Loss: 0.5731755
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.005952782036583166
Epoch: 34 cost time: 13.89585828781128
Epoch: 34, Steps: 72 | Train Loss: 0.6105729 Vali Loss: 0.5063990 Test Loss: 0.5409715
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.006199911293973852
Epoch: 35 cost time: 14.112918853759766
Epoch: 35, Steps: 72 | Train Loss: 0.5797930 Vali Loss: 0.4917812 Test Loss: 0.5257307
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.006444298595023424
Epoch: 36 cost time: 14.01278281211853
Epoch: 36, Steps: 72 | Train Loss: 0.5575595 Vali Loss: 0.4774884 Test Loss: 0.5083004
EarlyStopping counter: 15 out of 20
Updating learning rate to 0.0066852737809749655
Epoch: 37 cost time: 13.834887504577637
Epoch: 37, Steps: 72 | Train Loss: 0.5370986 Vali Loss: 0.4606270 Test Loss: 0.4928133
EarlyStopping counter: 16 out of 20
Updating learning rate to 0.00692217604977218
Epoch: 38 cost time: 13.963747024536133
Epoch: 38, Steps: 72 | Train Loss: 0.5211181 Vali Loss: 0.4538352 Test Loss: 0.4825638
EarlyStopping counter: 17 out of 20
Updating learning rate to 0.0071543557681105225
Epoch: 39 cost time: 14.03344178199768
Epoch: 39, Steps: 72 | Train Loss: 0.5134643 Vali Loss: 0.4417307 Test Loss: 0.4649540
EarlyStopping counter: 18 out of 20
Updating learning rate to 0.007381176252861393
Epoch: 40 cost time: 14.044822692871094
Epoch: 40, Steps: 72 | Train Loss: 0.5033701 Vali Loss: 0.4408870 Test Loss: 0.4606212
EarlyStopping counter: 19 out of 20
Updating learning rate to 0.007602015516984332
Epoch: 41 cost time: 14.047411441802979
Epoch: 41, Steps: 72 | Train Loss: 0.4974241 Vali Loss: 0.4223185 Test Loss: 0.4462864
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : 96_96_SPM_TST_custom_ftM_sl96_ll18_pl96_dm256_nh1_el1_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
mse:0.13572964072227478, mae:0.23849381506443024, rse:0.3682156801223755
