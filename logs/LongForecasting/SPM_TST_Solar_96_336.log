Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=64, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=256, data='Solar', data_path='solar_AL.txt', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', dishts=1, distil=True, do_predict=False, dropout=0.2, e_layers=1, embed='timeF', embed_type=0, enc_in=137, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, hidden_size=[32, 8], hidden_size1=3, hidden_size2=3, individual=0, is_training=1, itr=1, k=1.0, kernel_size=25, label_len=18, learning_rate=0.0001, loss='mse', lradj='TST', model='SPM_TST', model_id='96_336', moving_avg=25, n_heads=1, num_layers=3, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=8, pct_start=0.2, pred_len=336, random_seed=2021, revin=1, root_path='./dataset/', seq_len=96, stride=8, subtract_last=0, target='OT', test_flop=False, topk=49, traffic=0, train_epochs=300, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : 96_336_SPM_TST_Solar_ftM_sl96_ll18_pl336_dm256_nh1_el1_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36361
val 4921
test 10177
	iters: 100, epoch: 1 | loss: 1.0072889
	speed: 0.0491s/iter; left time: 8357.9451s
	iters: 200, epoch: 1 | loss: 0.7399496
	speed: 0.0343s/iter; left time: 5846.0277s
	iters: 300, epoch: 1 | loss: 0.5417804
	speed: 0.0360s/iter; left time: 6123.6435s
	iters: 400, epoch: 1 | loss: 0.4282875
	speed: 0.0327s/iter; left time: 5555.2778s
	iters: 500, epoch: 1 | loss: 0.3387321
	speed: 0.0339s/iter; left time: 5759.5250s
Epoch: 1 cost time: 20.180954456329346
Epoch: 1, Steps: 568 | Train Loss: 0.6719234 Vali Loss: 0.3201017 Test Loss: 0.4165701
Validation loss decreased (inf --> 0.320102).  Saving model ...
Updating learning rate to 4.065786191533746e-06
	iters: 100, epoch: 2 | loss: 0.2888987
	speed: 0.1626s/iter; left time: 27602.4484s
	iters: 200, epoch: 2 | loss: 0.2656114
	speed: 0.0321s/iter; left time: 5446.7332s
	iters: 300, epoch: 2 | loss: 0.3674415
	speed: 0.0311s/iter; left time: 5276.0222s
	iters: 400, epoch: 2 | loss: 0.2897000
	speed: 0.0332s/iter; left time: 5631.7112s
	iters: 500, epoch: 2 | loss: 0.2617854
	speed: 0.0353s/iter; left time: 5978.9317s
Epoch: 2 cost time: 19.801095962524414
Epoch: 2, Steps: 568 | Train Loss: 0.3130316 Vali Loss: 0.2672495 Test Loss: 0.3775755
Validation loss decreased (0.320102 --> 0.267250).  Saving model ...
Updating learning rate to 4.262964440176817e-06
	iters: 100, epoch: 3 | loss: 0.3146804
	speed: 0.1874s/iter; left time: 31709.5181s
	iters: 200, epoch: 3 | loss: 0.2626746
	speed: 0.0322s/iter; left time: 5438.7146s
	iters: 300, epoch: 3 | loss: 0.2369690
	speed: 0.0334s/iter; left time: 5639.2900s
	iters: 400, epoch: 3 | loss: 0.2463000
	speed: 0.0320s/iter; left time: 5411.9174s
	iters: 500, epoch: 3 | loss: 0.3450049
	speed: 0.0309s/iter; left time: 5210.1749s
Epoch: 3 cost time: 19.390079736709595
Epoch: 3, Steps: 568 | Train Loss: 0.2962368 Vali Loss: 0.2549439 Test Loss: 0.3605555
Validation loss decreased (0.267250 --> 0.254944).  Saving model ...
Updating learning rate to 4.590994262344556e-06
	iters: 100, epoch: 4 | loss: 0.2746796
	speed: 0.1891s/iter; left time: 31883.5797s
	iters: 200, epoch: 4 | loss: 0.2847739
	speed: 0.0321s/iter; left time: 5411.4506s
	iters: 300, epoch: 4 | loss: 0.2941862
	speed: 0.0323s/iter; left time: 5443.5335s
	iters: 400, epoch: 4 | loss: 0.2779582
	speed: 0.0325s/iter; left time: 5473.3440s
	iters: 500, epoch: 4 | loss: 0.2873226
	speed: 0.0327s/iter; left time: 5503.0246s
Epoch: 4 cost time: 19.473954439163208
Epoch: 4, Steps: 568 | Train Loss: 0.2874473 Vali Loss: 0.2478715 Test Loss: 0.3544915
Validation loss decreased (0.254944 --> 0.247871).  Saving model ...
Updating learning rate to 5.0489764983407075e-06
	iters: 100, epoch: 5 | loss: 0.2724996
	speed: 0.1844s/iter; left time: 30990.6987s
	iters: 200, epoch: 5 | loss: 0.2466719
	speed: 0.0345s/iter; left time: 5801.4920s
	iters: 300, epoch: 5 | loss: 0.3622646
	speed: 0.0320s/iter; left time: 5376.2008s
	iters: 400, epoch: 5 | loss: 0.2713818
	speed: 0.0326s/iter; left time: 5474.6937s
	iters: 500, epoch: 5 | loss: 0.2750824
	speed: 0.0318s/iter; left time: 5325.0802s
Epoch: 5 cost time: 19.803992748260498
Epoch: 5, Steps: 568 | Train Loss: 0.2797740 Vali Loss: 0.2393998 Test Loss: 0.3401490
Validation loss decreased (0.247871 --> 0.239400).  Saving model ...
Updating learning rate to 5.635655777036267e-06
	iters: 100, epoch: 6 | loss: 0.2526534
	speed: 0.1810s/iter; left time: 30310.4784s
	iters: 200, epoch: 6 | loss: 0.2475523
	speed: 0.0327s/iter; left time: 5477.8221s
	iters: 300, epoch: 6 | loss: 0.2287793
	speed: 0.0338s/iter; left time: 5658.2241s
	iters: 400, epoch: 6 | loss: 0.2828727
	speed: 0.0346s/iter; left time: 5783.0744s
	iters: 500, epoch: 6 | loss: 0.2356634
	speed: 0.0314s/iter; left time: 5238.8237s
Epoch: 6 cost time: 19.60366439819336
Epoch: 6, Steps: 568 | Train Loss: 0.2720149 Vali Loss: 0.2311836 Test Loss: 0.3319682
Validation loss decreased (0.239400 --> 0.231184).  Saving model ...
Updating learning rate to 6.34942395695635e-06
	iters: 100, epoch: 7 | loss: 0.2913256
	speed: 0.1815s/iter; left time: 30296.9698s
	iters: 200, epoch: 7 | loss: 0.2596230
	speed: 0.0310s/iter; left time: 5173.0444s
	iters: 300, epoch: 7 | loss: 0.2734495
	speed: 0.0318s/iter; left time: 5296.1658s
	iters: 400, epoch: 7 | loss: 0.2769034
	speed: 0.0340s/iter; left time: 5658.9856s
	iters: 500, epoch: 7 | loss: 0.2559261
	speed: 0.0325s/iter; left time: 5417.8385s
Epoch: 7 cost time: 19.49303102493286
Epoch: 7, Steps: 568 | Train Loss: 0.2640430 Vali Loss: 0.2231318 Test Loss: 0.3201555
Validation loss decreased (0.231184 --> 0.223132).  Saving model ...
Updating learning rate to 7.18832453434284e-06
	iters: 100, epoch: 8 | loss: 0.2543516
	speed: 0.1849s/iter; left time: 30761.4386s
	iters: 200, epoch: 8 | loss: 0.2726380
	speed: 0.0321s/iter; left time: 5341.3170s
	iters: 300, epoch: 8 | loss: 0.2662382
	speed: 0.0319s/iter; left time: 5304.6768s
	iters: 400, epoch: 8 | loss: 0.2542831
	speed: 0.0311s/iter; left time: 5167.8958s
	iters: 500, epoch: 8 | loss: 0.2530173
	speed: 0.0321s/iter; left time: 5322.8549s
Epoch: 8 cost time: 18.925903797149658
Epoch: 8, Steps: 568 | Train Loss: 0.2572683 Vali Loss: 0.2163109 Test Loss: 0.3085239
Validation loss decreased (0.223132 --> 0.216311).  Saving model ...
Updating learning rate to 8.150058006109852e-06
	iters: 100, epoch: 9 | loss: 0.2206632
	speed: 0.1838s/iter; left time: 30462.4769s
	iters: 200, epoch: 9 | loss: 0.2572587
	speed: 0.0323s/iter; left time: 5356.6411s
	iters: 300, epoch: 9 | loss: 0.2365460
	speed: 0.0324s/iter; left time: 5360.2109s
	iters: 400, epoch: 9 | loss: 0.2270688
	speed: 0.0318s/iter; left time: 5254.8514s
	iters: 500, epoch: 9 | loss: 0.2660736
	speed: 0.0318s/iter; left time: 5254.7076s
Epoch: 9 cost time: 19.208365201950073
Epoch: 9, Steps: 568 | Train Loss: 0.2514368 Vali Loss: 0.2097319 Test Loss: 0.3016350
Validation loss decreased (0.216311 --> 0.209732).  Saving model ...
Updating learning rate to 9.231988172991575e-06
	iters: 100, epoch: 10 | loss: 0.2546396
	speed: 0.1869s/iter; left time: 30880.1142s
	iters: 200, epoch: 10 | loss: 0.1904986
	speed: 0.0350s/iter; left time: 5773.2572s
	iters: 300, epoch: 10 | loss: 0.2493137
	speed: 0.0343s/iter; left time: 5660.0484s
	iters: 400, epoch: 10 | loss: 0.2302538
	speed: 0.0313s/iter; left time: 5160.6615s
	iters: 500, epoch: 10 | loss: 0.2327209
	speed: 0.0320s/iter; left time: 5276.8312s
Epoch: 10 cost time: 19.740171432495117
Epoch: 10, Steps: 568 | Train Loss: 0.2467448 Vali Loss: 0.2069913 Test Loss: 0.2988623
Validation loss decreased (0.209732 --> 0.206991).  Saving model ...
Updating learning rate to 1.043114936560537e-05
	iters: 100, epoch: 11 | loss: 0.2637211
	speed: 0.1829s/iter; left time: 30109.8171s
	iters: 200, epoch: 11 | loss: 0.2471183
	speed: 0.0325s/iter; left time: 5339.8136s
	iters: 300, epoch: 11 | loss: 0.2691484
	speed: 0.0331s/iter; left time: 5437.5423s
	iters: 400, epoch: 11 | loss: 0.2064997
	speed: 0.0350s/iter; left time: 5749.8293s
	iters: 500, epoch: 11 | loss: 0.2185250
	speed: 0.0353s/iter; left time: 5798.4812s
Epoch: 11 cost time: 19.852009057998657
Epoch: 11, Steps: 568 | Train Loss: 0.2430190 Vali Loss: 0.2048856 Test Loss: 0.2933397
Validation loss decreased (0.206991 --> 0.204886).  Saving model ...
Updating learning rate to 1.174425457362218e-05
	iters: 100, epoch: 12 | loss: 0.2519583
	speed: 0.1801s/iter; left time: 29550.3952s
	iters: 200, epoch: 12 | loss: 0.2178994
	speed: 0.0313s/iter; left time: 5137.1563s
	iters: 300, epoch: 12 | loss: 0.2136404
	speed: 0.0325s/iter; left time: 5323.7146s
	iters: 400, epoch: 12 | loss: 0.2317813
	speed: 0.0306s/iter; left time: 5007.5462s
	iters: 500, epoch: 12 | loss: 0.2677836
	speed: 0.0353s/iter; left time: 5778.7305s
Epoch: 12 cost time: 19.445971965789795
Epoch: 12, Steps: 568 | Train Loss: 0.2397217 Vali Loss: 0.2016624 Test Loss: 0.2881716
Validation loss decreased (0.204886 --> 0.201662).  Saving model ...
Updating learning rate to 1.3167704455762053e-05
	iters: 100, epoch: 13 | loss: 0.2698773
	speed: 0.1838s/iter; left time: 30049.3048s
	iters: 200, epoch: 13 | loss: 0.2152189
	speed: 0.0318s/iter; left time: 5192.9023s
	iters: 300, epoch: 13 | loss: 0.2416228
	speed: 0.0324s/iter; left time: 5285.5954s
	iters: 400, epoch: 13 | loss: 0.2369090
	speed: 0.0323s/iter; left time: 5275.1906s
	iters: 500, epoch: 13 | loss: 0.2944560
	speed: 0.0320s/iter; left time: 5216.8351s
Epoch: 13 cost time: 19.256922483444214
Epoch: 13, Steps: 568 | Train Loss: 0.2369426 Vali Loss: 0.2004324 Test Loss: 0.2829874
Validation loss decreased (0.201662 --> 0.200432).  Saving model ...
Updating learning rate to 1.4697597205917272e-05
	iters: 100, epoch: 14 | loss: 0.2247650
	speed: 0.1925s/iter; left time: 31368.4819s
	iters: 200, epoch: 14 | loss: 0.2407614
	speed: 0.0303s/iter; left time: 4934.4218s
	iters: 300, epoch: 14 | loss: 0.2611299
	speed: 0.0322s/iter; left time: 5233.6182s
	iters: 400, epoch: 14 | loss: 0.2631242
	speed: 0.0317s/iter; left time: 5155.6561s
	iters: 500, epoch: 14 | loss: 0.2069462
	speed: 0.0312s/iter; left time: 5078.1545s
Epoch: 14 cost time: 19.1736843585968
Epoch: 14, Steps: 568 | Train Loss: 0.2343336 Vali Loss: 0.1988638 Test Loss: 0.2764017
Validation loss decreased (0.200432 --> 0.198864).  Saving model ...
Updating learning rate to 1.6329739248359195e-05
	iters: 100, epoch: 15 | loss: 0.1983296
	speed: 0.1836s/iter; left time: 29815.2948s
	iters: 200, epoch: 15 | loss: 0.2146549
	speed: 0.0336s/iter; left time: 5444.2563s
	iters: 300, epoch: 15 | loss: 0.2761265
	speed: 0.0350s/iter; left time: 5676.8487s
	iters: 400, epoch: 15 | loss: 0.2240977
	speed: 0.0311s/iter; left time: 5035.3243s
	iters: 500, epoch: 15 | loss: 0.2387321
	speed: 0.0324s/iter; left time: 5249.1817s
Epoch: 15 cost time: 19.864157676696777
Epoch: 15, Steps: 568 | Train Loss: 0.2320550 Vali Loss: 0.2003406 Test Loss: 0.2803448
EarlyStopping counter: 1 out of 8
Updating learning rate to 1.8059656732712196e-05
	iters: 100, epoch: 16 | loss: 0.2107971
	speed: 0.1799s/iter; left time: 29110.8476s
	iters: 200, epoch: 16 | loss: 0.2217548
	speed: 0.0313s/iter; left time: 5060.1683s
	iters: 300, epoch: 16 | loss: 0.2296879
	speed: 0.0327s/iter; left time: 5290.8780s
	iters: 400, epoch: 16 | loss: 0.2156932
	speed: 0.0323s/iter; left time: 5221.0901s
	iters: 500, epoch: 16 | loss: 0.2071547
	speed: 0.0342s/iter; left time: 5514.6790s
Epoch: 16 cost time: 19.611692190170288
Epoch: 16, Steps: 568 | Train Loss: 0.2302406 Vali Loss: 0.1964482 Test Loss: 0.2779567
Validation loss decreased (0.198864 --> 0.196448).  Saving model ...
Updating learning rate to 1.9882607797186167e-05
	iters: 100, epoch: 17 | loss: 0.2328296
	speed: 0.1819s/iter; left time: 29329.7718s
	iters: 200, epoch: 17 | loss: 0.1915018
	speed: 0.0311s/iter; left time: 5018.4898s
	iters: 300, epoch: 17 | loss: 0.2664803
	speed: 0.0315s/iter; left time: 5079.8641s
	iters: 400, epoch: 17 | loss: 0.2404811
	speed: 0.0318s/iter; left time: 5111.9456s
	iters: 500, epoch: 17 | loss: 0.2362671
	speed: 0.0312s/iter; left time: 5024.3063s
Epoch: 17 cost time: 19.176182508468628
Epoch: 17, Steps: 568 | Train Loss: 0.2285976 Vali Loss: 0.1962104 Test Loss: 0.2700002
Validation loss decreased (0.196448 --> 0.196210).  Saving model ...
Updating learning rate to 2.17935955664526e-05
	iters: 100, epoch: 18 | loss: 0.2238072
	speed: 0.1898s/iter; left time: 30494.7689s
	iters: 200, epoch: 18 | loss: 0.2053162
	speed: 0.0318s/iter; left time: 5110.4874s
	iters: 300, epoch: 18 | loss: 0.2294639
	speed: 0.0314s/iter; left time: 5042.2070s
	iters: 400, epoch: 18 | loss: 0.1985164
	speed: 0.0317s/iter; left time: 5088.6026s
	iters: 500, epoch: 18 | loss: 0.1752637
	speed: 0.0316s/iter; left time: 5056.1102s
Epoch: 18 cost time: 18.968908548355103
Epoch: 18, Steps: 568 | Train Loss: 0.2265967 Vali Loss: 0.1947787 Test Loss: 0.2746499
Validation loss decreased (0.196210 --> 0.194779).  Saving model ...
Updating learning rate to 2.3787381848536156e-05
	iters: 100, epoch: 19 | loss: 0.2415958
	speed: 0.1845s/iter; left time: 29526.4067s
	iters: 200, epoch: 19 | loss: 0.2232874
	speed: 0.0344s/iter; left time: 5507.3343s
	iters: 300, epoch: 19 | loss: 0.2481444
	speed: 0.0303s/iter; left time: 4844.3809s
	iters: 400, epoch: 19 | loss: 0.2222939
	speed: 0.0320s/iter; left time: 5118.7500s
	iters: 500, epoch: 19 | loss: 0.2437171
	speed: 0.0334s/iter; left time: 5331.4410s
Epoch: 19 cost time: 19.77384638786316
Epoch: 19, Steps: 568 | Train Loss: 0.2253707 Vali Loss: 0.1948455 Test Loss: 0.2737593
EarlyStopping counter: 1 out of 8
Updating learning rate to 2.585850149317725e-05
	iters: 100, epoch: 20 | loss: 0.2027434
	speed: 0.1800s/iter; left time: 28715.8139s
	iters: 200, epoch: 20 | loss: 0.2053028
	speed: 0.0335s/iter; left time: 5332.8099s
	iters: 300, epoch: 20 | loss: 0.2456254
	speed: 0.0334s/iter; left time: 5314.0670s
	iters: 400, epoch: 20 | loss: 0.2285165
	speed: 0.0349s/iter; left time: 5562.1619s
	iters: 500, epoch: 20 | loss: 0.2418836
	speed: 0.0312s/iter; left time: 4964.6843s
Epoch: 20 cost time: 19.640673637390137
Epoch: 20, Steps: 568 | Train Loss: 0.2237314 Vali Loss: 0.1917332 Test Loss: 0.2635532
Validation loss decreased (0.194779 --> 0.191733).  Saving model ...
Updating learning rate to 2.8001277372307893e-05
	iters: 100, epoch: 21 | loss: 0.2369055
	speed: 0.1824s/iter; left time: 28988.4098s
	iters: 200, epoch: 21 | loss: 0.2207180
	speed: 0.0316s/iter; left time: 5019.1288s
	iters: 300, epoch: 21 | loss: 0.2299313
	speed: 0.0318s/iter; left time: 5043.7413s
	iters: 400, epoch: 21 | loss: 0.2254562
	speed: 0.0327s/iter; left time: 5185.9392s
	iters: 500, epoch: 21 | loss: 0.2417273
	speed: 0.0317s/iter; left time: 5023.5427s
Epoch: 21 cost time: 19.292132139205933
Epoch: 21, Steps: 568 | Train Loss: 0.2222537 Vali Loss: 0.1932442 Test Loss: 0.2613813
EarlyStopping counter: 1 out of 8
Updating learning rate to 3.020983594157816e-05
	iters: 100, epoch: 22 | loss: 0.2226223
	speed: 0.1832s/iter; left time: 29017.3069s
	iters: 200, epoch: 22 | loss: 0.2529134
	speed: 0.0316s/iter; left time: 5006.7178s
	iters: 300, epoch: 22 | loss: 0.2360386
	speed: 0.0313s/iter; left time: 4949.4111s
	iters: 400, epoch: 22 | loss: 0.1864636
	speed: 0.0317s/iter; left time: 5009.1531s
	iters: 500, epoch: 22 | loss: 0.2403101
	speed: 0.0317s/iter; left time: 5015.4227s
Epoch: 22 cost time: 18.94014859199524
Epoch: 22, Steps: 568 | Train Loss: 0.2212993 Vali Loss: 0.1939117 Test Loss: 0.2602420
EarlyStopping counter: 2 out of 8
Updating learning rate to 3.2478123340277536e-05
	iters: 100, epoch: 23 | loss: 0.2147390
	speed: 0.1876s/iter; left time: 29607.2798s
	iters: 200, epoch: 23 | loss: 0.2199773
	speed: 0.0313s/iter; left time: 4928.3658s
	iters: 300, epoch: 23 | loss: 0.2144968
	speed: 0.0320s/iter; left time: 5044.7444s
	iters: 400, epoch: 23 | loss: 0.2137021
	speed: 0.0316s/iter; left time: 4980.6786s
	iters: 500, epoch: 23 | loss: 0.2264525
	speed: 0.0317s/iter; left time: 4989.3085s
Epoch: 23 cost time: 19.000088930130005
Epoch: 23, Steps: 568 | Train Loss: 0.2201862 Vali Loss: 0.1907947 Test Loss: 0.2638153
Validation loss decreased (0.191733 --> 0.190795).  Saving model ...
Updating learning rate to 3.479992198552005e-05
	iters: 100, epoch: 24 | loss: 0.2067300
	speed: 0.1823s/iter; left time: 28667.0448s
	iters: 200, epoch: 24 | loss: 0.2511360
	speed: 0.0338s/iter; left time: 5304.4497s
	iters: 300, epoch: 24 | loss: 0.2630912
	speed: 0.0347s/iter; left time: 5456.6945s
	iters: 400, epoch: 24 | loss: 0.2215103
	speed: 0.0309s/iter; left time: 4854.6892s
	iters: 500, epoch: 24 | loss: 0.2092686
	speed: 0.0321s/iter; left time: 5029.7667s
Epoch: 24 cost time: 19.703968286514282
Epoch: 24, Steps: 568 | Train Loss: 0.2189773 Vali Loss: 0.1872838 Test Loss: 0.2640354
Validation loss decreased (0.190795 --> 0.187284).  Saving model ...
Updating learning rate to 3.716886761520655e-05
	iters: 100, epoch: 25 | loss: 0.2041292
	speed: 0.1793s/iter; left time: 28092.3875s
	iters: 200, epoch: 25 | loss: 0.2141839
	speed: 0.0297s/iter; left time: 4644.1495s
	iters: 300, epoch: 25 | loss: 0.2320821
	speed: 0.0346s/iter; left time: 5420.1768s
	iters: 400, epoch: 25 | loss: 0.2109705
	speed: 0.0316s/iter; left time: 4941.3832s
	iters: 500, epoch: 25 | loss: 0.2154320
	speed: 0.0345s/iter; left time: 5389.5705s
Epoch: 25 cost time: 19.528626441955566
Epoch: 25, Steps: 568 | Train Loss: 0.2176597 Vali Loss: 0.1893202 Test Loss: 0.2550106
EarlyStopping counter: 1 out of 8
Updating learning rate to 3.957846673304841e-05
	iters: 100, epoch: 26 | loss: 0.2221542
	speed: 0.1790s/iter; left time: 27947.8058s
	iters: 200, epoch: 26 | loss: 0.2277480
	speed: 0.0317s/iter; left time: 4939.1246s
	iters: 300, epoch: 26 | loss: 0.2015448
	speed: 0.0310s/iter; left time: 4828.3980s
	iters: 400, epoch: 26 | loss: 0.2347393
	speed: 0.0318s/iter; left time: 4954.2550s
	iters: 500, epoch: 26 | loss: 0.2118703
	speed: 0.0312s/iter; left time: 4852.6112s
Epoch: 26 cost time: 19.008864641189575
Epoch: 26, Steps: 568 | Train Loss: 0.2165818 Vali Loss: 0.1889420 Test Loss: 0.2538011
EarlyStopping counter: 2 out of 8
Updating learning rate to 4.20221144078337e-05
	iters: 100, epoch: 27 | loss: 0.1973350
	speed: 0.1839s/iter; left time: 28601.5273s
	iters: 200, epoch: 27 | loss: 0.2424488
	speed: 0.0322s/iter; left time: 5009.9888s
	iters: 300, epoch: 27 | loss: 0.2193993
	speed: 0.0328s/iter; left time: 5100.3719s
	iters: 400, epoch: 27 | loss: 0.1752900
	speed: 0.0316s/iter; left time: 4905.6642s
	iters: 500, epoch: 27 | loss: 0.2500373
	speed: 0.0318s/iter; left time: 4940.9283s
Epoch: 27 cost time: 19.165414571762085
Epoch: 27, Steps: 568 | Train Loss: 0.2156089 Vali Loss: 0.1860371 Test Loss: 0.2555851
Validation loss decreased (0.187284 --> 0.186037).  Saving model ...
Updating learning rate to 4.4493112378146836e-05
	iters: 100, epoch: 28 | loss: 0.1978591
	speed: 0.1861s/iter; left time: 28843.8622s
	iters: 200, epoch: 28 | loss: 0.2048816
	speed: 0.0339s/iter; left time: 5255.5208s
	iters: 300, epoch: 28 | loss: 0.2248687
	speed: 0.0304s/iter; left time: 4700.3532s
	iters: 400, epoch: 28 | loss: 0.2395467
	speed: 0.0314s/iter; left time: 4860.9253s
	iters: 500, epoch: 28 | loss: 0.2107232
	speed: 0.0319s/iter; left time: 4927.2871s
Epoch: 28 cost time: 19.553598880767822
Epoch: 28, Steps: 568 | Train Loss: 0.2144253 Vali Loss: 0.1928543 Test Loss: 0.2552250
EarlyStopping counter: 1 out of 8
Updating learning rate to 4.6984687412914706e-05
	iters: 100, epoch: 29 | loss: 0.2115512
	speed: 0.1756s/iter; left time: 27116.2687s
	iters: 200, epoch: 29 | loss: 0.2171631
	speed: 0.0356s/iter; left time: 5485.7610s
	iters: 300, epoch: 29 | loss: 0.2319950
	speed: 0.0340s/iter; left time: 5240.9978s
	iters: 400, epoch: 29 | loss: 0.2309017
	speed: 0.0355s/iter; left time: 5463.0764s
	iters: 500, epoch: 29 | loss: 0.2113156
	speed: 0.0317s/iter; left time: 4885.6938s
Epoch: 29 cost time: 20.083401679992676
Epoch: 29, Steps: 568 | Train Loss: 0.2136576 Vali Loss: 0.1885942 Test Loss: 0.2547768
EarlyStopping counter: 2 out of 8
Updating learning rate to 4.9490009877451554e-05
	iters: 100, epoch: 30 | loss: 0.2406674
	speed: 0.1766s/iter; left time: 27165.9727s
	iters: 200, epoch: 30 | loss: 0.2156167
	speed: 0.0331s/iter; left time: 5080.9851s
	iters: 300, epoch: 30 | loss: 0.2037785
	speed: 0.0322s/iter; left time: 4941.0439s
	iters: 400, epoch: 30 | loss: 0.1827422
	speed: 0.0343s/iter; left time: 5272.4432s
	iters: 500, epoch: 30 | loss: 0.2074933
	speed: 0.0340s/iter; left time: 5213.0726s
Epoch: 30 cost time: 19.89147448539734
Epoch: 30, Steps: 568 | Train Loss: 0.2123735 Vali Loss: 0.1866783 Test Loss: 0.2556091
EarlyStopping counter: 3 out of 8
Updating learning rate to 5.200221245411131e-05
	iters: 100, epoch: 31 | loss: 0.2156505
	speed: 0.1820s/iter; left time: 27900.1224s
	iters: 200, epoch: 31 | loss: 0.2207250
	speed: 0.0322s/iter; left time: 4932.7099s
	iters: 300, epoch: 31 | loss: 0.1944396
	speed: 0.0324s/iter; left time: 4960.5259s
	iters: 400, epoch: 31 | loss: 0.1955809
	speed: 0.0326s/iter; left time: 4991.5314s
	iters: 500, epoch: 31 | loss: 0.2216479
	speed: 0.0332s/iter; left time: 5067.6950s
Epoch: 31 cost time: 19.540969133377075
Epoch: 31, Steps: 568 | Train Loss: 0.2109947 Vali Loss: 0.1891447 Test Loss: 0.2553584
EarlyStopping counter: 4 out of 8
Updating learning rate to 5.451440896623232e-05
	iters: 100, epoch: 32 | loss: 0.2370422
	speed: 0.1804s/iter; left time: 27549.8100s
	iters: 200, epoch: 32 | loss: 0.2113452
	speed: 0.0336s/iter; left time: 5127.0140s
	iters: 300, epoch: 32 | loss: 0.1976191
	speed: 0.0327s/iter; left time: 4993.0315s
	iters: 400, epoch: 32 | loss: 0.2023916
	speed: 0.0336s/iter; left time: 5119.1199s
	iters: 500, epoch: 32 | loss: 0.1847655
	speed: 0.0334s/iter; left time: 5089.7864s
Epoch: 32 cost time: 19.60534119606018
Epoch: 32, Steps: 568 | Train Loss: 0.2102041 Vali Loss: 0.1885537 Test Loss: 0.2499295
EarlyStopping counter: 5 out of 8
Updating learning rate to 5.7019713253776385e-05
	iters: 100, epoch: 33 | loss: 0.2077422
	speed: 0.1815s/iter; left time: 27606.6806s
	iters: 200, epoch: 33 | loss: 0.1998368
	speed: 0.0344s/iter; left time: 5223.9365s
	iters: 300, epoch: 33 | loss: 0.2062386
	speed: 0.0334s/iter; left time: 5067.7652s
	iters: 400, epoch: 33 | loss: 0.2086702
	speed: 0.0306s/iter; left time: 4643.7672s
	iters: 500, epoch: 33 | loss: 0.2298637
	speed: 0.0323s/iter; left time: 4897.4416s
Epoch: 33 cost time: 19.525384664535522
Epoch: 33, Steps: 568 | Train Loss: 0.2092102 Vali Loss: 0.1879474 Test Loss: 0.2464542
EarlyStopping counter: 6 out of 8
Updating learning rate to 5.951125804892222e-05
	iters: 100, epoch: 34 | loss: 0.2259997
	speed: 0.1772s/iter; left time: 26851.7111s
	iters: 200, epoch: 34 | loss: 0.1900851
	speed: 0.0309s/iter; left time: 4687.4544s
	iters: 300, epoch: 34 | loss: 0.2502631
	speed: 0.0333s/iter; left time: 5034.6383s
	iters: 400, epoch: 34 | loss: 0.2138608
	speed: 0.0337s/iter; left time: 5102.6590s
	iters: 500, epoch: 34 | loss: 0.2463832
	speed: 0.0351s/iter; left time: 5300.8366s
Epoch: 34 cost time: 19.655919790267944
Epoch: 34, Steps: 568 | Train Loss: 0.2080703 Vali Loss: 0.1839036 Test Loss: 0.2519029
Validation loss decreased (0.186037 --> 0.183904).  Saving model ...
Updating learning rate to 6.198221379987366e-05
	iters: 100, epoch: 35 | loss: 0.2130577
	speed: 0.1875s/iter; left time: 28316.9154s
	iters: 200, epoch: 35 | loss: 0.1948333
	speed: 0.0337s/iter; left time: 5083.5014s
	iters: 300, epoch: 35 | loss: 0.1951961
	speed: 0.0344s/iter; left time: 5188.2238s
	iters: 400, epoch: 35 | loss: 0.2434705
	speed: 0.0316s/iter; left time: 4766.2282s
	iters: 500, epoch: 35 | loss: 0.1759391
	speed: 0.0339s/iter; left time: 5102.7585s
Epoch: 35 cost time: 20.06637668609619
Epoch: 35, Steps: 568 | Train Loss: 0.2074271 Vali Loss: 0.1861799 Test Loss: 0.2497804
EarlyStopping counter: 1 out of 8
Updating learning rate to 6.44258073912847e-05
	iters: 100, epoch: 36 | loss: 0.1896102
	speed: 0.1853s/iter; left time: 27878.2674s
	iters: 200, epoch: 36 | loss: 0.2559690
	speed: 0.0322s/iter; left time: 4837.2340s
	iters: 300, epoch: 36 | loss: 0.2062785
	speed: 0.0329s/iter; left time: 4935.5759s
	iters: 400, epoch: 36 | loss: 0.2015853
	speed: 0.0324s/iter; left time: 4860.0474s
	iters: 500, epoch: 36 | loss: 0.2081930
	speed: 0.0323s/iter; left time: 4845.2455s
Epoch: 36 cost time: 19.486132621765137
Epoch: 36, Steps: 568 | Train Loss: 0.2058718 Vali Loss: 0.1866791 Test Loss: 0.2440543
EarlyStopping counter: 2 out of 8
Updating learning rate to 6.683534070998721e-05
	iters: 100, epoch: 37 | loss: 0.1848479
	speed: 0.1852s/iter; left time: 27754.0846s
	iters: 200, epoch: 37 | loss: 0.1818033
	speed: 0.0306s/iter; left time: 4589.2519s
	iters: 300, epoch: 37 | loss: 0.2492043
	speed: 0.0321s/iter; left time: 4800.5981s
	iters: 400, epoch: 37 | loss: 0.1888068
	speed: 0.0326s/iter; left time: 4869.3045s
	iters: 500, epoch: 37 | loss: 0.1851179
	speed: 0.0313s/iter; left time: 4681.9978s
Epoch: 37 cost time: 19.447367191314697
Epoch: 37, Steps: 568 | Train Loss: 0.2048405 Vali Loss: 0.1878987 Test Loss: 0.2465747
EarlyStopping counter: 3 out of 8
Updating learning rate to 6.920420900513073e-05
	iters: 100, epoch: 38 | loss: 0.2146016
	speed: 0.1806s/iter; left time: 26962.0227s
	iters: 200, epoch: 38 | loss: 0.2129138
	speed: 0.0334s/iter; left time: 4989.4469s
	iters: 300, epoch: 38 | loss: 0.2088174
	speed: 0.0347s/iter; left time: 5180.1200s
	iters: 400, epoch: 38 | loss: 0.2120538
	speed: 0.0313s/iter; left time: 4667.7507s
	iters: 500, epoch: 38 | loss: 0.2194767
	speed: 0.0328s/iter; left time: 4883.1440s
Epoch: 38 cost time: 19.94325351715088
Epoch: 38, Steps: 568 | Train Loss: 0.2039916 Vali Loss: 0.1837536 Test Loss: 0.2441844
Validation loss decreased (0.183904 --> 0.183754).  Saving model ...
Updating learning rate to 7.152591899240768e-05
	iters: 100, epoch: 39 | loss: 0.1996915
	speed: 0.1813s/iter; left time: 26966.7219s
	iters: 200, epoch: 39 | loss: 0.1989013
	speed: 0.0317s/iter; left time: 4703.7886s
	iters: 300, epoch: 39 | loss: 0.1729643
	speed: 0.0348s/iter; left time: 5175.0992s
	iters: 400, epoch: 39 | loss: 0.2171250
	speed: 0.0336s/iter; left time: 4990.4763s
	iters: 500, epoch: 39 | loss: 0.2363504
	speed: 0.0356s/iter; left time: 5280.2368s
Epoch: 39 cost time: 20.091141939163208
Epoch: 39, Steps: 568 | Train Loss: 0.2031844 Vali Loss: 0.1899437 Test Loss: 0.2449774
EarlyStopping counter: 1 out of 8
Updating learning rate to 7.37941066527385e-05
	iters: 100, epoch: 40 | loss: 0.1973753
	speed: 0.1774s/iter; left time: 26280.0364s
	iters: 200, epoch: 40 | loss: 0.2026277
	speed: 0.0321s/iter; left time: 4748.7772s
	iters: 300, epoch: 40 | loss: 0.1748902
	speed: 0.0325s/iter; left time: 4810.2141s
	iters: 400, epoch: 40 | loss: 0.2133476
	speed: 0.0315s/iter; left time: 4650.4792s
	iters: 500, epoch: 40 | loss: 0.1941231
	speed: 0.0331s/iter; left time: 4890.1307s
Epoch: 40 cost time: 19.383684635162354
Epoch: 40, Steps: 568 | Train Loss: 0.2018406 Vali Loss: 0.1837562 Test Loss: 0.2501791
EarlyStopping counter: 2 out of 8
Updating learning rate to 7.600255467662914e-05
	iters: 100, epoch: 41 | loss: 0.2472829
	speed: 0.1980s/iter; left time: 29226.9692s
	iters: 200, epoch: 41 | loss: 0.2149004
	speed: 0.0320s/iter; left time: 4717.7932s
	iters: 300, epoch: 41 | loss: 0.1947989
	speed: 0.0326s/iter; left time: 4799.6559s
	iters: 400, epoch: 41 | loss: 0.1787725
	speed: 0.0323s/iter; left time: 4754.1389s
	iters: 500, epoch: 41 | loss: 0.2313251
	speed: 0.0322s/iter; left time: 4745.0515s
Epoch: 41 cost time: 19.40809726715088
Epoch: 41, Steps: 568 | Train Loss: 0.2013115 Vali Loss: 0.1884826 Test Loss: 0.2491112
EarlyStopping counter: 3 out of 8
Updating learning rate to 7.814520950638412e-05
	iters: 100, epoch: 42 | loss: 0.2119808
	speed: 0.1837s/iter; left time: 27010.6276s
	iters: 200, epoch: 42 | loss: 0.2122593
	speed: 0.0336s/iter; left time: 4939.1523s
	iters: 300, epoch: 42 | loss: 0.1873117
	speed: 0.0322s/iter; left time: 4723.7450s
	iters: 400, epoch: 42 | loss: 0.2231368
	speed: 0.0332s/iter; left time: 4869.9012s
	iters: 500, epoch: 42 | loss: 0.1917959
	speed: 0.0347s/iter; left time: 5089.0193s
Epoch: 42 cost time: 19.97362470626831
Epoch: 42, Steps: 568 | Train Loss: 0.2000060 Vali Loss: 0.1876749 Test Loss: 0.2513207
EarlyStopping counter: 4 out of 8
Updating learning rate to 8.021619792946089e-05
	iters: 100, epoch: 43 | loss: 0.2214602
	speed: 0.1796s/iter; left time: 26298.3961s
	iters: 200, epoch: 43 | loss: 0.1811859
	speed: 0.0320s/iter; left time: 4683.0376s
	iters: 300, epoch: 43 | loss: 0.1811904
	speed: 0.0351s/iter; left time: 5126.7410s
	iters: 400, epoch: 43 | loss: 0.2065288
	speed: 0.0359s/iter; left time: 5246.8841s
	iters: 500, epoch: 43 | loss: 0.1930922
	speed: 0.0311s/iter; left time: 4548.0939s
Epoch: 43 cost time: 19.934534311294556
Epoch: 43, Steps: 568 | Train Loss: 0.1985086 Vali Loss: 0.1910084 Test Loss: 0.2472881
EarlyStopping counter: 5 out of 8
Updating learning rate to 8.220984317748175e-05
	iters: 100, epoch: 44 | loss: 0.2223326
	speed: 0.1804s/iter; left time: 26317.8572s
	iters: 200, epoch: 44 | loss: 0.1877447
	speed: 0.0325s/iter; left time: 4737.8662s
	iters: 300, epoch: 44 | loss: 0.2197284
	speed: 0.0328s/iter; left time: 4777.7839s
	iters: 400, epoch: 44 | loss: 0.1955998
	speed: 0.0337s/iter; left time: 4909.8664s
	iters: 500, epoch: 44 | loss: 0.2080210
	speed: 0.0369s/iter; left time: 5375.2082s
Epoch: 44 cost time: 20.338911771774292
Epoch: 44, Steps: 568 | Train Loss: 0.1976289 Vali Loss: 0.1894166 Test Loss: 0.2491935
EarlyStopping counter: 6 out of 8
Updating learning rate to 8.412068048677431e-05
	iters: 100, epoch: 45 | loss: 0.1770125
	speed: 0.1842s/iter; left time: 26770.5589s
	iters: 200, epoch: 45 | loss: 0.1895029
	speed: 0.0326s/iter; left time: 4727.8417s
	iters: 300, epoch: 45 | loss: 0.1873506
	speed: 0.0324s/iter; left time: 4695.0897s
	iters: 400, epoch: 45 | loss: 0.2216889
	speed: 0.0321s/iter; left time: 4655.0085s
	iters: 500, epoch: 45 | loss: 0.1872200
	speed: 0.0315s/iter; left time: 4567.9517s
Epoch: 45 cost time: 19.513574600219727
Epoch: 45, Steps: 568 | Train Loss: 0.1965855 Vali Loss: 0.1905791 Test Loss: 0.2453306
EarlyStopping counter: 7 out of 8
Updating learning rate to 8.594347207778784e-05
	iters: 100, epoch: 46 | loss: 0.1961245
	speed: 0.1914s/iter; left time: 27705.1175s
	iters: 200, epoch: 46 | loss: 0.2071719
	speed: 0.0324s/iter; left time: 4686.6660s
	iters: 300, epoch: 46 | loss: 0.2069575
	speed: 0.0333s/iter; left time: 4809.0754s
	iters: 400, epoch: 46 | loss: 0.1883650
	speed: 0.0342s/iter; left time: 4934.0111s
	iters: 500, epoch: 46 | loss: 0.1979032
	speed: 0.0345s/iter; left time: 4978.5074s
Epoch: 46 cost time: 19.973713397979736
Epoch: 46, Steps: 568 | Train Loss: 0.1955183 Vali Loss: 0.1889193 Test Loss: 0.2473868
EarlyStopping counter: 8 out of 8
Early stopping
>>>>>>>testing : 96_336_SPM_TST_Solar_ftM_sl96_ll18_pl336_dm256_nh1_el1_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10177
mse:0.24418418109416962, mae:0.276126503944397, rse:0.5726352334022522
